WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:rte-saving-kb-shortcuts', location = 'js/editor-saving-kb-shortcuts.js' */
define("jira/editor/saving-kb-shortcuts",["jquery","jira/editor/analytics","jira/util/navigator","jira/util/data/meta","jira/util/formatter"],function(e,f,c,g,h){function k(a){return(a.ctrlKey||c.isMac()&&a.metaKey)&&(13===a.keyCode||!c.isMac()&&10===a.keyCode)}function l(a){return d&&d===a.keyCode?m.every(function(b){return a[b]}):!1}var d=function(){var a="e";return a&&1===a.length?a.toUpperCase().charCodeAt(0):0}(),m=function(){return(g.get("keyboard-accesskey-modifier")||
"").split("+").map(function(a){return a.trim().toLowerCase()+"Key"})}();return{enable:function(a){a.getInstance().relayEvent("keydown",function(b){if(k(b)||l(b))b.preventDefault(),a.serialize().then(function(){f.sendEvent("editor.instance.submit");e(a.$textarea.prop("form")).submit()})},!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:schema-builder', location = 'js/editor-schema-builder.js' */
define("jira/editor/schema-builder",["jira/editor/tinymce","jquery","underscore","jira/util/logger"],function(n,l,d,f){function p(a,c,b){var e=(new n.html.Schema({schema:b})).elements;e.img.attributesRequired=["src"];e.img.attributes.imagetext={};e.img.attributesOrder.push("imagetext");return a.map(function(a){var b=e[a];if(!b)return!1;var d=b.removeEmptyAttrs?"!":"",k="";b.paddEmpty?k="#":b.removeEmpty&&(k="-");var q=b.attributesOrder.map(function(a){var c="";-1!==(b.attributesRequired||[]).indexOf(a)&&
(c="!");return c+a}).filter(function(a){return-1===c.indexOf(a)});return k+a+d+"["+q.join("|")+"]"}).filter(function(a){return!!a})}function r(a){return d.isArray(a)?d.every(a,function(a){return"string"===typeof a}):!1===a||void 0===a}function t(a){return d.isArray(a)?d.every(a,function(a){return"string"===typeof a}):void 0===a}var b=function(){this.noBreak=[];this.noNest=[];this.customElementChildren={};this.customElementAttrs={};this.validChildren=[];this.unwantedAttributes=[];this.extendedValidElements=
[];this.baseSchema="html5";this.validElements=[]};b.prototype.withCustomElement=function(a,c,b){if(!("string"===typeof a&&0<a.indexOf("-")))return f.error("Could not add custom element: incorrect `name` given:",a,"(see https://www.w3.org/TR/custom-elements/#valid-custom-element-name)"),this;if(!r(c))return f.error("Could not add custom element: incorrect `children` given:",c),this;if(!t(b))return f.error("Could not add custom element: incorrect `attributes` given:",b),this;!1===c?c=[]:void 0===c?
c=["p","#comment"]:c.push("#comment");b||(b=[]);this.customElementChildren[a]=d.uniq(c);this.customElementAttrs[a]=d.uniq(b);return this};b.prototype.withBaseSchema=function(a){this.baseSchema=a;return this};b.prototype.withValidElements=function(a){this.validElements=a;return this};b.prototype.withNoBreak=function(a){this.noBreak.push.apply(this.noBreak,a);return this};b.prototype.withNoSelfNest=function(a){this.noNest.push.apply(this.noNest,a.map(function(a){return[a,a]}));return this};b.prototype.setValidChildren=
function(a,b){this.validChildren.push(a+"["+b+"]");return this};b.prototype.withExtendedValidElements=function(a){this.extendedValidElements.push.apply(this.extendedValidElements,a);return this};b.prototype.withNoNest=function(a){this.noNest.push.apply(this.noNest,a);return this};b.prototype.withUnwantedAttributes=function(a){this.unwantedAttributes.push.apply(this.unwantedAttributes,a);return this};b.prototype.build=function(){function a(a,b){h.push("-"+a+"["+b+"]")}var b=this.baseSchema,e=[],h=
[],f=[],g=[],m={};this.noBreak.forEach(function(b){a(b,"br")});this.noNest.forEach(function(b){a.apply(null,b)});e.push.apply(e,Object.keys(this.customElementChildren));l.each(this.customElementChildren,function(a,b){m[a]=b.reduce(function(a,b){a[b]={};return a},{})});h.push.apply(h,this.validChildren);f=p(this.validElements,this.unwantedAttributes,b);g.push.apply(g,d.map(this.customElementAttrs,function(a,b){return b+(a.length?"["+a.join("|")+"]":"")}));g.push.apply(g,this.extendedValidElements);
return{getValidChildren:function(){return h.join(",")},getValidElements:function(){return f.join(",")},getExtendedValidElements:function(){return g.join(",")},getCustomElements:function(){return e.join(",")},getType:function(){return b},fixChildren:function(a){l.extend((a||{}).children,m)}}};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:schema-builder', location = 'js/editor-supported-operations.js' */
define("jira/richeditor/editor-supported-operations",["underscore"],function(c){function b(a,d){var b={bold:["strong","b"],italic:["em","i"],underline:["ins","u"],"bullet-list":["li","ul"],"numbered-list":["li","ol"],paragraph:[],"paragraph-quote":["blockquote"],"block-quote":["blockquote"],monospace:["samp","tt","code"],"delete":["del"],superscript:["sup"],subscript:["sub"],color:["font"],icon:["img"],attachment:["a","img","sup"],code:["pre"],panel:["b"],noformat:["pre"],table:"table thead tbody tr th td tfoot caption colgroup col".split(" "),
undo:[],redo:[]};a=c.map(a,function(a){return b[a]||[a]});a.push(d||[]);d=c.flatten(a);return c.uniq(d)}var e="bold italic underline bullet-list numbered-list h1 h2 h3 h4 h5 h6 paragraph paragraph-quote block-quote monospace delete superscript subscript cite hr color icon attachment code panel noformat table undo redo".split(" "),f=b(e,["br","span","a","p","div"]);return{getWikiOperations:function(){return e},getRequiredHtmlTags:function(){return f},mapWikiOperationToHtmlTags:b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:html-browser-converter', location = 'js/util/html-browser-converter.js' */
define("jira/editor/util/html-browser-converter",[],function(){return{convert:function(b){if(!b)return"";try{const a=document.createElement("template");a.innerHTML=b;return a.innerHTML}catch(a){return""}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:schema', location = 'js/editor-schema.js' */
define("jira/editor/schema","jira/editor/schema-builder jira/richeditor/editor-supported-operations jira/editor/tinymce jira/editor/util/html-browser-converter jira/util/formatter jira/featureflags/feature-manager jquery".split(" "),function(h,n,e,p,q,r,k){function t(a,b){return`<span
                    title="${"Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code."}"
                    contenteditable="false"
                    class="bidi-unicode"
                    data-bidi-character-code="${b.charCodeAt(0).toString(16).padStart(4,"0").toUpperCase()}"
                >${b}</span>`}function l(a,b){"textContent"in document.body&&(a=a.replace(/(<br>|<br \/>)/g,"\n"));a=k("\x3cdiv\x3e").addClass("richeditor-sanitize").append(a)[0];a=AJS.escapeHTML(a.textContent||a.innerText);const d=r.isFeatureEnabled("jira.richeditor.bidi.warning");return b&&d?a.replace(/([\u2066-\u2069\u202A-\u202E])/g,t):a}var m="strong b em i tt code samp sub sup del cite panel-title".split(" "),u=[["td","table"],["th","table"],["td","p"],["th","p"]],f=[],v=["strong/b"];f.push("xml:lang");
f.push("xml:space");var g={getSchemaSpecBuilder:function(a){void 0===a&&(a=new h);return a.withValidElements(n.getRequiredHtmlTags()).withNoBreak(m).withNoSelfNest(m).withNoNest(u).withUnwantedAttributes(f).withExtendedValidElements(v).withCustomElement("panel-title",["span","#text"],["style"]).setValidChildren("pre","br|span|#text|pre|p|panel-title")},getPasteSchemaSpecBuilder:function(a){void 0===a&&(a=g.getSchemaSpecBuilder());return a.withUnwantedAttributes(["contenteditable"])},getPasteInsidePreSchemaSpecBuilder:function(a){void 0===
a&&(a=new h);return a.withValidElements(["br","span","p","pre"]).withUnwantedAttributes(["style"])},getSchemaFromSpec:function(a){var b=new e.html.Schema({schema:a.getType(),custom_elements:a.getCustomElements(),valid_children:a.getValidChildren(),valid_elements:a.getValidElements(),extended_valid_elements:a.getExtendedValidElements()});a.fixChildren(b);return b},sanitizeHtml:function(a,b,d){var c=k(b.selection.getStart()).add(b.selection.getEnd()).add(b.selection.getNode());a=p.convert(a);c.is("pre, pre \x3e *")&&
(a=c.clone().html(l(a,!0)).prop("outerHTML"));c.is("panel-title, panel-title \x3e *")&&(a=l(a,!1));c=g.getSchemaFromSpec(d);d=new e.html.DomParser(b.settings,c);b=new e.html.Serializer(b.settings,c);a=d.parse(a,{forced_root_block:void 0});return b.serialize(a)}};return g});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:i18n', location = '/js/editor-i18n.js' */
define("jira/editor/i18n",["jira/editor/tinymce"],function(a){a.addI18n("en",{Cut:"Cortar","Header 2":"Encabezado 2","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"Su explorador no permite acceder directamente al portapapeles. Use los m\u00e9todos abreviados de teclado Ctrl+X/C/V.",Div:"Div",Paste:"Pegar",Close:"Cerrar",
"Font Family":"Familia de fuentes",Pre:"Pre","Align right":"Alinear a la derecha","New document":"Nuevo documento",Blockquote:"Blockquote","Numbered list":"Lista numerada","Increase indent":"Aumentar sangr\u00eda",Formats:"Formatos",
Headers:"Encabezados","Select all":"Seleccionar todo","Header 3":"Encabezado 3",Blocks:"Bloques",Undo:"Deshacer",Strikethrough:"Tachado","Bullet list":"Lista de vi\u00f1etas","Header 1":"Encabezado 1",Superscript:"Super\u00edndice",
"Clear formatting":"Borrar formato","Font Sizes":"Tama\u00f1os de fuente",Subscript:"Sub\u00edndice","Header 6":"Encabezado 6",Redo:"Rehacer",Paragraph:"P\u00e1rrafo",Ok:"Aceptar",Bold:"Negritas",Code:"C\u00f3digo",
Italic:"Cursiva","Align center":"Alinear al centro","Header 5":"Encabezado 5","Decrease indent":"Disminuir sangr\u00eda","Header 4":"Encabezado 4","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"La funci\u00f3n de pegar se encuentra ahora en modo de texto sin formato. El contenido se pegar\u00e1 como texto sin formato hasta que desactive esta opci\u00f3n.",Underline:"Subrayar",
Cancel:"Cancelar",Justify:"Justificar",Inline:"En l\u00ednea",Copy:"Copiar","Align left":"Alinear a la izquierda","Visual aids":"Ayuda visuales","Lower Greek":"Griego inferior",Square:"Cuadrado",Default:"Predeterminado",
"Lower Alpha":"Alfa inferior",Circle:"C\u00edrculo",Disc:"Disco","Upper Alpha":"Alfa superior","Upper Roman":"Romano superior","Lower Roman":"Romano inferior",Name:"Nombre",Anchor:"Ancla","You have unsaved changes are you sure you want to navigate away?":"Tiene cambios sin guardar, \u00bfest\u00e1 seguro de que desea salir de esta p\u00e1gina?",
"Restore last draft":"Restaurar \u00faltimo borrador","Special character":"Car\u00e1cter especial","Source code":"C\u00f3digo de origen","Right to left":"De derecha a izquierda","Left to right":"De izquierda a derecha",Emoticons:"Emoticonos",Robots:"Robots","Document properties":"Propiedades de documento",
Title:"T\u00edtulo",Keywords:"Palabras clave",Encoding:"Codificaci\u00f3n",Description:"Descripci\u00f3n",Author:"Autor",Fullscreen:"Pantalla completa","Horizontal line":"L\u00ednea horizontal","Horizontal space":"Espacio horizontal","Insert/edit image":"Insertar/editar imagen",
General:"General",Advanced:"Avanzado",Source:"Origen",Border:"Borde","Constrain proportions":"Restringir proporciones","Vertical space":"Espacio vertical","Image description":"Descripci\u00f3n de imagen",Style:"Estilo",
Dimensions:"Dimensiones","Insert image":"Insertar imagen","Insert date/time":"Insertar fecha/hora","Remove link":"Eliminar enlace",Url:"URL","Text to display":"Texto para mostrar",Anchors:"Anclas","Insert link":"Insertar enlace",
"New window":"Nueva ventana",None:"Ninguno","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"La URL ingresada parece ser un enlace externo. \u00bfDesea a\u00f1adir el prefijo http: necesario?",Target:"Destino","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"La URL ingresada parece ser una direcci\u00f3n de correo electr\u00f3nico. \u00bfDesea a\u00f1adir el prefijo mailto: necesario?","Insert/edit link":"Insertar/editar enlace",
"Insert/edit video":"Insertar/editar video",Poster:"P\u00f3ster","Alternative source":"Origen alternativo","Paste your embed code below:":"Pegue el c\u00f3digo para insertar a continuaci\u00f3n:","Insert video":"Insertar video",Embed:"Insertar","Nonbreaking space":"Espacio de no separaci\u00f3n","Page break":"Salto de p\u00e1gina",
"Paste as text":"Pegar como texto",Preview:"Vista previa",Print:"Imprimir",Save:"Guardar","Could not find the specified string.":"No se pudo hallar la cadena indicada.",Replace:"Reemplazar",Next:"Siguiente","Whole words":"Palabras completas",
"Find and replace":"Buscar y reemplazar","Replace with":"Reemplazar con",Find:"Buscar","Replace all":"Reemplazar todo","Match case":"Coincidir may\u00fasculas y min\u00fasculas",Prev:"Anterior",Spellcheck:"Revisi\u00f3n ortogr\u00e1fica",Finish:"Terminar","Ignore all":"Ignorar todo",
Ignore:"Ignorar","Insert row before":"Insertar fila arriba",Rows:"Filas",Height:"Altura","Paste row after":"Pegar fila debajo",Alignment:"Alineaci\u00f3n","Column group":"Grupo de columnas",Row:"Fila","Insert column before":"Insertar columna a la izquierda",
"Split cell":"Dividir celda","Cell padding":"Espaciado entre borde y texto","Cell spacing":"Espaciamiento de celdas","Row type":"Tipo de fila","Insert table":"Insertar tabla",Body:"Cuerpo",Caption:"Leyenda",Footer:"Pie de p\u00e1gina","Delete row":"Eliminar fila",
"Paste row before":"Pegar fila arriba",Scope:"Alcance","Delete table":"Eliminar tabla","Header cell":"Celda de encabezado",Column:"Columna",Cell:"Celda",Header:"Encabezado","Cell type":"Tipo de celda","Copy row":"Copiar fila",
"Row properties":"Propiedades de fila","Table properties":"Propiedades de tabla","Row group":"Grupo de filas",Right:"Derecha","Insert column after":"Insertar columna a la derecha",Cols:"Cols","Insert row after":"Insertar fila debajo",Width:"Ancho",
"Cell properties":"Propiedades de celda",Left:"Izquierda","Cut row":"Cortar fila","Delete column":"Eliminar columna",Center:"Centro","Merge cells":"Combinar celdas","Insert template":"Insertar plantilla",Templates:"Plantillas",
"Background color":"Color de fondo","Text color":"Color del texto","Show blocks":"Mostrar bloques","Show invisible characters":"Mostrar caracteres invisibles","Words: {0}":"Palabras: {0}",Insert:"Insertar",File:"Archivo",Edit:"Editar",
"Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"Editor de contenido",Tools:"Herramientas",View:"Ver",Table:"Tabla",Format:"Formato"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:wrm', location = 'js/editor-wrm.js' */
define("jira/editor/wrm",["exports","wrm/data"],function(a,c){var b=c.claim("com.atlassian.jira.plugins.jira-editor-plugin:wrm.editor-data")||{};a.isAttachmentsAllowed=function(){return b.allowedAttachments};a.getResources=function(){return b.resources};a.getConverters=function(){return b.converters}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter-util', location = '/js/converter/util/color-converter.js' */
define("jira/editor/converter/util/color-converter",["exports"],function(b){b.colorToHex=function(a){if("#"===a.substr(0,1))return a;a=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);var b=[a[2],a[3],a[4]].map(function(a){return("00"+parseInt(a).toString(16)).slice(-2)});return a[1]+"#"+b.join("")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter-util', location = '/js/converter/util/strings.js' */
define("jira/editor/converter/util/strings",["jira/editor/util/strings","exports","jquery","underscore"],function(g,c,f,d){c.asBooleanOrString=function(a){var b=a?a.toLowerCase():"";"true"===b?a=!0:"false"===b&&(a=!1);return a};c.startsWith=function(a,b){return d.isEmpty(a)||d.isEmpty(b)?!1:0===a.indexOf(b)};c.endsWith=function(a,b){return d.isEmpty(a)||d.isEmpty(b)?!1:a.indexOf(b)+b.length===a.length};c.substringAfter=function(a,b){if(d.isEmpty(a))return a;if(d.isEmpty(b))return"";var c=a.indexOf(b);
return 0>c?"":a.substring(c+b.length)};c.substringBefore=function(a,b){if(d.isEmpty(a))return a;if(d.isEmpty(b))return"";b=a.indexOf(b);return 0>b?"":a.substring(0,b)};c.contains=function(a,b){return d.isEmpty(a)?!1:0<=a.indexOf(b)};c.repeat=function(a,b){return d.isEmpty(a)?"":Array(b+1).join(a)};c.length=function(a){return d.isEmpty(a)?0:a.length};c.replace=function(a,b,c){if(d.isEmpty(a)||d.isEmpty(b))return"";"undefined"===typeof c&&(c="");var e;for(e=a.indexOf(b);0<=e;){var h=a.substring(0,e);
a=a.substring(e+b.length);a=h+c+a;e+=c.length;e=a.indexOf(b,e)}return a.substring(e,a.length)};c.hashCode=function(a){var b=0;if(!a)return"";for(var c=0;c<a.length;c+=1){var d=a.charCodeAt(c);b=31*b+d;b|=0}return""+b};c.resolveUrl=function(a,b){if(a){b=f(document.createElement("base")).prop("href",b).appendTo("head");try{return f(document.createElement("a")).prop("href",a).prop("href")}finally{b.remove()}}};c.getBaseUrl=function(){return document.location.origin+document.location.pathname};c.getContextUrl=
function(){return document.location.origin+AJS.contextPath()};c.getFilenameFromHref=function(a,b){var c=a.split("/");a=c[c.length-1];b?(b=a.indexOf("_"),0<b&&(a=a.substring(b+1))):(b=c[c.length-2]+"_",0===a.indexOf(b)&&(a=a.substring(b.length)));a=a.replace(/\+/g," ");return decodeURIComponent(a)};c.isAttachmentPath=function(a){return c.contains(a,"/secure/attachment/")};c.isTemporaryAttachmentPath=function(a){return c.contains(a,"/secure/temporaryattachment/")};c.isThumbnailPath=function(a){return c.contains(a,
"/secure/thumbnail/")};c.isEmotePath=function(a){return c.contains(a,"/images/icons/emoticons/")};c.getFilenameFromError=function(a){return g.getFilenameFromError(a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter-util', location = '/js/converter/util/uri.js' */
define("jira/editor/converter/util/uri",["exports","atlassian/libs/uri-1.14.1"],function(b,c){b.decodeUri=function(a){return c.decodeQuery(a||"",!0)};b.encodeUri=function(a){return c.encodeQuery(a||"",!0)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter-util', location = '/js/converter/util/rte-strings.js' */
define("jira/editor/converter/util/rte-strings",["exports","underscore"],function(exports,_){exports.isWhitespace=function(str){if(_.isEmpty(str))return false;var whitespaceMap={"\t":1,"\n":1," ":1,"\t":1,"\n":1,"\r":1,"\f":1,"\u200b":1};var onlyWhitespaces=true;_.each(str,function(ch){onlyWhitespaces=onlyWhitespaces&&ch in whitespaceMap});return onlyWhitespaces};exports.trim=function(str){if(_.isEmpty(str))return"";return this.trimLeading(this.trimTrailing(str))};exports.trimTrailing=function(str){if(_.isEmpty(str))return"";
var i;for(i=str.length-1;i>=0;i--)if(!this.isWhitespace(str[i]))break;return str.substring(0,i+1)};exports.trimLeading=function(str){if(_.isEmpty(str))return"";var i;for(i=0;i<str.length;i++)if(!this.isWhitespace(str[i]))break;return str.substring(i,str.length)};exports.parseHtml=function(html){var parser=new DOMParser;var dom=parser.parseFromString(html,"text/html").body;return dom}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:context-detector', location = 'js/context-detector.js' */
define("jira/editor/context-detector",["jira/editor/converter/util/rte-strings","underscore","jquery"],function(d,e,b){return{detectPre:function(a){return 0<b(a||{}).closest("pre,.code.panel,.preformatted.panel,.panelHeader,panel-title").length},detectTable:function(a){return 0<b(a||{}).closest("table").length},detectA:function(a){return 0<b(a||{}).closest("a").length},detectPreWithinSelection:function(a){try{var c=0<b((e.isString(a)?d.parseHtml(a):a)||{}).find("pre,.code.panel,.preformatted.panel,.panelHeader,panel-title").length}catch(f){c=
!1}return c}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:context-manager', location = 'js/context-manager.js' */
define("jira/editor/context-manager",["jira/editor/context-detector","backbone","underscore"],function(d,e,c){var a=function(b){this._disableStates={all:null,table:null,a:null};this._tagList=c.difference(Object.keys(this._disableStates),"all");this._editorInstance=b;b.on("selection:update",function(b){var a=b.insidePreformatted||b.preformattedSelected;this._setDisable(a,"all");this._setDisable(a||b.insideTable,"table");this._setDisable(a||b.insideA,"a")}.bind(this));b.on("tabs:changed",function(){this._setDisable(!1,
"all");this._setDisable(!1,"table");this._setDisable(!1,"a")}.bind(this));c.extend(this,e.Events)};a.prototype._setDisable=function(b,a){this._disableStates[a]!==b&&(this._disableStates[a]=b,this.trigger("change:"+a,{disableState:b}),"all"===a&&this._tagList.forEach(function(a){this._setDisable(b,a)},this))};a.prototype.isPreContextActive=function(){return!0===this._disableStates.all};a.prototype.isContextActive=function(a){return!0===this._disableStates[a]};a.prototype.getPasteSchemaForContext=function(){return d.detectPre(this._editorInstance.editor.selection.getNode())?
this._editorInstance.pasteInsidePreSchemaSpec:this._editorInstance.pasteSchemaSpec};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:selection', location = 'js/editor-selection.js' */
define("jira/editor/selection",["jira/editor/constants"],function(h){function k(b,a){b=b.match(a);return null!==b?b[0]:""}var c=function(b){this.editor=b};c.prototype.trimSelection=function(){var b=!1,a=this.editor.selection.getRng();if(a.collapsed)return!1;if(!a.toString().trim())return a.collapse(!0),this.editor.selection.setRng(a),this.editor.focus(),!0;var e=a.startContainer,c=a.startOffset,f=a.endContainer,l=a.endOffset;if(e&&e.nodeType===Node.TEXT_NODE){var g=e.nodeValue.substring(c),d=k(g,
h.LEFT_WHITESPACE_MATCHER);d&&(b=!0,g.length===d.length?a.setStartAfter(e):a.setStart(e,c+d.length))}f&&f.nodeType===Node.TEXT_NODE&&(g=f.nodeValue.substring(0,l),d=k(g,h.RIGHT_WHITESPACE_MATCHER))&&(b=!0,g.length===d.length?a.setEndBefore(f):a.setEnd(f,l-d.length));b&&this.editor.selection.setRng(a);return b};c.prototype.hasSelection=function(){return!this.editor.selection.getRng().collapsed};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:instance', location = 'js/editor-instance.js' */
define("jira/editor/instance","jira/dialog/dialog jira/editor/analytics jira/editor/analytics-shortcuts jira/util/navigator jira/editor/tinymce jira/editor/context-manager jira/editor/context-detector jira/editor/schema jira/editor/selection wiki-edit/SpeechRecognition jira/util/logger jquery backbone underscore wrm/context-path".split(" "),function(h,d,p,e,l,q,g,r,t,u,f,m,v,k,w){var c=function(a,b){this.element=a;this.options=k.extend({},b)};k.extend(c.prototype,v.Events);c.prototype.init=function(a){this.editor=
a;this.operationOverride={};this.analyticsShortcuts=new p(this.editor);this.selection=new t(this.editor);this.editor.on("NodeChange",function(a){var b=d.startMeasure();a&&("img"===a.element.nodeName.toLowerCase()&&this.editor.fire("content"),a=m(a.element),this.trigger("selection:update",{insidePreformatted:g.detectPre(a),preformattedSelected:g.detectPreWithinSelection(this.editor.selection.getContent()),insideTable:g.detectTable(a),insideA:g.detectA(a)}),b.measure("nodechange"))}.bind(this));this.editor.on("change SetContent blur",
this._onChange.bind(this));this.editor.on("keyup",k.debounce(this._onChange.bind(this),1E3));this.editor.on("init",function(a){a=a.target.formatter.get("removeformat");0<a.length&&"object"===typeof a[0]&&(a[0].selector+=",tt")});a.on("keydown",function(b){if(!b.isDefaultPrevented()){var c=m(a.selection.getStart());b.keyCode!==l.util.VK.ENTER||b.shiftKey||!c.is("th, td, th *, td *")||c.is("li")||(b.preventDefault(),a.execCommand("InsertLineBreak",!1,b));h.current&&27===b.keyCode&&h.current.hide(!0,
{reason:h.HIDE_REASON.cancel});b.keyCode===l.util.VK.ENTER&&(c.is("panel-title, panel-title *")||c.parent().hasClass("panelHeader"))&&b.preventDefault()}});d.sendEvent("editor.instance.init");d.sendEvent("bundled.editor.instance.init");var b=/(Edge)\/(\d+)\.(\d+)/.test(e._getUserAgent())?"edge":e.isIE()?"ie":e.isChrome()?"chrome":e.isMozilla()?"firefox":e.isSafari()?"safari":"";b&&d.sendEvent("editor.instance.init."+b);this.contextManager=new q(this);a.contextManager=this.contextManager};c.prototype.getId=
function(){return this.editor.id};c.prototype.relayEvent=function(a,b,c){this.editor.on(a,function(a){b(a)},c)};c.prototype.getAllowedOperations=function(){return"paragraph h1 h2 h3 h4 h5 h6 monospace paragraph-quote block-quote delete superscript subscript cite monospace-inline :) :( :P :D ;) (y) (n) (i) (/) (x) (!) (+) (-) (?) (on) (off) (*) (*r) (*g) (*b) (*y) bold italic underline color bullet-list numbered-list mention table code noformat panel hr speech link link-mail link-anchor link-attachment image image-attachment attachment editorInsertContent editorInsertContentInNewLine editorReplaceContent editorReplaceContentInNewLine".split(" ")};
c.prototype._isOperationSupported=function(a){return 0<this.getAllowedOperations().filter(function(b){return b instanceof Object?b.name===a:b===a}).length};c.prototype._assertOperationIsSupported=function(a){this._isOperationSupported(a)||f.error("Operation not supported:",a)};c.prototype._selectedTextSanitized=function(){return r.sanitizeHtml(this.editor.selection.getContent(),this.editor,this.pasteInsidePreSchemaSpec)};c.prototype.executeOperation=function(a,b){this._assertOperationIsSupported(a);
var c=this._mapOperationNameToTinymce(a),n=this.operationOverride[a];if(n)return d.sendEvent("editor.instance.operation."+a),n(b),!0;if("editorReplaceContentInNewLine"===a)this.editor.execCommand("mceReplaceContent",!1,"\x3cbr /\x3e"+b.content);else if("editorReplaceContent"===a)this.editor.execCommand("mceReplaceContent",!1,b.content);else if("editorInsertContentInNewLine"===a)this.editor.insertContent("\x3cbr /\x3e"+b.content);else if("editorInsertContent"===a)this.editor.insertContent(b.content);
else if("hr"===a)this.editor.insertContent("\x3chr /\x3e");else if("color"===a)this.editor.execCommand("ForeColor",!0,b);else if(-1<"h1 h2 h3 h4 h5 h6 paragraph paragraph-quote block-quote monospace monospace-inline cite".split(" ").indexOf(a))this.editor.execCommand("mceToggleFormat",!0,c);else if(-1<"bold italic underline delete superscript subscript".split(" ").indexOf(a)){if(this.selection.trimSelection())if(this.selection.hasSelection())d.sendEvent("editor.instance.selection.trimmed",{op:a});
else return d.sendEvent("editor.instance.selection.collapsed",{op:a}),!1;this.editor.execCommand(c,!0)}else if(-1<["bullet-list","numbered-list"].indexOf(a))this.editor.execCommand(c,!0);else if(this._emoticonSourceMap(a))b=(AJS&&AJS.contextPath?AJS.contextPath():"")+"/images/icons/emoticons/"+this._emoticonSourceMap(a),this.editor.insertContent('\x3cimg class\x3d"emoticon" src\x3d"'+b+'" height\x3d"16" width\x3d"16" align\x3d"absmiddle" alt\x3d"" border\x3d"0"\x3e');else if("link"===a)b=this._selectedTextSanitized()||
"t\u00edtulo de enlace",this.editor.selection.setContent("["+b+"|http://example.com]");else if("link-anchor"===a)b=this._selectedTextSanitized()||"ancla",this.editor.selection.setContent("[#"+b+"]");else if("link-mail"===a)b=this._selectedTextSanitized()||"mail@example.com",this.editor.selection.setContent("[mailto:"+b+"]");else if("mention"===a)b=this._selectedTextSanitized()||"Mencionar a alguien escribiendo su nombre...",
this.editor.selection.setContent("@"),c=this.getSelectionStart(),this.editor.selection.setContent(b),this.setSelectionStartWithOffset(c,1);else if("attachment"===a&&b.attachment)"image"===b.attachment.type?(c=b.attachment.href||w()+"/images/icons/attach/image.gif",b.attachment.thumbnailable&&(c=c.replace("/attachment/","/thumbnail/")),b=JIRA.Editor.Tags.Templates.attachedImage({source:c,filename:b.attachment.name})):b=JIRA.Editor.Tags.Templates.attachedFile({title:b.attachment.name,href:b.attachment.href,
filename:b.attachment.name}),this.editor.insertContent(b);else if("code"===a)b=this._selectedTextSanitized()||"// marcador de posici\u00f3n de c\u00f3digo"+"\n",this.editor.selection.setContent('\x3cpre class\x3d"code panel" data-language\x3d"code-java"\x3e'+b+"\x3c/pre\x3e");else if("panel"===a)b=this.editor.selection.getContent()||"Un texto con un t\u00edtulo",this.editor.selection.setContent('\x3cdiv class\x3d"plain panel" style\x3d"border-width: 1px;"\x3e\x3cpanel-title\x3e'+
"Mi t\u00edtulo"+"\x3c/panel-title\x3e\x3cp\x3e"+b+"\x3c/p\x3e\x3c/div\x3e");else if("noformat"===a)b=this._selectedTextSanitized()||"aqu\u00ed *no*_se da_ning\u00fan formato adicional",this.editor.selection.setContent('\x3cpre class\x3d"noformat panel"\x3e'+b+"\x3c/pre\x3e");else if("table"===a)b=this.editor.selection.getContent()||"Col"+" A1",this.editor.selection.setContent('\x3cdiv class\x3d"table-wrap"\x3e\x3ctable class\x3d"confluenceTable mce-item-table" data-mce-selected\x3d"1"\x3e\x3ctbody\x3e\x3ctr\x3e\x3cth class\x3d"confluenceTh"\x3e'+
"T\u00edtulo"+' 1\x3c/th\x3e\x3cth class\x3d"confluenceTh"\x3e'+"T\u00edtulo"+' 2\x3c/th\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd class\x3d"confluenceTd"\x3e'+b+'\x3c/td\x3e\x3ctd class\x3d"confluenceTd"\x3eCol A2\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e'),d.sendEvent("editor.instance.table.toolbar");else if("speech"===a)u.start(null,this);else return-1<["link-attachment",
"image","image-attachment"].indexOf(a)?f.warn("Not supported yet "+a):f.warn("Unsupported operation "+a),!1;d.sendEvent("editor.instance.operation."+a);this.trigger("content");f.trace("jira.editor.operation.executed");return!0};c.prototype._mapOperationNameToTinymce=function(a){var b={bold:"Bold",italic:"Italic",underline:"Underline","bullet-list":"InsertUnorderedList","numbered-list":"InsertOrderedList",blockquote:"mceBlockQuote",paragraph:"p","paragraph-quote":"blockquote","block-quote":"blockquote",
monospace:"samp","monospace-inline":"samp-inline","delete":"strikethrough",superscript:"superscript",subscript:"subscript"};return a in b?b[a]:a};c.prototype._emoticonSourceMap=function(a){var b={":)":"smile.png",":(":"sad.png",":P":"tongue.png",":D":"biggrin.png",";)":"wink.png","(y)":"thumbs_up.png","(n)":"thumbs_down.png","(i)":"information.png","(/)":"check.png","(x)":"error.png","(!)":"warning.png","(+)":"add.png","(-)":"forbidden.png","(?)":"help_16.png","(on)":"lightbulb_on.png","(off)":"lightbulb.png",
"(*)":"star_yellow.png","(*r)":"star_red.png","(*g)":"star_green.png","(*b)":"star_blue.png","(*y)":"star_yellow.png","(flag)":"flag.png","(flagoff)":"flag_grey.png"};if(a in b)return b[a]};c.prototype.focus=function(){if(!this.editor.initialized||this.editor.removed||this.editor.destroyed)return f.warn("bypassing `editor-instance.focus` because the editor instance hasn't initialized yet or already removed"),this;this.editor.focus();this.editor.nodeChanged();return this};c.prototype.destroy=function(){this.editor.contextManager=
null;this.editor.remove();d.sendEvent("editor.instance.destroy");d.sendEvent("bundled.editor.instance.destroy")};c.prototype.setContent=function(a,b,c){var d={};b&&(d={format:"raw"});d.no_events=c;this.editor.setContent(a||"",d);this.lastContent=this.getContent();c||this.trigger("content")};c.prototype.replaceSelection=function(a){this.editor.selection.setContent(a);this.trigger("content")};c.prototype.selectAll=function(){this.editor.selection.select(this.editor.getBody(),!0)};c.prototype.getSelectionStart=
function(){return this.editor.selection.getRng()};c.prototype.setSelectionStart=function(a){var b=this.editor.selection.getRng();b.setStart(a.startContainer,a.startOffset);this.editor.selection.setRng(b)};c.prototype.setSelectionStartWithOffset=function(a,b){var c=this.editor.selection.getRng();c.setStart(a.startContainer.firstChild,b);this.editor.selection.setRng(c)};c.prototype.getContent=function(a){var b={};a&&(b={format:"raw"});return this.editor.getContent(b)};c.prototype._onChange=function(){if(!this.editor.destroyed){var a=
this.getContent(),b=a!==this.lastContent;this.lastContent=a;!this.hidden&&b&&this.trigger("content",this.getContent())}};c.prototype.getSelectedContent=function(a){return a?this.editor.selection.getContent({format:"text"}):this.editor.selection.getContent()};c.prototype.addShortcut=function(a,b){this.editor.addShortcut(a,"",b)};c.prototype.removeShortcut=function(a){this.editor.shortcuts.remove(a)};c.prototype.addOperationOverride=function(a,b){this._assertOperationIsSupported(a);this.operationOverride[a]=
b};c.prototype.removeOperationOverride=function(a){this._assertOperationIsSupported(a);delete this.operationOverrideoperationOverride[a]};c.prototype.hide=function(){this.hidden=!0;this.editor.hide()};c.prototype.show=function(){this.editor.show();delete this.hidden};c.prototype.isVisible=function(){return!this.editor.isHidden()};c.prototype.switchMode=function(a){this.trigger("switchMode",a)};c.prototype.enable=function(){this.editor.setProgressState(!1)};c.prototype.disable=function(){this.editor.setProgressState(!0)};
return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:instance', location = 'js/editor-resources.js' */
define("jira/editor/resources",["jira/editor/tinymce","jira/editor/wrm","wrm/require","jquery"],function(f,g,d,e){function h(b){return"object"===typeof b&&b.length?b.map(function(a){return a.replace(",","%2C")}):[]}var c={},k={};c.loadPlugins=function(b){b=b.filter(function(a){return a.resource}).map(function(a){f.PluginManager.urls[a.name]=a.resource;return"wr!"+a.resource});return 0<b.length?d(b):(new e.Deferred).resolve()};c.require=function(b){return d(b.filter(function(a){return!k[a]}).map(function(a){return"wr!"+
a}))};c.loadCssResources=function(){return(new e.Deferred).resolve(h(g.getResources())).promise()};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:api', location = 'js/editor-create.js' */
define("jira/editor/create","jira/editor/instance jira/editor/resources jira/editor/schema jira/editor/customizer jira/editor/height-helper jira/util/navigator jira/editor/tinymce jquery underscore".split(" "),function(l,k,f,m,n,p,g,h,q){function r(a,d,e){var c=a.build();d.schema=c.getType();d.custom_elements=c.getCustomElements();d.valid_children=c.getValidChildren();d.valid_elements=c.getValidElements();d.extended_valid_elements=c.getExtendedValidElements();e.schemaSpec=c;e.pasteSchemaSpec=f.getPasteSchemaSpecBuilder(a).build();
e.pasteInsidePreSchemaSpec=f.getPasteInsidePreSchemaSpecBuilder().build()}var b=function(a){this.element=a;this.settings={toolbar:!1,menubar:!1,elementpath:!1};this.plugins=[]};b.prototype.build=function(){var a=new h.Deferred,d=this,e=new l(d.element),c=new n(this.element),b=q.extend(this.settings,{plugins:["autoresize","lists","table"],language:"en",content_style:p.isIE()?"body#tinymce {min-height: 10px}":"",autoresize_on_init:!0,resize:!0,max_height:c.getMaxHeight()+-2,min_height:c.getMinHeight()+
-2,autoresize_bottom_margin:0,allow_conditional_comments:!1,object_resizing:"img:not(.emoticon)",end_container_on_empty_block:!0,browser_spellcheck:!0,table_toolbar:"tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",hidden_input:!1,target:this.element,autoresize_overflow_padding:8,relative_urls:!1,convert_urls:!1,branding:!1,formats:{underline:[{inline:"ins",remove:"all"},{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},
exact:!0}],strikethrough:[{inline:"del",remove:"all"},{inline:"strike",remove:"all"},{inline:"span",styles:{textDecoration:"line-through"},exact:!0}]},setup:function(b){a.notify(e);e.init(b);b.on("init",function(){b.getContainer().classList.add("jira-editor-container");e.schemaSpec.fixChildren(b.schema);a.resolve(e)});b.on("focus",function(){h(d.element).trigger("click").trigger("focusin")})}});h.when(k.loadCssResources(),k.loadPlugins(this.plugins)).then(function(d){this.plugins.forEach(function(a){require(a.name).configure(e,
b)},this);var c=f.getSchemaSpecBuilder();m.getCustomizeSettingCallbacks().forEach(function(a){a(b,g,c)});r(c,b,e);b.content_css=d;"interactive"===document.readyState&&(g.dom.EventUtils.Event.domLoaded=!0);document.body.contains(this.element)?g.init(b):a.reject()}.bind(this));return a.promise()};b.prototype.withElement=function(a){this.element=a;return this};b.prototype.withPlugin=function(a,b){this.plugins.push({name:a,resource:b});return this};b.prototype.withMeta=function(a){this.meta=a;return this};
return{builder:function(a){return new b(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:renderer', location = '/js/converter/html-renderer.js' */
define("jira/editor/html-renderer",["wrm/context-path","jquery","underscore"],function(c,d,e){return{renderMarkup:function(a,b){b=b||{};a=e.extend({rendererType:"atlassian-wiki-renderer",unrenderedMarkup:a,forWysiwyg:!0},b);return d.ajax({url:c()+"/rest/api/1.0/render",contentType:"application/json",type:"POST",data:JSON.stringify(a),dataType:"html"})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:mentions', location = 'js/plugins/mentions/mentions-util.js' */
define("jira/editor/plugins/mentions/mentions-util",["jquery","underscore"],function(f,g){return{isMentionNode:function(a){return a?f(a).is("a.user-hover"):!1},isCaretAfterMention:function(a){return null!=this.getMentionBeforeCaret(a)},getMentionBeforeCaret:function(a){a=this.getPreviousNode(a).node;return this.isMentionNode(a)?a:null},getPreviousNode:function(a){var c=function(a){if(a.nodeType===Node.TEXT_NODE)return a.nodeValue.length;if(a.nodeType===Node.ELEMENT_NODE)return a.childNodes.length},
b=a.getSelection();a=b.anchorNode;var d=b.anchorOffset,e={node:a,offset:b.anchorOffset};if(b.isCollapsed&&a)if(a.nodeType===Node.ELEMENT_NODE&&a.childNodes){if(d=b.anchorOffset-1,0>d?(a=a.childNodes[0],b=this._getPreviousSiblingSkipEmptyTextNodes(a,0)):(b=d===a.childNodes.length-1,a=a.childNodes[d],d=c(a),b=this._getPreviousSiblingSkipEmptyTextNodes(a,d,b)),b)return{node:b,offset:c(b)}}else if(a.nodeType===Node.TEXT_NODE&&(b=this._getPreviousSiblingSkipEmptyTextNodes(a,d)))return{node:b,offset:b===
a?d:c(b)};return e},_getPreviousSiblingSkipEmptyTextNodes:function(a,c,b){for(b=b||!1;(b=this._isContentBeforeCursorEmpty(a,c,b)).outcome;)a=a.previousSibling,c=void 0,b=b.relaxed;return a},_isContentBeforeCursorEmpty:function(a,c,b){var d={outcome:!0,relaxed:!1},e={outcome:!0,relaxed:!0};if(a&&a.nodeType===Node.TEXT_NODE){g.isUndefined(c)&&(c=a.nodeValue.length);if(0===c||1===c&&this._isEmptyCharacter(a.nodeValue.charCodeAt(0))&&1===a.nodeValue.length)return d;if(b&&1===c&&" "===a.nodeValue)return e}return{outcome:!1,
relaxed:!1}},_isEmptyCharacter:function(a){return 8203===a||65279===a},selectMention:function(a,c,b){c&&(c.preventDefault(),c.stopPropagation(),c.stopImmediatePropagation());b.selection.select(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:mentions', location = 'js/plugins/mentions/mention.js' */
define("jira/editor/plugins/mentions/mention-rte",["jira/mention/mention-matcher","jquery","jira/mention/mention","underscore","jira/editor/plugins/mentions/mentions-util"],function(f,h,g,k,l){return g.extend({init:function(a,b,d){g.prototype.init.call(this,a);this.editor=b;this.skipProcessing=d},_replaceCurrentUserName:function(a,b){this._selectMentionText()&&this.editor.execCommand("mceInsertContent",!1,this._renderMentionLink(a,b))},_selectMentionText:function(){var a=this._getDocument(),b=this._getSelection();
if(b&&b.isCollapsed){var d=this._getNodeForUsernameRetrieval(),c=this._getPreviousSiblingsTextNodes(d.node);if(0<c.length){b=c[0];var e=c[c.length-1];d=d.offset;c=this._getStringFormPreviousSiblingsTextNodes(c,d);c=f.getLastWordBoundaryIndex(c,!0);a=a.createRange();a.setStart(b,c+1);a.setEnd(e,d);this.editor.selection.setRng(a);return!0}}else return!1},_renderMentionLink:function(a,b){return JIRA.Editor.Tags.Templates.mentionlink({username:a,displayname:b})},_getUserNameFromInput:function(){if(k.isFunction(this.skipProcessing)&&
this.skipProcessing())return null;var a=this._getSelection();if(a&&a.isCollapsed){a=this._getNodeForUsernameRetrieval();var b=this._getPreviousSiblingsTextNodes(a.node);a=this._getStringFormPreviousSiblingsTextNodes(b,a.offset);return this.currentUserName=f.getUserNameFromCurrentWord(a,a.length)}return null},_getStringFormPreviousSiblingsTextNodes:function(a,b){for(var d="",c=0;c<a.length;c+=1){var e=a[c];d=c===a.length-1?d+e.nodeValue.substring(0,b):d+e.nodeValue}return d},_getPreviousSiblingsTextNodes:function(a){var b=
[];if(a&&a.nodeType===Node.TEXT_NODE)for(;a;a=a.previousSibling)if(a.nodeType===Node.TEXT_NODE){if(b.unshift(a),0<=a.nodeValue.indexOf("@")||0<=a.nodeValue.indexOf("[~"))return b}else break;return[]},_getNodeForUsernameRetrieval:function(){return l.getPreviousNode(this._getDocument())},_getSelection:function(){if(this.$textarea){var a=this.$textarea.get(0);if(a&&a.ownerDocument)return a.ownerDocument.getSelection()}return null},_getDocument:function(){return this.$textarea.get(0).ownerDocument},_getOffsetTarget:function(){return h(this.editor.getContainer())}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:mentions-plugin', location = 'js/plugins/mentions/jira-mentions-plugin.js' */
define("jira/editor/plugins/mentions/jira-mentions",["jira/editor/tinymce","jquery","jira/editor/plugins/mentions/mention-rte","jira/editor/plugins/mentions/mentions-util"],function(e,d,h,f){var g={9:"Tab",13:"Return",27:"Esc",38:"Up",40:"Down"},k=function(b){var a=new d.Event("aui:keydown");a.key=g[b.which];a.shiftKey=b.shiftKey;a.ctrlKey=b.ctrlKey;a.altKey=b.altKey;a.target=b.target;arguments[0]=a;d.event.trigger(a,arguments,document,!0)},l=function(b,a){var c=a.$textarea.get(0).ownerDocument;a.mentioningInProgress=
!1;a.layerController.bind("showLayer",function(){a.mentioningInProgress=!0}).bind("hideLayer",function(){a.mentioningInProgress=!1});b.on("keydown",function(b){if(b.which in g&&!0===a.mentioningInProgress)b.preventDefault(),b.stopPropagation(),k(b);else if(8===b.keyCode&&f.isCaretAfterMention(c)){var d=f.getMentionBeforeCaret(c);f.selectMention(d,b,this)}},!0)};e.create("tinymce.plugins.jira.JiraMentions",{init:function(b){var a=b.settings;if(a.jiramentions.mentionable)b.on("init",function(){var c=
b.getBody(),e=function(){var a=b.selection.getSel();if((a=a?d(a.anchorNode):null)&&(0<a.parents("pre").length||0<a.parents("div.panelHeader,panel-title").length))return!0},f=a.jiramentions.issuekey,g=a.jiramentions.projectkey;d(c).attr("data-issuekey",f);d(c).attr("data-projectkey",g);c._controller||(c._controller=new h(f,b,e));c._controller.textarea(c);l(b,c._controller)})}});e.PluginManager.add("jira.jiramentions",e.plugins.jira.JiraMentions);e.PluginManager.urls["jira.jiramentions"]=!0;return{configure:function(b,
a){a.plugins.push("jira.jiramentions");var c=b.element.$textarea.data();a.jiramentions={issuekey:c.issuekey,projectkey:c.projectkey,mentionable:b.element.$textarea.hasClass("mentionable")}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:polyfil-string-ends-with', location = '/js/polyfills/stringEndsWithPolyfill.js' */
String.prototype.endsWith||(String.prototype.endsWith=function(b,a){if(void 0===a||a>this.length)a=this.length;return this.substring(a-b.length,a)===b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:resources', location = 'js/plugins/paste-plugin.js' */
define("jira/editor/plugins/paste","jira/editor/tinymce jira/editor/converter/util/strings jira/editor/schema jira/editor/analytics jquery wrm/context-path dndattachment/ctrlv/utility dndattachment/ctrlv/base64decode jira/editor/wrm jira/flag jira/util/formatter".split(" "),function(f,h,w,g,l,x,m,y,n,q,r){var z=n.isAttachmentsAllowed();f.create("tinymce.plugins.jira.Paste",{});f.PluginManager.add("jira.paste",f.plugins.jira.Paste);f.PluginManager.urls["jira.paste"]=!0;return{configure:function(e,
d){function f(b){var a=e.editor;if(a&&a.editorUpload&&a.editorUpload.blobCache)return a.editorUpload.blobCache.getByUri(b)}function p(b,a){b=m.convertBlobToImage(b,a);m.dropFileToElement(b,e.element.$textarea)||(console.warn("Uploading attachment failed. Check 'allow attachment' setting."),q.showWarningMsg("","Esta pantalla no admite la adici\u00f3n de archivos adjuntos.",{close:"auto"}),e.editor.dom.remove(e.editor.dom.select('img[data-filename\x3d"'+a+'"]')))}function n(b,a){var c=new XMLHttpRequest;
c.open("GET",b,!0);c.responseType="blob";c.onload=function(b){p(this.response,a)};c.send()}var A={upload:function(){}},t={upload:function(b,a){g.sendEvent("editor.instance.paste.addimage.nocache.http");n(b,a)}},u={upload:function(b,a){g.sendEvent("editor.instance.paste.addimage.nocache.image");a:{if(b){var c=b.split(",")[0].split(":");if(1<c.length){c=c[1].split(";")[0];break a}}c=void 0}c=c||"image/png";p(new Blob([y.decodeBase64DataUri(b)],{type:c}),a)}},v={upload:function(b,a){(b=f(b,e.editor))?
(g.sendEvent("editor.instance.paste.addimage.cache"),p(b.blob(),a)):console.warn("no cached blob found in cache")}};d.plugins.push("paste");d.paste_data_images=!0;d.paste_preprocess=function(b,a){b=e.contextManager.getPasteSchemaForContext();a.content=w.sanitizeHtml(a.content,e.editor,b)};d.paste_postprocess=function(b,a){g.sendEvent("editor.instance.paste");b=l(a.node).find("img:first-child:last-child");if(1===b.length&&b.is("img"))if(a=b[0].src,b.hasClass("emoticon")&&h.startsWith(a,document.location.origin+
x()+"/images/icons/emoticons/"))g.sendEvent("editor.instance.paste.emoticon");else{g.sendEvent("editor.instance.paste.image");var c=a;if(h.isAttachmentPath(a)||h.isThumbnailPath(a))c=h.getFilenameFromHref(a);var d={source:a,filename:c,width:b.attr("width"),height:b.attr("height"),id:b.attr("id"),vspace:b.attr("vspace")};var k=f(a,e.editor)?v:a.match(/^((data|blob):http)|(blob:)/)?t:a.match(/^(data|blob):image/)?u:A;k===u||k===t||k===v?z?(c=m.generateFileName()+".png",k.upload(a,c),d.filename=c,a=
JIRA.Editor.Tags.Templates.image(d),b.replaceWith(l(a))):(q.showWarningMsg("","El administrador de Jira ha deshabilitado la adici\u00f3n de archivos adjuntos.",{close:"auto"}),b.remove()):(a=JIRA.Editor.Tags.Templates.image(d),b.replaceWith(l(a)))}else g.sendEvent("editor.instance.paste.other")};return d}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:resources', location = 'js/plugins/wiki-autoformat/wiki-autoformat-plugin.js' */
define("jira/editor/plugins/wiki-autoformat","jira/editor/tinymce jira/editor/analytics jquery jira/util/version jira/featureflags/feature-manager jira/editor/html-renderer jira/util/logger jira/editor/converter/handlers/bidi-unicode-to-span-handler".split(" "),function(m,h,l,y,r,z,A,B){function u(c){return l("\x3cdiv\x3e\x3c/div\x3e").append(c.cloneNode(!0)).html()}function C(c,a,e){if(!a)throw Error("text node is null");a.nodeType!==Node.TEXT_NODE&&(a=a.childNodes[e-1],e=a.length);for(;a&&a.nodeType===
Node.TEXT_NODE;a=a.previousSibling){-1===e&&(e=a.nodeValue.length);if(e>c)return{container:a,offset:e-c};if(e===c){e=0;for(c=a.parentNode;a=a.previousSibling;)e++;return{container:c,offset:e}}c-=e;e=-1}return null}function v(c){if(!c||!c.collapsed)throw Error("range is null or not collapsed");var a=c.startContainer;var e=c.startOffset;if(a.nodeType===Node.ELEMENT_NODE&&0<e)if(a=a.childNodes[c.startOffset-1],a.nodeType===Node.TEXT_NODE)e=a.nodeValue.length;else return"";else if(a.nodeType!==Node.TEXT_NODE)return"";
c=a.nodeValue.substring(0,e);for(a=a.previousSibling;a&&a.nodeType===Node.TEXT_NODE;a=a.previousSibling)c=a.nodeValue+c;return c}function k(c,a,e,d="",b=!1){return{handles:function(a,e){"string"===typeof d?d=[d]:d&&d.length||(d=[]);e=a.selection.getRng();if(!e.collapsed)return!1;a=a.contextManager;var f=a.isPreContextActive();if(b&&!f||!b&&f)return h.sendEvent("editor.instance.autoformat.prevented",{context:"pre"}),!1;f=0;for(var n=d.length;f<n;++f)if(a.isContextActive(d[f]))return h.sendEvent("editor.instance.autoformat.prevented",
{context:d[f]}),!1;return c.test(v(e))},execute:function(b,d){var f=1;var n=t(d);32===n?b.execCommand("mceInsertContent",!1,"\x26nbsp;"):b.execCommand("mceInsertContent",!1,String.fromCharCode(n));n=b.selection.getRng();var p=v(n);"|"===p[p.length-1]&&(p+=" ",f=0);p=c.exec(p.substring(0,p.length-1));f=C(p[1].length+f,n.commonAncestorContainer,n.startOffset);n.setStart(f.container,f.offset);l(n.commonAncestorContainer);b.selection.setRng(n);a(p,b.selection.getRng());b.selection.getRng();if(e)return d.preventDefault(),
d.stopPropagation(),m.dom.Event.cancel(d),!1}}}function D(c,a,e,d="",b=!1){return{handles:function(a,e){"string"===typeof d?d=[d]:d&&d.length||(d=[]);var f=a.contextManager;a=l(a.selection.getStart()).add(a.selection.getEnd()).add(a.selection.getNode());a=f.isPreContextActive()&&a.is("pre, pre \x3e *");if(b&&!a||!b&&a)return h.sendEvent("editor.instance.autoformat.prevented",{context:"pre"}),!1;a=0;for(var n=d.length;a<n;++a)if(f.isContextActive(d[a]))return h.sendEvent("editor.instance.autoformat.prevented",
{context:d[a]}),!1;return e===c},execute:function(c,b){var f=t(b);32===f?c.execCommand("mceInsertContent",!1,"\x26nbsp;"):c.execCommand("mceInsertContent",!1,a(c,f));if(e)return b.preventDefault(),b.stopPropagation(),m.dom.Event.cancel(b),!1}}}function t(c){return"beforeinput"===c.type?c.data.charCodeAt(0):l.browser.msie?c.keyCode:c.which}function x(){this.handlers={}}function E(c){function a(a,b,p,e,g,h){a=a.charCodeAt(0);var f=AJS.contextPath()+"/images/icons/emoticons/"+g;b=k(b,function(){var a=
c.dom.createHTML("img",{src:f,alt:c.translate(e),title:m.translate(e),border:0,"class":"emoticon emoticon-"+p,"data-emoticon-name":p,align:"absmiddle"});c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})},!0);this.imagePath=f;d.registerHandler(a,b)}function e(a,b){var f=c.formatter.get(a)[0];f=c.dom.create(f.inline,{style:f.styles,class:f.classes&&0<f.classes.length?f.classes.join(" "):""});f.appendChild(document.createTextNode(b+"{$caret}"));c.execCommand("mceInsertContent",!1,u(f),{skip_undo:!0});
c.formatter.remove(a)}var d=new x,b=y.isGreaterThanOrEqualTo("7.0")?"png":"gif";b=[new a(")",g._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile."+b),new a("(",g._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad."+b),new a("P",g._REGEXES_EMOTICON.CHEEKY,"tongue","emotions_dlg.tongue","tongue."+b),new a("p",g._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue."+b),new a("D",g._REGEXES_EMOTICON.LAUGH,"biggrin","emotions_dlg.biggrin","biggrin."+b),new a(")",g._REGEXES_EMOTICON.WINK,
"wink","emotions_dlg.wink","wink."+b),new a(")",g._REGEXES_EMOTICON.THUMBS_UP,"thumbs_up","emotions_dlg.thumbs_up","thumbs_up."+b),new a(")",g._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs_down","emotions_dlg.thumbs_down","thumbs_down."+b),new a(")",g._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information."+b),new a(")",g._REGEXES_EMOTICON.TICK,"check","emotions_dlg.check","check."+b),new a(")",g._REGEXES_EMOTICON.CROSS,"error","emotions_dlg.error","error."+b),new a(")",g._REGEXES_EMOTICON.WARNING,
"warning","emotions_dlg.warning","warning."+b),new a(")",g._REGEXES_EMOTICON.PLUS,"add","emotions_dlg.add","add."+b),new a(")",g._REGEXES_EMOTICON.MINUS,"forbidden","emotions_dlg.forbidden","forbidden."+b),new a(")",g._REGEXES_EMOTICON.QUESTION,"help_16","emotions_dlg.help_16","help_16."+b),new a(")",g._REGEXES_EMOTICON.LIGHT_ON,"lightbulb_on","emotions_dlg.lightbulb_on","lightbulb_on."+b),new a(")",g._REGEXES_EMOTICON.LIGHT_OFF,"lightbulb","emotions_dlg.lightbulb","lightbulb."+b),new a(")",g._REGEXES_EMOTICON.YELLOW_STAR,
"star_yellow","emotions_dlg.star_yellow","star_yellow."+b),new a(")",g._REGEXES_EMOTICON.YELLOW_STAR_2,"star_yellow","emotions_dlg.star_yellow","star_yellow."+b),new a(")",g._REGEXES_EMOTICON.RED_STAR,"star_red","emotions_dlg.star_red","star_red."+b),new a(")",g._REGEXES_EMOTICON.GREEN_STAR,"star_green","emotions_dlg.star_green","star_green."+b),new a(")",g._REGEXES_EMOTICON.BLUE_STAR,"star_blue","emotions_dlg.star_blue","star_blue."+b),new a(")",g._REGEXES_EMOTICON.FLAG,"flag","emotions_dlg.flag",
"flag."+b),new a(")",g._REGEXES_EMOTICON.FLAG_OFF,"flag_grey","emotions_dlg.flag_grey","flag_grey."+b)];for(var w=[],q=0;q<b.length;q++)w[q]=new Image,w[q].src=b[q].imagePath;l.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough"},function(a,c){var f=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\"+a+"(?\x3d[^\\s"+a+"])([^"+a+"]*?[^\\s]))$");d.registerHandler(a.charCodeAt(0),k(f,function(a){e(c,a[2]);h.sendEvent("editor.instance.autoformat.format")},!0))});
c.formatter.register("samp-inline",{inline:"span",classes:"monospace"});b=/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/;r.isFeatureEnabled("jira.renderer.consider.variable.format")&&(b=/(?:^|[^$])(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/);d.registerHandler(125,k(b,function(a){e("samp-inline",a[2]);h.sendEvent("editor.instance.autoformat.inlinecode")},!0));c.formatter.register("cite",{inline:"cite"});d.registerHandler(63,k(/(?:[\s\xA0\u200b]+|^)(\?\?(?=[^\s])([^\?]*?[^\s])\?)$/,function(a){e("cite",
a[2]);h.sendEvent("editor.instance.autoformat.cite")},!0));for(q=1;6>=q;q++)(function(a){d.registerHandler(32,k(new RegExp("^\\u200b?(h"+a+"\\.)$"),function(){c.execCommand("formatBlock",!1,"h"+a,{skip_undo:!0});h.sendEvent("editor.instance.autoformat.header")},!0))})(q);d.registerHandler(32,k(/^\u200b?(bq\.)$/,function(){c.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0});h.sendEvent("editor.instance.autoformat.bq")},!0));d.registerHandler(32,k(/[^-]*[\s](\-\-\-?)$/,function(a){c.execCommand("mceInsertContent",
!1,2===a[1].length?"\u2013":"\u2014",{skip_undo:!0});h.sendEvent("editor.instance.autoformat.dash")},!1));b=k(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,function(a){c.execCommand("mceInsertContent",!1,a[2]+(2===a[3].length?"\u2013":"\u2014")+a[4],{skip_undo:!0})},!1);d.registerHandler(32,b);d.registerHandler(m.util.VK.ENTER,b);b=k(/^\u200b?(\-\-\-\-)$/,function(){c.execCommand("mceInsertContent",!1,"\x3chr /\x3e",{skip_undo:!0});h.sendEvent("editor.instance.autoformat.hr")},!0);d.registerHandler(32,b);d.registerHandler(m.util.VK.ENTER,
b);b=/(\{code)$/;r.isFeatureEnabled("jira.renderer.consider.variable.format")&&(b=/(?:^|[^$])(\{code)$/);d.registerHandler(125,k(b,function(){c.execCommand("mceInsertContent",!1,'\x3cdiv class\x3d"code panel" style\x3d"border-width: 1px;"\x3e\x3cdiv class\x3d"codeContent panelContent"\x3e\x3cpre class\x3d"code-java"\x3e{$caret} \x3c/pre\x3e\x3c/div\x3e\x3c/div\x3e');h.sendEvent("editor.instance.autoformat.code")},!0));b=/(\{panel)$/;r.isFeatureEnabled("jira.renderer.consider.variable.format")&&(b=
/(?:^|[^$])(\{panel)$/);d.registerHandler(125,k(b,function(){c.execCommand("mceInsertContent",!1,'\x3cdiv class\x3d"plain panel"\x3e\x3cpanel-title\x3e'+"Mi t\u00edtulo"+"\x3c/panel-title\x3e\x3cp\x3e{$caret} \x3c/p\x3e\x3c/div\x3e");h.sendEvent("editor.instance.autoformat.panel")},!0));b=/(\{noformat)$/;r.isFeatureEnabled("jira.renderer.consider.variable.format")&&(b=/(?:^|[^$])(\{noformat)$/);d.registerHandler(125,k(b,function(){c.execCommand("mceInsertContent",
!1,'\x3cdiv class\x3d"preformatted panel" style\x3d"border-width: 1px;"\x3e\x3cdiv class\x3d"preformattedContent panelContent"\x3e\x3cpre\x3e{$caret} \x3c/pre\x3e\x3c/div\x3e\x3c/div\x3e');h.sendEvent("editor.instance.autoformat.noformat")},!0));d.registerHandler(m.util.VK.ENTER,k(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,function(a){var b="\x3ctable class\x3d'confluenceTable'\x3e\x3ctr\x3e",f="",d=!0;a=l(a[1].slice(2,-2).split("||")).map(function(a){a=l.trim(this);d=d&&""===a;return a});d&&(a[0]=
"editor.autoformat.sampletext.firstcell");for(var e=0,g=a.length;e<g;e++)b+="\x3cth class\x3d'confluenceTh'\x3e"+a[e]+"\x3c/th\x3e",f+="\x3ctd class\x3d'confluenceTd'\x3e\x26#x200b;\x3c/td\x3e";c.execCommand("mceInsertContent",!1,b+("\x3c/tr\x3e\x3ctr\x3e"+f+"\x3c/tr\x3e\x3c/table\x3e"),{skip_undo:!0});c.selection.select(l(c.selection.getRng().commonAncestorContainer).parents("table").find(d?"th":"td")[0].childNodes[0]);l(c.selection.getRng().startContainer).parent().closest('[contenteditable\x3d"true"]').focus();
h.sendEvent("editor.instance.table.autoformat.plain")},!0,"table"));d.registerHandler(m.util.VK.ENTER,k(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,function(a){var b="\x3ctable class\x3d'confluenceTable'\x3e\x3ctr\x3e",f=!0;a=l(a[1].slice(1,-1).split("|")).map(function(a){a=l.trim(this);f=f&&""===a;return a});f&&(a[0]="editor.autoformat.sampletext.firstcell");for(var d=0,e=a.length;d<e;d++)b+="\x3ctd class\x3d'confluenceTd'\x3e"+a[d]+"\x3c/td\x3e";c.execCommand("mceInsertContent",!1,b+
"\x3c/tr\x3e\x3c/table\x3e",{skip_undo:!0});f&&c.selection.select(l(c.selection.getRng().commonAncestorContainer).parents("table").find("td")[0].childNodes[0]);l(c.selection.getRng().startContainer).parent().closest('[contenteditable\x3d"true"]').focus();h.sendEvent("editor.instance.table.autoformat")},!0,"table"));l.each({"]":/(?:\s|^)((\[[^\[^\]]+))$/,"\r":/(?:\s|^)((\[[^\[^\]]+)(?:\]))$/," ":/(?:\s|^)((\[[^\[^\]]+)(?:\]))$/},function(a,b){d.registerHandler(a.charCodeAt(0),k(b,function(a,b){a=a[1]+
(a[1].endsWith("]")?"":"]");z.renderMarkup(a,c.settings.target.getRenderParams()).then(function(a){a=l((new DOMParser).parseFromString(a,"text/html").body).find("p").unwrap().html();c.execCommand("mceInsertContent",!1,a,{skip_undo:!0});h.sendEvent("editor.instance.autoformat.wikilink")})},!0))});b=k(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,function(a){var b=c.dom.create("a",{href:a[3]?a[1]:"http://"+a[1]});b.appendChild(document.createTextNode(a[1]));c.execCommand("mceInsertContent",
!1,u(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{});h.sendEvent("editor.instance.autoformat.autolink")},!1,"a");d.registerHandler(32,b);d.registerHandler(m.util.VK.ENTER,b);b=k(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,
function(a){var b=c.dom.create("a",{href:"mailto:"+a[1]});b.appendChild(document.createTextNode(a[1]));c.execCommand("mceInsertContent",!1,u(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{})},!1,"a");d.registerHandler(32,b);d.registerHandler(m.util.VK.ENTER,b);b=function(a,b){a=k(a,function(){c.execCommand("mceInsertContent",!1,b,{skip_undo:!0});h.sendEvent("editor.instance.autoformat.quickcorrect")},!1);d.registerHandler(32,a);d.registerHandler(m.util.VK.ENTER,a)};b(/(?:\b|^)(jira)$/i,"Jira");
b(/(?:\b|^)(bitbucket|[Bb]itBucket)$/,"Bitbucket");b(/(?:\b|^)(atlassian)$/,"Atlassian");b(/(?:\b|^)([Hh]ipchat)$/,"HipChat");r.isFeatureEnabled("jira.richeditor.bidi.warning")&&(new B(c,d,D)).registerHandlers();c.on("keydown",function(a){var b=t(a);if(b===m.util.VK.ENTER)return d.executeHandlers(b,c,a)},!0);c.on("keypress",function(a){return d.executeHandlers(t(a),c,a)},!0);c.on("beforeinput",function(a){if(null!==a&&"insertText"===a.inputType)return d.executeHandlers(t(a),c,a)},!0)}var g={_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,
SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,FLAG:/\B(\(flag)$/,FLAG_OFF:/\B(\(flagoff)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}};
x.prototype={registerHandler:function(c,a){this.handlers[c]||(this.handlers[c]=[]);this.handlers[c].push(a)},executeHandlers:function(c,a,e){var d=!0;l.each(this.handlers[c]||[],function(b,g){if(g.handles(a,c))return d=g.execute(a,e),A.trace("jira.editor.wiki.autoformatted"),!1});return d}};m.create("tinymce.plugins.jira.WikiAutoFormat",{init:function(c){c.on("init",function(){E(c)})}});m.PluginManager.add("jira.wikiautoformat",m.plugins.jira.WikiAutoFormat);m.PluginManager.urls["jira.wikiautoformat"]=
!0;return{configure:function(c,a){a.plugins.push("jira.wikiautoformat")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:resources', location = 'js/plugins/wiki-autoformat/bidi-unicode-to-span-handler.js' */
define("jira/editor/converter/handlers/bidi-unicode-to-span-handler",["jira/util/formatter"],function(b){const c=[8294,8295,8296,8297,8234,8235,8236,8237,8238];class d{constructor(a,e,b){this.editor=a;this.handlerManager=e;this.handlerCreator=b}registerHandlers(){this.editor&&this.handlerManager&&this.handlerCreator&&c.forEach(a=>{this._biDiCharHandler(a)})}_getBiDiSpan(a){return this.editor.dom.createHTML("span",{contentEditable:"false",title:"Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.",
"class":"bidi-unicode","data-bidi-character-code":a.toString(16).padStart(4,"0").toUpperCase()},String.fromCharCode(a))}_biDiCharHandler(a){const b=this.handlerCreator(a,()=>this._getBiDiSpan(a),!0,"",!0);this.handlerManager.registerHandler(a,b)}}return d});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:resources', location = 'js/plugins/prevent-default-plugin.js' */
define("jira/editor/plugins/prevent-default",["jira/editor/tinymce","jquery"],function(a,d){a.create("tinymce.plugins.jira.PreventDefaultPlugin",{init:function(a){var c=a.settings;a.on("init",function(){var b=a.getBody()._controller;if(b&&b.$textarea&&b.$textarea.get(0)&&(b=b.$textarea.get(0).ownerDocument)){var e=c.preventdefault.selector;d(b).on("click",e,function(a){a.preventDefault()})}})}});a.PluginManager.add("jira.preventdefault",a.plugins.jira.PreventDefaultPlugin);a.PluginManager.urls["jira.preventdefault"]=
!0;return{configure:function(a,c){c.plugins.push("jira.preventdefault");c.preventdefault={selector:"a[contenteditable\x3dfalse]"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:resources', location = 'js/plugins/editor-content-postprocess-plugin.js' */
define("jira/editor/plugins/editor-content-postprocess",["jira/editor/tinymce","jira/editor/converter/util/strings","jira/editor/util/temporaryAttachment","jira/editor/analytics"],function(e,g,h,k){var c=function(b,f){return 0<=(b&&b.attr("class")||"").indexOf(f)},l=function(b){b.parser.addAttributeFilter("class",function(b){for(var a=b.length,d;a--;)d=b[a],c(d,"user-hover")&&(d.attr("contenteditable","false"),d.attr("tabindex","-1"))})},m=function(b){b.parser.addNodeFilter("h1,h2,h3,h4,h5,h6",function(b){for(var a=
function(a,d){var b=[];for(a=a.firstChild;a;a=a.next)a.name!==d||a.firstChild||b.push(a);return b},d=b.length,c;d--;)c=b[d],a(c,"a").filter(function(a){return"undefined"!==typeof a.attr("name")}).forEach(function(a){a.remove()})})},n=function(b){b.parser.addNodeFilter("div,pre",function(b){b.forEach(function(a){a.parent&&"pre"===a.parent.name&&"panel-title"!==a.name&&a.unwrap();a.attr("class")||"pre"!==a.name||a.unwrap();if(c(a,"panel")&&!c(a,"panelHeader")&&!c(a,"panelContent")){c(a,"preformatted")&&
a.attr("class","noformat panel");a.lastChild&&a.lastChild.firstChild&&/^code/.test(a.lastChild.firstChild.attr("class"))&&(a.attr("data-language",a.lastChild.firstChild.attr("class")),a.attr("class","code panel"));var b=a.firstChild;if(c(b,"panelHeader")){var f=b.attr("style");b.firstChild.unwrap();b.name="panel-title";b.attr("class",f)}b=a.lastChild;if(c(b,"panel")||c(b,"panelContent"))b.attr("style"),(c(a,"noformat")||c(a,"code"))&&b.firstChild.unwrap(),b.unwrap();c(a,"noformat")||c(a,"code")?a.name=
"pre":a.attr("class","plain panel")}})})},p=function(b){b.parser.addNodeFilter("img",function(c){if(0!==c.length){var a=h.getFormToken(b.getContainer());a?c.filter(function(b){b=b.attr("src");return g.isTemporaryAttachmentPath(b)?!g.contains(b,"/secure/temporaryattachment/"+a):!1}).forEach(function(a){a.remove();k.sendEvent("editor.plugin.content-postprocess.temporary-attachment.removed")}):console.warn("formToken not found, skipping invalid temporary attachment content post processing")}})};e.create("tinymce.plugins.jira.EditorContentPostprocess",
{init:function(b){b.on("PreInit",function(){p(b);l(b);m(b);n(b)})}});e.PluginManager.add("jira.editorcontentpostprocess",e.plugins.jira.EditorContentPostprocess);e.PluginManager.urls["jira.editorcontentpostprocess"]=!0;return{configure:function(b,c){c.plugins.push("jira.editorcontentpostprocess");c.editor_content_postprocess={};return c}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/node-handler.js' */
define("jira/editor/converter/handlers/node-handler","jira/editor/converter/util/strings jira/editor/converter/util/rte-strings jira/editor/converter/new-lines/new-lines jira/editor/constants jira/lib/class underscore jquery".split(" "),function(n,l,e,g,p,k,f){var h={},m=[],b=p.extend({init:function(a){this.node=a},before:function(){return new b.EmptyHandler},processText:function(){return""},after:function(){return new b.EmptyHandler},children:function(){var a=[],b=this.node.childNodes,d=k.filter(b,
function(a,c){a=this.createChildHandler(a,c,b.length);return""===a.processText()?!0:l.isWhitespace(a.processText())&&n.contains(a.processText(),"\n")&&!a.preformatted?!1:!0},this);k.each(d,function(b,c){a.push(this.createBeforeChild(b,c,d.length));a.push(this.createChildHandler(b,c,d.length));a.push(this.createAfterChild(b,c,d.length))},this);return a},createBeforeChild:function(a,c,d){return new b.EmptyHandler},createAfterChild:function(a,c,d){return new b.EmptyHandler},createChildHandler:function(a,
c,d){return b.createHandler(a)},newLinesBefore:function(){var a=b._isBlock(this.node.parentNode)||f(this.node).parents().is("th, td");return!b._isBlock(this.node)||f(this.node).is(":first-child")&&a?e.empty():e.single(!0)},newLinesAfter:function(){return e.empty()},getPreviousSibling:function(){return this.node.previousSibling},getNextSibling:function(){return this.node.nextSibling},isNextSiblingBreakLine:function(){return"BR"===this.node.nextSibling.tagName},isPreviousSiblingBreakLine:function(){return"BR"===
this.node.previousSibling.tagName},previousSiblingEndsWithWhitespace:function(){return this.getPreviousSibling().textContent.match(g.RIGHT_WHITESPACE_MATCHER)},nextSiblingStartsWithWhitespace:function(){return this.getNextSibling().textContent.match(g.LEFT_WHITESPACE_MATCHER)},endsWithWhitespace:function(){return this.node.textContent.match(g.RIGHT_WHITESPACE_MATCHER)},startsWithWhitespace:function(){return this.node.textContent.match(g.LEFT_WHITESPACE_MATCHER)},shouldUseAlternativeSyntax:function(){return!this.startsWithWhitespace()&&
this.getPreviousSibling()&&!this.isPreviousSiblingBreakLine()&&!this.previousSiblingEndsWithWhitespace()||!this.endsWithWhitespace()&&this.getNextSibling()&&!this.isNextSiblingBreakLine()&&!this.nextSiblingStartsWithWhitespace()?!0:!1}});b.EmptyHandler=b.extend({init:function(a){this.node=a},before:function(){throw void 0;},after:function(){throw void 0;},processText:function(){return""},children:function(){return[]}});b.addHandler=function(a,b){a=a.toLowerCase();h[a]=b;m.push(a)};b.getHandler=function(a){var c=
a.nodeName.toLowerCase();return h[(c+"."+(a.className||"")).toLowerCase()]||h[c]||m.reduce(function(b,c){return b||f(a).is(c)&&h[c]},null)||b};b.createHandler=function(a){return new (b.getHandler(a))(a)};b.isInsideTable=function(a){return 0<f(a).parents("td").length||0<f(a).parents("th").length};b.singleNewLineExceptTable=function(a,c){return b.isInsideTable(a)?e.empty():e.single(c)};b._isBlock=k.memoize(function(a){if(!a||!a.tagName)return!1;var b=document.createElement("div");a=document.createElement(a.tagName);
b.appendChild(a);document.body.appendChild(b);try{return"block"===window.getComputedStyle(a).display}finally{document.body.removeChild(b)}},function(a){return a&&a.tagName?a.tagName:""});b.isEmptyTextNode=function(a){return a?a.nodeType===Node.TEXT_NODE&&""===l.trim(a.nodeValue):!1};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/empty-handler.js' */
define("jira/editor/converter/handlers/empty-handler",["jira/editor/converter/handlers/node-handler"],function(a){return a.EmptyHandler});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/block-handler.js' */
define("jira/editor/converter/handlers/block-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/new-lines/new-lines jira/editor/converter/util/strings jira/editor/converter/util/color-converter jira/editor/converter/handlers/bidi-unicode-handler jquery".split(" "),function(b,c,d,f,e,l,g){const m=/^[a-zA-Z]+$/;var k=b.extend({init:function(a){this.wrapperNode=a;this.node=a.querySelector(".panelContent")||a;this.nodeHeader=a.querySelector("panel-title")||
a.querySelector(".panelHeader");this.attrs=this.getAttrs();g(this.node).is(".panelContent")&&this.workaroundTypingOutsideWrapper()},workaroundTypingOutsideWrapper:function(){var a=g(this.wrapperNode);a.find("\x3e p").before('\x3cbr data-mce-bogus\x3d"1"\x3e');this.node?a.find("\x3e :not(div.preformattedContent.panelContent, div.codeContent.panelContent, div.panelHeader, div.panelContent)").detach().appendTo(this.node):this.node=this.wrapperNode},getAttrs:function(){var a=[];this.nodeHeader&&(this.nodeHeader.textContent&&
a.push("title\x3d"+this.nodeHeader.textContent),this.nodeHeader.style.borderBottomStyle&&a.push("borderStyle\x3d"+this.nodeHeader.style.borderBottomStyle),this.nodeHeader.style.borderBottomWidth&&"1px"!==this.nodeHeader.style.borderBottomWidth&&a.push("borderWidth\x3d"+this.nodeHeader.style.borderBottomWidth),this.nodeHeader.style.borderBottomColor&&a.push(`borderColor=${this._getProperColorValue(this.nodeHeader.style.borderBottomColor)}`),this.nodeHeader.style.backgroundColor&&a.push(`titleBGColor=${this._getProperColorValue(this.nodeHeader.style.backgroundColor)}`));
this.wrapperNode&&this.wrapperNode.style.backgroundColor&&a.push("bgColor\x3d"+e.colorToHex(this.wrapperNode.style.backgroundColor));return 0<a.length?a.join("|"):""},_getProperColorValue:function(a){return this._isNamedColor(a)?a:e.colorToHex(a)},_isNamedColor:function(a){return m.test(a)},createChildHandler:function(a,d,e){return a.nodeType===Node.TEXT_NODE?c.createPreformattedTextHandler(a):"BR"===a.tagName?c.newlineHandler():"IMG"===a.tagName?f.startsWith(a.src,"data")||f.startsWith(a.src,"blob")?
(a=document.createTextNode("(attachment)"),c.createTextHandler(a)):b.createHandler(a):"SPAN"===a.nodeName&&"bidi-unicode"===a.className?new l(a):"PRE"===a.tagName?new h(a):"PANEL-TITLE"===a.tagName?new b.EmptyHandler(a):new h(a)},children:function(){var a=b.prototype.children.apply(this,arguments);a.unshift(d.single(!0));return a},newLinesBefore:function(){return b.singleNewLineExceptTable(this.wrapperNode,!0)},newLinesAfter:function(){return b.singleNewLineExceptTable(this.wrapperNode,!0)}}),h=b.extend({createChildHandler:k.prototype.createChildHandler,
newLinesBefore:function(){return d.empty()},before:function(){return new b.EmptyHandler},after:function(){return new b.EmptyHandler}});return k});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/text-handler.js' */
define("jira/editor/converter/handlers/text-handler",["jira/featureflags/feature-manager","jira/editor/converter/util/strings","jira/editor/converter/util/rte-strings","jira/editor/converter/handlers/node-handler","jira/editor/context-detector"],function(d,e,f,g,h){var c=g.extend({init:function(a){this.node=a;this.preformatted=this.node.preformatted},processText:function(){var a=this.node.textContent||"";if(this.node.preformatted)return a;f.isWhitespace(a)||(a=this.trimNewlines(a));a=d.isFeatureEnabled("jira.renderer.consider.variable.format")?
a.replace(/([^$])({[^}]+})/g,"$1\\$2").replace(/(\$)({[^}]+)$/g,"$1\\$2"):a.replace(/{/g,"\\{");h.detectTable(this.node)&&(a=e.replace(a,"|","\\|"));return a},children:function(){return[]},trimNewlines:function(a){var b;for(b=0;b<a.length&&f.isWhitespace(a[b]);b++);var c;for(c=a.length-1;0<=c&&f.isWhitespace(a[c]);c--);var d=a.substring(0,b);b=a.substring(b,c+1);a=a.substring(c+1);return e.replace(d,"\n","")+b+e.replace(a,"\n","")}});c.createTextHandler=function(a){var b=a;a instanceof Node&&(b=a.textContent);
return new c({textContent:b||""})};c.createPreformattedTextHandler=function(a){var b=a;a instanceof Node&&(b=a.textContent);return new c({textContent:b||"",preformatted:!0})};c.newlineHandler=function(){return new c({textContent:"\n",preformatted:!0})};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/heading-handler.js' */
define("jira/editor/converter/handlers/heading-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler"],function(b,d,e){var c={H1:"h1. ",H2:"h2. ",H3:"h3. ",H4:"h4. ",H5:"h5. ",H6:"h6. "};return b.extend({init:function(a){this.node=a},newLinesBefore:function(){return b.singleNewLineExceptTable(this.node,!0)},before:function(){var a=this.node.tagName;return a in c?d.createTextHandler(c[a]):new e},newLinesAfter:function(){return b.singleNewLineExceptTable(this.node)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/bold-handler.js' */
define("jira/editor/converter/handlers/bold-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,b,c){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{*}":"*"},before:function(){return b.createTextHandler(this.marker)},after:function(){return b.createTextHandler(this.marker)}});return c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/emphasis-handler.js' */
define("jira/editor/converter/handlers/emphasis-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,b,c){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{_}":"_"},before:function(){return b.createTextHandler(this.marker)},after:function(){return b.createTextHandler(this.marker)}});return c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/monospaced-handler.js' */
define("jira/editor/converter/handlers/monospaced-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(c,b){return c.extend({init:function(a){this.node=a;this.openingMarker=(a=this.shouldUseAlternativeSyntax())?"{{{}":"{{";this.closingMarker=a?"{}}}":"}}"},before:function(){return b.createPreformattedTextHandler(this.openingMarker)},after:function(){return b.createPreformattedTextHandler(this.closingMarker)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/link-handler.js' */
define("jira/editor/converter/handlers/link-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/image-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/handlers/superscript-handler jira/editor/converter/util/strings jira/editor/converter/util/uri jquery".split(" "),function(k,b,l,g,m,c,h,f){var d=k.extend({init:function(a){this.node=a;var b=this.node.getAttribute("href"),e=c.resolveUrl(b,c.getBaseUrl()),
g=a.getAttribute("data-filename");d.isAnchor(b)?e=b:d.isAttachment(e)||g?(this.attachment=g||c.getFilenameFromHref(e),f(a).find("\x3e:first-child:last-child").is("img")&&(this.imageAttachment=this.attachment)):d.isIssue(e)?this.issueKey=c.substringAfter(e,c.getContextUrl()+"/browse/"):d.isProfile(e,a)?this.username=h.decodeUri(c.substringAfter(e,"ViewProfile.jspa?name\x3d")):d.isWiki(e,a)&&(this.wikiLink=f(a).text());this.href=e},before:function(){var a=f(this.node.previousSibling).is("a")?" ":"";
return this.imageAttachment?b.createTextHandler(a+"!"):this.attachment?b.createTextHandler(a+"[^"):this.issueKey?new g:this.username?b.createTextHandler(a+"[~"):this.href||this.wikiLink?b.createTextHandler(a+"["):new g},children:function(){return this.imageAttachment?[b.createTextHandler(""+this.imageAttachment)]:this.attachment?[b.createTextHandler(""+this.attachment)]:this.username?[b.createTextHandler(""+this.username)]:d.isAnchor(this.href,this.node)?b.createTextHandler(this.href):d.isMailto(this.href,
this.node)?this._filterMailtoChildren(this._super()):this._super()},after:function(){if(this.imageAttachment){var a=l.getAttrs(f(this.node).find("\x3e img")[0]);return b.createTextHandler(a+"!")}return this.attachment||this.wikiLink?b.createTextHandler("]"):this.issueKey?new g:this.username?b.createTextHandler("]"):this.href?this.href===f(this.node).text()||d.isAnchor(this.href,this.node)?b.createTextHandler("]"):b.createTextHandler("|"+this.href+"]"):new g},_filterMailtoChildren:function(a){3<=a.length&&
a[a.length-2]instanceof m&&(a=a.splice(0,a.length-3));return a}});d.isAttachment=function(a){/^\//.test(a)&&(a=window.location.origin+a);return c.startsWith(a,c.getContextUrl()+"/secure/attachment/")||c.startsWith(a,"../secure/attachment/")};d.isIssue=function(a){/^\//.test(a)&&(a=window.location.origin+a);return c.startsWith(a,c.getContextUrl()+"/browse/")};d.isProfile=function(a,b){return c.contains(a,"ViewProfile.jspa?name\x3d")&&f(b).is(".user-hover")};d.isWiki=function(a,b){return c.contains(a,
"/wiki/display/")&&c.endsWith(h.decodeUri(a),"/"+f(b).text())};d.isMailto=function(a,b){return c.startsWith(a,"mailto:")};d.isAnchor=function(a,b){return c.startsWith(a,"#")&&(!b||a==="#"+f(b).text())};return d});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/linebreak-handler.js' */
define("jira/editor/converter/handlers/linebreak-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jquery"],function(a,b,c){return a.extend({init:function(a){this.node=a},before:function(){return new a.EmptyHandler},children:function(){return new a.EmptyHandler},after:function(){return this.node.previousSibling||this.node.nextSibling||!c(this.node).parent().is("td, th")?this.node.previousSibling&&"BR"===this.node.previousSibling.tagName&&c(this.node).parent().is("td, th")?
new b({textContent:decodeURI("%C2%A0")+"\n",preformatted:!0}):b.newlineHandler():b.createTextHandler(" ")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/image-handler.js' */
define("jira/editor/converter/handlers/image-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/empty-handler jquery jira/editor/converter/util/strings wrm/context-path".split(" "),function(h,d,e,k,c,l){var f=h.extend({init:function(a){this.node=a;this.imageType=this._getImageType(a)},_getImageType:function(a){if(this.node.getAttribute("imagetext"))return"placeholder";var b=this.node.getAttribute("data-image-type");if(b)return b;
if(b=this.node.getAttribute("src"))return c.isEmotePath(b)&&a.classList.contains("emoticon")?c.contains(b,"/images/icons/mail_small")&&this.$(a).parents("a").is(".external-link")?void 0:"emote":c.isAttachmentPath(b)||c.isThumbnailPath(b)||b.match(/^((data|blob):http)|(data:image)/)?"attachment-image":c.isTemporaryAttachmentPath(b)?"temporary-attachment-image":"external-image"},before:function(){var a=this.node.previousSibling;a=a&&a.nodeType===Node.TEXT_NODE&&!c.endsWith(a.textContent," ")?" ":"";
return this.imageType&&"emote"!==this.imageType?d.createTextHandler(a+"!"):new e},children:function(){return this.imageType?d.createTextHandler(this._getImageSource()):new e},after:function(){var a=this.node.nextSibling;a=a&&a.nodeType===Node.TEXT_NODE&&!c.startsWith(a.textContent," ")?" ":"";return this.imageType&&"emote"!==this.imageType?d.createTextHandler("!"+a):new e},_getImageSource:function(){if("placeholder"===this.imageType)return this.node.getAttribute("imagetext");if("emote"===this.imageType){var a=
this.node.getAttribute("src"),b=c.substringAfter(a,"/images/icons/emoticons/").replace(/\.(png|gif)$/,"");if(b in g)return g[b];if(c.startsWith(a,l()))return"!"+document.location.origin+a+"!"}else if("attachment-image"===this.imageType||"temporary-attachment-image"===this.imageType||"external-image"===this.imageType)return a=this.node.getAttribute("data-filename")||this.node.getAttribute("href")||this.node.getAttribute("src"),"attachment-image"===this.imageType?a=c.getFilenameFromHref(a):"temporary-attachment-image"!==
this.imageType||this.node.getAttribute("data-filename")||(a=c.getFilenameFromHref(a,!0)),(b=f.getAttrs(this.node))?a+b:a}});f.getAttrs=function(a){if(k(a).is("img.emoticon"))return"";var b=[];a.width&&b.push("width\x3d"+a.width);a.height&&b.push("height\x3d"+a.height);a.id&&b.push("id\x3d"+a.id);a.vspace&&b.push("vspace\x3d"+a.vspace);a.align?b.push("align\x3d"+a.align):a.style.textAlign?b.push("align\x3d"+a.style.textAlign):a.style["float"]&&b.push("align\x3d"+a.style["float"]);c.isThumbnailPath(a.getAttribute("src"))&&
b.push("thumbnail");return 0<b.length?"|"+b.join(","):""};var g={smile:":)",sad:":(",tongue:":P",biggrin:":D",wink:";)",thumbs_up:"(y)",thumbs_down:"(n)",information:"(i)",check:"(/)",error:"(x)",warning:"(!)",add:"(+)",forbidden:"(-)",help_16:"(?)",lightbulb_on:"(on)",lightbulb:"(off)",star_yellow:"(*)",star_red:"(*r)",star_green:"(*g)",star_blue:"(*b)",flag:"(flag)",flag_grey:"(flagoff)"};return f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/code-block-handler.js' */
define("jira/editor/converter/handlers/code-block-handler",["jira/editor/converter/handlers/block-handler","jira/editor/converter/handlers/text-handler","jquery"],function(d,b,c){return d.extend({init:function(a){this._super(a);this.language=this.getLanguage()},getLanguage:function(){var a=c(this.node).is("pre")?this.node:this.node.querySelector("pre");return(a=c(a).attr("data-language"))?a.replace("code-",""):""},before:function(){var a=[];this.language&&a.push(this.language);this.attrs&&a.push(this.attrs);
a=a.length?":"+a.join("|"):"";return b.createPreformattedTextHandler("{code"+a+"}")},after:function(){return b.createPreformattedTextHandler("{code}")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/noformat-handler.js' */
define("jira/editor/converter/handlers/noformat-handler",["jira/editor/converter/handlers/block-handler","jira/editor/converter/handlers/text-handler"],function(b,a){return b.extend({before:function(){return a.createPreformattedTextHandler("{noformat"+(this.attrs?":"+this.attrs:"")+"}")},after:function(){return a.createPreformattedTextHandler("{noformat}")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-type-matcher.js' */
define("jira/editor/converter/handlers/list-type-matcher",["jquery","underscore"],function(d,c){var a={selectorBulletMap:{}};a.selectorBulletMap["ul:not(.alternate)"]="*";a.selectorBulletMap["ul.alternate"]="-";a.selectorBulletMap.ol="#";a.DEFAULT_DECORATOR="*";a.matchBullet=function(b){return c.find(a.selectorBulletMap,function(a,c){return d(b).is(c)})};a.getBulletDecorator=function(b){return a.matchBullet(b)||a.DEFAULT_DECORATOR};a.isListNode=function(b){return null!=a.matchBullet(b)};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-handler.js' */
define("jira/editor/converter/handlers/list-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/handlers/list-type-matcher jquery jira/editor/converter/new-lines/new-lines jira/editor/context-detector".split(" "),function(d,f,e,g,h,c,k){return d.extend({init:function(a,b){this.node=a;this.type=this.node.getAttribute("type");this.depth="undefined"===typeof b?0:b;this.bulletDecorator=g.getBulletDecorator(a)},
createChildHandler:function(a){var b=d.getHandler(a);return"LI"===a.tagName?new b(a,this.depth,this.bulletDecorator):new b(a)},before:function(){return new e},newLinesBefore:function(){return 0===this.depth&&k.detectTable(this.node)&&this.node.previousSibling&&!d.isEmptyTextNode(this.node.previousSibling)?c.single(!0):c.empty()},newLinesAfter:function(){return 0!==this.depth||h(this.node).is(":last-child")?c.empty():new c(2,!0)},createAfterChild:function(a,b,c){return b!==c-1?f.newlineHandler():new e}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/list-item-handler.js' */
define("jira/editor/converter/handlers/list-item-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/handlers/list-type-matcher","jira/editor/converter/util/strings"],function(d,e,f,g,h){return d.extend({init:function(a,b,c){this.node=a;this.depth="undefined"===typeof b?0:b;this.bulletDecorator=c},before:function(){var a=h.repeat(this.bulletDecorator,this.depth+1);return e.createTextHandler(" "+
a+" ")},after:function(){return new f},createBeforeChild:function(a,b,c){return g.isListNode(a)?e.newlineHandler():new f},createChildHandler:function(a,b,c){b=d.getHandler(a);return g.isListNode(a)?new b(a,this.depth+1):new b(a)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-handler.js' */
define("jira/editor/converter/handlers/table-handler",["jira/editor/converter/handlers/node-handler","jira/editor/context-detector","jira/editor/converter/new-lines/new-lines"],function(b,c,d){return b.extend({init:function(a){this.node=a},newLinesBefore:function(){var a=c.detectTable(this.node.previousElementSibling);return d.single(!a)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-row-handler.js' */
define("jira/editor/converter/handlers/table-row-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/new-lines/new-lines"],function(e,b,f,g){return e.extend({init:function(a){this.node=a},createBeforeChild:function(a,c,d){return"TH"===a.tagName?b.createTextHandler("||"):b.createTextHandler("|")},newLinesAfter:function(){return g.single()},createAfterChild:function(a,c,d){return c===
d-1?"TH"===a.tagName?b.createTextHandler("||"):b.createTextHandler("|"):new f}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/table-data-handler.js' */
define("jira/editor/converter/handlers/table-data-handler",["jira/editor/converter/handlers/node-handler"],function(a){return a.extend({init:function(a){this.node=a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/paragraph-handler.js' */
define("jira/editor/converter/handlers/paragraph-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/empty-handler","jira/editor/converter/new-lines/new-lines","jquery"],function(c,d,a,b){return c.extend({init:function(a){this.node=a},newLinesBefore:function(){return null===this.node.previousElementSibling&&b(this.node).parents().is("td, th, .panelContent, .panel")?a.empty():null!==this.node.previousElementSibling?a.single():a.empty()},newLinesAfter:function(){return b(this.node).is(":last-child")&&
b(this.node).parents().is("td, th")?a.empty():a.single(b(this.node).parents().is("td, th"))},before:function(){return new d}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/quote-handler.js' */
define("jira/editor/converter/handlers/quote-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler"],function(b,a){return b.extend({init:function(a){this.node=a},before:function(){return a.createPreformattedTextHandler("{quote}")},after:function(){return a.createPreformattedTextHandler("{quote}")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/panel-handler.js' */
define("jira/editor/converter/handlers/panel-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/block-handler"],function(c,b,d){return d.extend({init:function(a){a.firstChild&&a.className===a.firstChild.className&&(a=a.firstChild);this.node=a;this._super(a)},before:function(){return b.createPreformattedTextHandler("{panel"+(this.attrs?":"+this.attrs:"")+"}")},createChildHandler:function(){return c.prototype.createChildHandler.apply(this,
arguments)},after:function(){return b.createPreformattedTextHandler("{panel}")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/span-handler.js' */
define("jira/editor/converter/handlers/span-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/util/strings jira/editor/converter/util/color-converter jquery".split(" "),function(f,b,d,c,g,h){var e={white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",
blue:"#0000FF",navy:"#000080",purple:"#800080",orange:"#FFA500",brown:"#AA4B00",mahogany:"#C04000",pink:"#FFC0CB","yellow orche":"#CF912A",harlequin:"#3FFF00",mauvelous:"#EF98AA","dark red":"#8B0000",saffron:"#F4C430",sepia:"#704214",fuchsia:"#FF00FF",magenta:"#FF00FF",marsala:"#955251",indigo:"#000080"};return f.extend({init:function(a){this.node=a;this.$node=h(this.node);this.node.getAttribute("href");"underline"===this.getStyle(this.node,"textDecoration")?this.decorator="underline":"error"===this.node.className?
(a=this.$node.text(),c.getFilenameFromError(a)&&(this.decorator="attachment-error")):0<c.length(this.getStyle(this.node,"color"))?(a=this.getStyle(this.node,"color").toLowerCase(),c.contains(a,"rgb")?this.color=g.colorToHex(a):c.contains(a,"#")?this.color=a:a in e&&(this.color=e[a.toLowerCase()]),void 0!==this.color&&(this.decorator="color")):"jira-issue-macro"===this.node.className&&this.$node.attr("data-jira-key")&&(this.decorator="jira-issue-macro")},before:function(){return"attachment-error"===
this.decorator?b.createTextHandler("!"):"underline"===this.decorator?b.createTextHandler("+"):"color"===this.decorator?b.createPreformattedTextHandler("{color:"+this.color+"}"):new d},after:function(){return"attachment-error"===this.decorator?b.createTextHandler("!"):"underline"===this.decorator?b.createTextHandler("+"):"color"===this.decorator?b.createPreformattedTextHandler("{color}"):new d},children:function(){if("attachment-error"===this.decorator){var a=c.getFilenameFromError(this.$node.text());
return[b.createTextHandler(a)]}return"jira-issue-macro"===this.decorator?b.createTextHandler(this.$node.attr("data-jira-key")):this._super()},getStyle:function(a,b){if(b in this.node.style)return this.node.style[b]}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/strikethrough-handler.js' */
define("jira/editor/converter/handlers/strikethrough-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/link-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/factories/whitespace-extractor jquery".split(" "),function(a,b,e,c,f,d){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{-}":"-";d(a.parentNode).is("a[data-issue-key]")&&(this.isIssue=e.isIssue(d(a.parentNode).attr("href")))},
before:function(){return this.isIssue?new c:b.createTextHandler(this.marker)},after:function(){return this.isIssue?new c:b.createTextHandler(this.marker)}});return f(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/superscript-handler.js' */
define("jira/editor/converter/handlers/superscript-handler","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/util/strings jira/editor/converter/factories/whitespace-extractor jquery".split(" "),function(a,b,c,e,f,d){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{^}":"^";d(this.node).parents("a").is(".external-link")&&e.endsWith(d(this.node).children().attr("src"),
"images/icons/mail_small.gif")&&(this.dontExpand=!0)},before:function(){return this.dontExpand?new c:b.createTextHandler(this.marker)},after:function(){return this.dontExpand?new c:b.createTextHandler(this.marker)}});return f(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/subscript-handler.js' */
define("jira/editor/converter/handlers/subscript-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,b,c){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{~}":"~"},before:function(){return b.createTextHandler(this.marker)},after:function(){return b.createTextHandler(this.marker)}});return c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/underline-handler.js' */
define("jira/editor/converter/handlers/underline-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/whitespace-extractor"],function(a,b,c){a=a.extend({init:function(a){this.node=a;this.marker=this.shouldUseAlternativeSyntax()?"{+}":"+"},before:function(){return b.createTextHandler(this.marker)},after:function(){return b.createTextHandler(this.marker)}});return c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/hr-handler.js' */
define("jira/editor/converter/handlers/hr-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/handlers/empty-handler"],function(b,c,a){return b.extend({init:function(a){this.node=a},before:function(){return new a},children:function(){return[new c({textContent:"----",preformatted:!0})]},after:function(){return new a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/cite-handler.js' */
define("jira/editor/converter/handlers/cite-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler"],function(b,a){return b.extend({init:function(a){this.node=a},before:function(){return a.createTextHandler("??")},after:function(){return a.createTextHandler("??")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/external-handler.js' */
define("jira/editor/converter/handlers/external-handler",["jira/editor/converter/handlers/node-handler","jira/editor/converter/handlers/text-handler","jira/editor/converter/new-lines/new-lines","jira/editor/converter","underscore"],function(e,f,c,g,h){var d=e.extend({init:function(a){this.node=a},children:function(){var a=this.external(this.getParams());return[f.createPreformattedTextHandler(a)]},getParams:function(){return Object.create(Object.prototype,{node:{value:this.node},innerMarkup:{get:function(){return g.handleMarkup(this.node.innerHTML)}}})}});
d.forConverter=function(a){var b=AJS.namespace(a["function"]);h.isFunction(b)?e.addHandler(a.selector,d.extend({external:b})):console.error(a["function"]," is not a function, this macro won't be supported by converter: ",a.selector," - it may result in data loss.")};d.Legacy=f.extend({init:function(a){this.node=a},processText:function(){var a=this.node.getAttribute("data-original-text"),b=this.node.getAttribute("data-command");return(a||"")+(this.node.innerText||this.node.textContent)+(b&&"{"+b+"}")},
newLinesBefore:function(){return"true"===this.node.getAttribute("data-new-line-before")?c.single(!0):c.empty()},newLinesAfter:function(){return"true"===this.node.getAttribute("data-new-line-after")?c.single(!0):c.empty()}});return d});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handler-mapper.js' */
define("jira/editor/converter/handler-mapper","jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/text-handler jira/editor/converter/handlers/heading-handler jira/editor/converter/handlers/bold-handler jira/editor/converter/handlers/emphasis-handler jira/editor/converter/handlers/monospaced-handler jira/editor/converter/handlers/linebreak-handler jira/editor/converter/handlers/link-handler jira/editor/converter/handlers/image-handler jira/editor/converter/handlers/code-block-handler jira/editor/converter/handlers/noformat-handler jira/editor/converter/handlers/list-handler jira/editor/converter/handlers/list-item-handler jira/editor/converter/handlers/paragraph-handler jira/editor/converter/handlers/strikethrough-handler jira/editor/converter/handlers/superscript-handler jira/editor/converter/handlers/subscript-handler jira/editor/converter/handlers/underline-handler jira/editor/converter/handlers/quote-handler jira/editor/converter/handlers/panel-handler jira/editor/converter/handlers/span-handler jira/editor/converter/handlers/table-handler jira/editor/converter/handlers/table-row-handler jira/editor/converter/handlers/table-data-handler jira/editor/converter/handlers/hr-handler jira/editor/converter/handlers/cite-handler jira/editor/wrm".split(" "),
function(a,q,b,d,e,c,r,t,u,f,g,h,v,w,x,y,z,k,A,l,B,C,m,n,D,E,F){return{registerHandlers:function(){var p=require("jira/editor/converter/handlers/external-handler");F.getConverters().forEach(p.forConverter);a.addHandler("pre.external-macro",p.Legacy);a.addHandler("H1",b);a.addHandler("H2",b);a.addHandler("H3",b);a.addHandler("H4",b);a.addHandler("H5",b);a.addHandler("H6",b);a.addHandler("A",t);a.addHandler("B",d);a.addHandler("STRONG",d);a.addHandler("BR",r);a.addHandler("EM",e);a.addHandler("I",e);
a.addHandler("IMG",u);a.addHandler("TT",c);a.addHandler("CODE",c);a.addHandler("SAMP",c);a.addHandler("SPAN.monospace",c);a.addHandler("DIV.preformatted panel",g);a.addHandler("PRE.noformat panel",g);a.addHandler("DIV.code panel",f);a.addHandler("PRE.code panel",f);a.addHandler("PANEL-TITLE",a.EmptyHandler);a.addHandler("UL",h);a.addHandler("OL",h);a.addHandler("LI",v);a.addHandler("P",w);a.addHandler("DEL",x);a.addHandler("SUB",z);a.addHandler("SUP",y);a.addHandler("INS",k);a.addHandler("U",k);a.addHandler("TABLE",
C);a.addHandler("TR",m);a.addHandler("CAPTION",m);a.addHandler("TD",n);a.addHandler("TH",n);a.addHandler("SPAN",B);a.addHandler("BLOCKQUOTE",A);a.addHandler("DIV.panel",l);a.addHandler("PRE.panel",l);a.addHandler("HR",D);a.addHandler("CITE",E);a.addHandler("#text",q)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/whitespace-extractor.js' */
define("jira/editor/converter/factories/whitespace-extractor",["jira/editor/constants","jira/editor/converter/handlers/text-handler","jira/editor/converter/factories/left-trim","jira/editor/converter/factories/right-trim"],function(d,c,f,g){function e(b,a){b=(b&&b.textContent||"").match(a);return null!==b?b[0]:null}return function(b){return b.extend({init:function(a){this._super(a);this.leftWhitespaces=e(a.firstChild,d.LEFT_WHITESPACE_MATCHER);this.rightWhitespaces=e(a.lastChild,d.RIGHT_WHITESPACE_MATCHER);
this.leftTrimChildren=!!this.leftWhitespaces;this.rightTrimChildren=!!this.rightWhitespaces},before:function(){var a=this._super();return this._extractLeftSpaces(a)||a},after:function(){var a=this._super();return this._extractRightSpaces(a)||a},createChildHandler:function(a,b,c){a=this._super(a,b,c);this.leftTrimChildren&&0===b&&(a=f(a));this.rightTrimChildren&&c-1===b&&(a=g(a));return a},_extractLeftSpaces:function(a){return this.leftTrimChildren?(a.preformatted?c.createPreformattedTextHandler:c.createTextHandler)(this.leftWhitespaces+
a.processText()):null},_extractRightSpaces:function(a){return this.rightTrimChildren?(a.preformatted?c.createPreformattedTextHandler:c.createTextHandler)(a.processText()+this.rightWhitespaces):null}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/left-trim.js' */
define("jira/editor/converter/factories/left-trim",["jira/editor/constants"],function(c){return function e(f){var a=Object.create(f);a.createChildHandler=function(b,d,c){b=Object.getPrototypeOf(a).createChildHandler.call(this,b,d,c);0===d&&(b=e(b));return b};a.processText=function(){return Object.getPrototypeOf(a).processText.call(this).replace(c.LEFT_WHITESPACE_MATCHER,"")};a._extractLeftSpaces=function(){};return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/factories/right-trim.js' */
define("jira/editor/converter/factories/right-trim",["jira/editor/constants"],function(e){return function f(g){var a=Object.create(g);a.createChildHandler=function(b,c,d){b=Object.getPrototypeOf(a).createChildHandler.call(this,b,c,d);d-1===c&&(b=f(b));return b};a.processText=function(){return Object.getPrototypeOf(a).processText.call(this).replace(e.RIGHT_WHITESPACE_MATCHER,"")};a._extractRightSpaces=function(){};return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/new-lines/new-lines.js' */
define("jira/editor/converter/new-lines/new-lines",["jira/lib/class"],function(b){var a=b.extend({init:function(a,b){this._lines=a;this._optional=b},newLines:function(){return this._lines},optional:function(){return this._optional}});a.empty=function(){return new a(0,!0)};a.single=function(b){return new a(1,!!b)};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/new-lines/new-lines-merger.js' */
define("jira/editor/converter/new-lines/new-lines-merger",["underscore","jira/editor/converter/util/strings","jira/editor/converter/new-lines/new-lines"],function(f,k,g){function h(a){var c=f.max(a.filter(function(b){return b.optional()}).map(function(b){return b.newLines()}));a=a.filter(function(b){return!b.optional()}).reduce(function(b,a){return b+a.newLines()},0);return Math.max(a,c)}return{mergeNewLines:function(a){a=f.filter(a,function(a){return a instanceof g||""!==a});for(var c=[],b=[],d=
0;d<a.length;d++){var e=a[d];e instanceof g?c.push(e):(b.push(k.repeat("\n",h(c))),b.push(e),c=[])}return b},_newLinesNumber:h}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/handlers/bidi-unicode-handler.js' */
define("jira/editor/converter/handlers/bidi-unicode-handler",["jira/editor/converter/handlers/node-handler"],function(a){return a.extend({init:function(a){this.node=a},before:function(){return new a.EmptyHandler},children:function(){return new a.EmptyHandler},processText:function(){const a=parseInt(this.node.dataset.bidiCharacterCode,16);return String.fromCharCode(a)},after:function(){return new a.EmptyHandler}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:converter', location = '/js/converter/html-converter.js' */
define("jira/editor/converter","jquery jira/editor/converter/util/rte-strings jira/editor/converter/handlers/node-handler jira/editor/converter/handlers/empty-handler jira/editor/converter/new-lines/new-lines jira/editor/converter/new-lines/new-lines-merger jira/editor/converter/handler-mapper jira/editor/analytics jira/util/logger exports".split(" "),function(l,f,g,m,n,p,q,d,r,e){q.registerHandlers();var h=function(a){if(null==a)return"";a=[g.createHandler(a)];for(var c=[];0!==a.length;){var b=a.pop();
if(!(b instanceof m))if(b instanceof n)c.push(b);else{a.push(b.newLinesBefore());a.push(b.before());var d=b.children();a=a.concat(d);a.push(b.after());c.push(b.processText());c.push(b.newLinesAfter())}}c=p.mergeNewLines(c);return f.trim(c.reverse().join(""))};e.handleMarkup=function(a){return h(f.parseHtml(a))};e.convert=function(a){var c=new l.Deferred;d.mark("rte-convert");try{var b=f.parseHtml(a),e=b?b.getElementsByTagName("*").length:0,g=h(b);c.resolve(g);d.oneShotMeasure("rte-convert",{nodesCount:e})}catch(k){r.warn(k),
c.reject(k),d.oneShotMeasure("rte-convert",{nodesCount:-1})}return c.promise()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:project-page', location = '/sidebar/navigation/items.js' */
require(["jquery"],function(a){a(document).on("click",'.aui-nav \x3e [aria-expanded] \x3e a.aui-nav-item[href\x3d"#"]',function(b){b.preventDefault();AJS.navigation(a(this).siblings(".aui-nav")).toggle()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'jira.webresources:change-project-type-dialog', location = '/includes/jira/dialog/changeProjectTypeDialog.soy' */
// This file was automatically generated from changeProjectTypeDialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Templates.project.ChangeType.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.project == 'undefined') { JIRA.Templates.project = {}; }
if (typeof JIRA.Templates.project.ChangeType == 'undefined') { JIRA.Templates.project.ChangeType = {}; }


JIRA.Templates.project.ChangeType.changeProjectTypeDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="change-project-type-dialog-' + soy.$$escapeHtml(opt_data.projectId) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" hidden><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Cambiar tipo de proyecto') + '</h2></header><div class="aui-dialog2-content"></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions form-footer"><div class="icon throbber"></div><button class="aui-button aui-button-primary dialog-change-button hidden">' + soy.$$escapeHtml('Cambiar') + '</button><button class="aui-button aui-button-link dialog-close-button">' + soy.$$escapeHtml('Cancelar') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.changeProjectTypeDialog.soyTemplateName = 'JIRA.Templates.project.ChangeType.changeProjectTypeDialog';
}


JIRA.Templates.project.ChangeType.changeProjectTypeForm = function(opt_data, opt_ignored) {
  var output = '<form class="aui change-project-type-form"><div class="form-body"><div class="aui-group project-type-change-group"><div class="aui-item">' + JIRA.Templates.project.ChangeType.projectAvatar(opt_data) + '</div><div class="aui-item project-type-select-group">' + JIRA.Templates.project.ChangeType.projectTypeDropdown({projectTypeKey: opt_data.project.projectTypeKey, projectTypes: opt_data.projectTypes}) + '</div></div></div></form><p>';
  var helpLinkAnchor__soy21 = '<a href=' + soy.$$escapeHtml(opt_data.helpLink) + ' target="_blank">';
  output += soy.$$filterNoAutoescape(AJS.format('Si cambia el tipo de proyecto, tambi\xe9n cambiar\xe1 lo que los usuarios pueden ver y hacer con el proyecto. {0}Vea las diferencias aqu\xed{1}',helpLinkAnchor__soy21,'</a>')) + '</p>';
  return output;
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.changeProjectTypeForm.soyTemplateName = 'JIRA.Templates.project.ChangeType.changeProjectTypeForm';
}


JIRA.Templates.project.ChangeType.projectTypeDropdown = function(opt_data, opt_ignored) {
  var output = '<select class="project-type-select select" name="project-type">';
  var projectTypeList30 = opt_data.projectTypes;
  var projectTypeListLen30 = projectTypeList30.length;
  for (var projectTypeIndex30 = 0; projectTypeIndex30 < projectTypeListLen30; projectTypeIndex30++) {
    var projectTypeData30 = projectTypeList30[projectTypeIndex30];
    output += '<option class="imagebacked" data-icon="data:image/svg+xml;base64, ' + soy.$$escapeHtml(projectTypeData30.icon) + '" value="' + soy.$$escapeHtml(projectTypeData30.key) + '" ' + ((projectTypeData30.key == opt_data.projectTypeKey) ? ' selected ' : '') + '>' + soy.$$escapeHtml(projectTypeData30.formattedKey) + '</option>';
  }
  output += '</select>';
  return output;
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.projectTypeDropdown.soyTemplateName = 'JIRA.Templates.project.ChangeType.projectTypeDropdown';
}


JIRA.Templates.project.ChangeType.updateTargetElement = function(opt_data, opt_ignored) {
  return '<img src="data:image/svg+xml;base64,' + soy.$$escapeHtml(opt_data.icon) + '" class="project-type-icon" /><span>' + soy.$$escapeHtml(opt_data.formattedKey) + '</span>';
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.updateTargetElement.soyTemplateName = 'JIRA.Templates.project.ChangeType.updateTargetElement';
}


JIRA.Templates.project.ChangeType.projectAvatar = function(opt_data, opt_ignored) {
  return '<div class="project-avatar-header"><span class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(opt_data.project.avatarUrls['48x48']) + '" alt="' + soy.$$escapeHtml(opt_data.project.name) + '"></span></span><div class="project-header" title="' + soy.$$escapeHtml(opt_data.project.name) + '">' + soy.$$escapeHtml(opt_data.project.name) + '</div></div>';
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.projectAvatar.soyTemplateName = 'JIRA.Templates.project.ChangeType.projectAvatar';
}


JIRA.Templates.project.ChangeType.dialogSpinner = function(opt_data, opt_ignored) {
  return '<div class="dialog-spinner"></div>';
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.dialogSpinner.soyTemplateName = 'JIRA.Templates.project.ChangeType.dialogSpinner';
}


JIRA.Templates.project.ChangeType.successMsg = function(opt_data, opt_ignored) {
  return '' + soy.$$escapeHtml(AJS.format('Acaba de cambiar {0} a un tipo de proyecto {1}.',opt_data.projectName,opt_data.projectTypeName));
};
if (goog.DEBUG) {
  JIRA.Templates.project.ChangeType.successMsg.soyTemplateName = 'JIRA.Templates.project.ChangeType.successMsg';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'jira.webresources:change-project-type-dialog', location = '/includes/jira/dialog/changeProjectTypeDialog.js' */
define("jira/project/admin/change-project-type-dialog",["jira/util/formatter","jquery","underscore","jira/analytics","jira/message","jira/ajs/select/single-select","wrm/context-path"],function(e,t,o,n,a,r,c){"use strict";function p(e){return t.ajax({url:c()+"/rest/internal/2/projects/"+e+"/changetypedata",dataType:"json",contentType:"application/json",type:"GET"})}function i(r){var p=t(".project-type-select",r.dialogBody),i=p.val()[0],s=o.findWhere(r.projectTypes,{key:i});t(".dialog-change-button",r.dialogBody).attr("disabled","disabled"),t(t.ajax({url:c()+"/rest/api/2/project/"+r.projectId+"/type/"+i,dataType:"json",contentType:"application/json",type:"PUT"}).done(function(){r.changeProjectTypeDialog.hide(),r.onProjectTypeChanged&&r.onProjectTypeChanged(r.trigger,s),a.showSuccessMsg(JIRA.Templates.project.ChangeType.successMsg({projectName:r.projectName,projectTypeName:s.formattedKey})),n.send({name:"administration.projecttype.change",properties:{projectId:r.projectId,sourceProjectType:d(r.sourceProjectType),destinationProjectType:d(i)}})}).fail(function(){t(".aui-dialog2-content",r.dialogBody).prepend(aui.message.error({content:e.format("No hemos podido terminar la conversi\u00f3n del proyecto. Puede actualizar la p\u00e1gina y volver a intentarlo. Si esto no funciona, comun\u00edquese con la {0}asistencia{1}.",'<a href="https://support.atlassian.com/">',"</a>")}))})).throbber({target:t(".throbber",r.dialogBody)})}function d(e){return e&&e.replace("_","")}function s(e,t,o){e==t?o.find(".dialog-change-button").attr("disabled","disabled"):o.find(".dialog-change-button").removeAttr("disabled")}function l(o){var n=t(JIRA.Templates.project.ChangeType.changeProjectTypeDialog({projectId:o.projectId})),a=AJS.dialog2(n);a.on("show",function(){t(".aui-dialog2-content",n).html(JIRA.Templates.project.ChangeType.dialogSpinner()),t(".dialog-spinner",n).spin(),t(".dialog-change-button",n).unbind("click").addClass("hidden")}),t(o.trigger).click(function(c){c.preventDefault(),a.show(),p(o.projectId).done(function(e){n.find(".aui-dialog2-content").html(JIRA.Templates.project.ChangeType.changeProjectTypeForm(e)),new r({element:t(".project-type-select",n),revertOnInvalid:!0,width:165}),n.find(".dialog-change-button").removeClass("hidden"),s(t(".project-type-select",n).val(),e.project.projectTypeKey,n);var c={dialogBody:n,changeProjectTypeDialog:a,projectName:e.project.name,projectTypes:e.projectTypes,trigger:o.trigger,projectId:o.projectId,onProjectTypeChanged:o.onProjectTypeChanged,sourceProjectType:e.project.projectTypeKey};t(".dialog-change-button",n).click(function(e){e.preventDefault(),i(c)}),t(".change-project-type-form",n).on("submit",function(e){e.preventDefault(),i(c)}),t(".project-type-select",n).on("change",function(){s(t(this).val(),e.project.projectTypeKey,n)})}).fail(function(){t(".aui-dialog2-content",n).html(aui.message.error({content:e.format("No pudimos cargar los datos necesarios para cambiar el tipo de proyecto. Puede actualizar la p\u00e1gina y volver a intentarlo. Si esto no funciona, comun\u00edquese con la {0}asistencia{1}.",'<a href="https://support.atlassian.com/">',"</a>")}))})}),t(".dialog-close-button",n).click(function(e){e.preventDefault(),a.hide()})}return function(e){l(e)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'jira.webresources:project-type-warning', location = '/static/projecttypes/warning/dialog/project-type-warning-dialog.js' */
define("jira/project/types/warning/dialog",["require"],function(e){"use strict";function t(t,a,r){var o=n(".project-type-warning-icon",r);i(o,"uninstalled-warning-dialog",function(i,r,o){return i.html(JIRA.Project.Types.Warning.dialog({title:t.title,firstParagraph:t.firstParagraph,secondParagraph:t.secondParagraph,callToActionText:t.callToActionText})),e("jira/project/admin/change-project-type-dialog")({trigger:n(".warning-dialog-change-project-type"),projectId:t.projectId,onProjectTypeChanged:a}),o(),!1},{width:375,gravity:"w"})}var n=e("jquery"),a=e("wrm/data"),i=e("aui/inline-dialog"),r=a.claim("project.type.warning.dialogs.data");return{init:function(e){e=e||{},e.sectionElement=e.sectionElement||n("body"),t(r,e.onProjectTypeChanged,e.sectionElement)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'jira.webresources:project-type-warning', location = '/static/projecttypes/warning/dialog/templates/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Project.Types.Warning.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Project == 'undefined') { JIRA.Project = {}; }
if (typeof JIRA.Project.Types == 'undefined') { JIRA.Project.Types = {}; }
if (typeof JIRA.Project.Types.Warning == 'undefined') { JIRA.Project.Types.Warning = {}; }


JIRA.Project.Types.Warning.dialog = function(opt_data, opt_ignored) {
  return '<div class="project-type-warning-dialog"><p class="header"><span>' + soy.$$escapeHtml(opt_data.title) + '</span></p><p class="type-not-accessible-message">' + soy.$$escapeHtml(opt_data.firstParagraph) + '</p><p class="available-functionality-message">' + soy.$$escapeHtml(opt_data.secondParagraph) + '</p><div class="actions"><a class="warning-dialog-change-project-type" href="#">' + soy.$$escapeHtml(opt_data.callToActionText) + '</a></div></div>';
};
if (goog.DEBUG) {
  JIRA.Project.Types.Warning.dialog.soyTemplateName = 'JIRA.Project.Types.Warning.dialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/navigation-item.js' */
define("jira/projects/sidebar/component/navigation-item",["jira/util/browser","jira/projects/libs/marionette"],function(b,c){return c.CompositeView.extend({ui:{link:"a.aui-nav-item"},events:{'simpleClick @ui.link:not([target\x3d"_blank"])':function(a){a.preventDefault();this.navigate()}},initialize:function(){this.id=this.$el.find("\x3ea").attr("data-link-id");this.bindUIElements()},onDestroy:function(){this.unbind()},getElement:function(){return this.el},navigate:function(){if(this.select()){if(this.triggerPreventable("before:navigate").isPrevented)return!1;
var a=this.ui.link.attr("href");a&&b.reloadViaWindowLocation(a);return!0}},select:function(){var a=this.triggerPreventable("before:select");if(a.isPrevented)return!1;this.$el.addClass("aui-nav-selected");this.trigger("select",a);return!0},deselect:function(){if(!this.isSelected())return!0;var a=this.triggerPreventable("before:deselect");if(a.isPrevented)return!1;this.$el.removeClass("aui-nav-selected");this.$el.find("a").blur();this.trigger("deselect",a);return!0},isSelected:function(){return this.$el.hasClass("aui-nav-selected")},
removeBadge:function(){this.$el.find(".aui-badge").remove()},getId:function(){return this.id},getSelectedNavigationItem:function(){if(this.isSelected())return this},hasASelectedItem:function(){return this.isSelected()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/navigation-group.js' */
define("jira/projects/sidebar/component/navigation-group",["jira/projects/sidebar/component/navigation-group-factory","jira/projects/libs/marionette","jira/util/logger"],function(c,d,e){return d.CompositeView.extend({childEvents:{"before:select":function(a,b){this.retriggerPreventable("before:select",b);b.isPrevented||this.deselect()||b.preventDefault()},select:function(a,b){this.trigger("select",b)},"before:deselect":function(a,b){this.retriggerPreventable("before:deselect",b)},deselect:function(a,
b){this.trigger("deselect",b)},"before:navigate":function(a,b){this.retriggerPreventable("before:navigate",b)},"before:navigate:prevented":function(a,b){this.trigger("before:navigate:prevented",b)}},initialize:function(){this.id=this.$el.attr("data-id");this.$("\x3eul\x3eli").each(function(a,b){a=c.build(b);this.getItem(a.id)&&e.warn("Duplicated IDs detected. There are more than one NavigationItem with id data-link-id\x3d'"+a.id+"'");this.proxyChildEvents(a);this.children.add(a,a.id)}.bind(this))},
onDestroy:function(){this.unbind()},getElement:function(){return this.el},deselect:function(){if(this.triggerPreventable("before:deselect").isPrevented)return!1;var a=!0;this.children.each(function(b){a=b.deselect()&&a});return a},getItem:function(a){return this.children.findByCustom(a)},getItemAt:function(a){return this.children.findByIndex(a)},getSelectedNavigationItem:function(){var a=this.children.find(function(a){return a.hasASelectedItem()});if(a)return a.getSelectedNavigationItem()},hasASelectedItem:function(){return this.children.any(function(a){return a.hasASelectedItem()})}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/navigation-subgroup.js' */
define("jira/projects/sidebar/component/navigation-subgroup",["jira/projects/sidebar/component/navigation-group","underscore"],function(b,c){return b.extend({childEvents:{"before:select":function(a,d){b.prototype.childEvents["before:select"].apply(this,arguments);d.isPrevented||this.expand()}},initialize:function(){this.childEvents=c.extend({},b.prototype.childEvents,this.childEvents);b.prototype.initialize.apply(this,arguments);this.id=this.$el.find("\x3ea[data-link-id]").attr("data-link-id")},expand:function(){this.$el.attr("aria-expanded",
"true")},collapse:function(){this.$el.attr("aria-expanded","false")},isExpanded:function(){return"true"===this.$el.attr("aria-expanded")},isSelected:function(){return this.$el.hasClass("aui-nav-selected")},getId:function(){return this.id},getSelectedNavigationItem:function(){if(this.isSelected())return this;var a=this.children.find(function(a){return a.hasASelectedItem()});if(a)return a.getSelectedNavigationItem()},hasASelectedItem:function(){return this.isSelected()?!0:this.children.any(function(a){return a.hasASelectedItem()})}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/navigation-group-factory.js' */
define("jira/projects/sidebar/component/navigation-group-factory",["exports","jira/projects/sidebar/component/navigation-item","jira/projects/sidebar/component/navigation-subgroup","jquery"],function(b,c,d,e){b.build=function(a){return e(a).find("ul").length?new d({el:a}):new c({el:a})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/component.js' */
define("jira/projects/sidebar/component","jira/projects/sidebar/component/navigation-group jira/projects/libs/marionette jira/util/logger wrm/data jquery underscore".split(" "),function(e,f,g,h,k,d){var l=!!h.claim("is-global-sidebar");return f.CompositeView.extend({childEvents:{"before:select":function(a,b){this.hasASelectedItem()||(b.isInitial=!0);this.retriggerPreventable("before:select",b);b.isPrevented||this.deselectAllGroups()},select:function(a,b){this.trigger("select",b)},"before:deselect":function(a,
b){this.retriggerPreventable("before:deselect",b)},deselect:function(a,b){this.trigger("deselect",b)},"before:navigate":function(a,b){this.retriggerPreventable("before:navigate",b)},"before:navigate:prevented":function(a,b){this.trigger("before:navigate:prevented",b)}},initialize:function(){this.render({force:!0})},render:function(a){a=d.defaults({},a,{force:!1});var b="el"in a,c=0<this.children.length;if(!b&&!0!==a.force||this.triggerPreventable("before:render").isPrevented)return this;if(c){if(this.triggerPreventable("before:detach").isPrevented)return this;
this.destroyChildren({checkEmpty:!1});this.trigger("detach")}b&&(a=k(a.el),this.$el.replaceWith(a),this.setElement(a));this.$(".aui-sidebar-group").each(d.bind(function(a,b){a=new e({el:b});this.getGroup(a.id)&&g.warn('Duplicated IDs detected. There are more than one NavigationGroup with id data-id\x3d"'+a.id+'"');this.proxyChildEvents(a);this.children.add(a,a.id)},this));this.trigger("render");return this},deselectAllGroups:function(){this.children.call("deselect")},replaceGroup:function(a,b){a=
this.getGroup(a);a.$el.replaceWith(b.$el);b.cid=a.cid;this.children.remove(a);this.children.add(b,b.id)},getGroup:function(a){return this.children.findByCustom(a)},getGroupAt:function(a){return this.children.findByIndex(a)},getItem:function(a){return this.getDefaultGroup().getItem(a)},getElement:function(){return this.el},getDefaultGroup:function(){return this.getGroup("sidebar-navigation-panel")},isProjectSidebar:function(){return!l},getSelectedScopeFilterId:function(){return this.$(".scope-filter a.scope-filter-trigger").attr("data-scope-filter-id")},
setReportsItemLink:function(a){var b=this.getGroup("sidebar-navigation-panel"),c=b.getItem("com.atlassian.jira.jira-projects-plugin:report-page");"undefined"===typeof c&&(c=b.getItem("com.pyxis.greenhopper.jira:global-sidebar-report"));c&&c.ui.link.attr("href",a)},getAUISidebar:function(){return AJS.sidebar(".aui-sidebar")},getContentContainer:function(){return this.$(".aui-sidebar-body .sidebar-content-container")},getSelectedNavigationItem:function(){return this.getDefaultGroup().getSelectedNavigationItem()},
hasASelectedItem:function(){return this.getDefaultGroup().hasASelectedItem()},dim:function(){this.$el.attr({dimmed:"","aria-hidden":"true"})},undim:function(){this.$el.removeAttr("dimmed");this.$el.removeAttr("aria-hidden")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-component', location = '/sidebar/component/component-namespaces.js' */
(function(){var a=require("jira/projects/sidebar/component/navigation-group-factory"),b=require("jira/projects/sidebar/component");AJS.namespace("JIRA.Projects.Sidebar.Component",null,b);AJS.namespace("JIRA.Projects.Sidebar.Component.NavigationItem",null,require("jira/projects/sidebar/component/navigation-item"));AJS.namespace("JIRA.Projects.Sidebar.Component.NavigationSubgroup",null,require("jira/projects/sidebar/component/navigation-subgroup"));AJS.namespace("JIRA.Projects.Sidebar.Component.NavigationGroup",
null,require("jira/projects/sidebar/component/navigation-group"));AJS.namespace("JIRA.Projects.Sidebar.Component.NavigationGroup.build",null,a.build)})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-analytics', location = '/sidebar/analytics/hash.js' */
define("jira/projects/sidebar/analytics/hash",["underscore"],function(e){function g(a,b){return 0===a.indexOf(b)}var d=[];return{prefixedHash:function(a){var b=e.find(d,e.partial(g,a))||"";a=a.substring(g(a,b)?b.length:0);var c=0;if(a){for(var f=0;f<a.length;f+=1){var h=a.charCodeAt(f);c=32*c-c+h;c|=0}a=c}else a="";return{prefix:b,hash:b+a}},addPrefix:function(a){a&&!e.contains(d,a)&&d.push(a)},clearPrefixes:function(){d.length=0}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-analytics', location = '/sidebar/analytics/analytics.js' */
define("jira/projects/sidebar/analytics/analytics",["jira/api/projects/sidebar","jira/projects/sidebar/analytics/hash","jira/util/data/meta","jira/analytics","jquery"],function(g,h,k,l,d){function e(a,c){l.send({name:"jira.project.centric.navigation.sidebar."+a,data:c})}function m(a){a=a.getAUISidebar();var c=d();c=c.add(a.$el);c=c.add(a.submenus.inlineDialog);c.on("click","a",function(){var b=d(this).attr("data-link-id");b=h.prefixedHash(b||"NONE");b={id:b.hash,prefix:b.prefix};var a=k.get("sidebar-source-page");
a?b.sidebarSourcePage=a:0<d(".issue-tools button.expand").length?b.sidebarSourcePage="search-el":0<d(".navigation-tools button.collapse").length?b.sidebarSourcePage="fullscreen-el":"atl.jira.proj.config"===d('meta[name\x3d"admin.active.section"]').attr("content")&&(a=d('meta[name\x3d"admin.active.tab"]').attr("content"),a=a.replace("com.atlassian.servicedesk.project-ui:",""),-1!==f.indexOf(["proj.config",a].join("."))?b.sidebarSourcePage=["proj.config",a].join("."):b.sidebarSourcePage="proj.config");
-1===f.indexOf(b.sidebarSourcePage)&&(b.sidebarSourcePage="unknown");e("click.link",b)})}var f="search-el fullscreen-el search fullscreen rapid-board service-desk proj.config proj.config.view_project_summary proj.config.view_project_issuetypes proj.config.project-issuetypes-expand proj.config.view_project_workflows proj.config.view_project_screens proj.config.view_project_fields proj.config.view_project_versions proj.config.view_project_components proj.config.view_project_roles proj.config.view_project_permissions proj.config.view_project_issuesecurity proj.config.view_project_notifications proj.config.devstatus-admin-page-link proj.config.hipchat-project-admin-page-link proj.config.view_issue_collectors proj.config.sd-project-request-types-item proj.config.sd-project-request-security-item proj.config.sd-project-portal-settings-item proj.config.sd-project-feedback-settings-item proj.config.sd-project-email-settings-item proj.config.sd-project-confluence-kb-item proj.config.sd-project-sidebar-sla proj.config.sd-project-automation-item".split(" ");
return{register:function(){g.getSidebar().done(function(a){a.isProjectSidebar()?e("load.project"):e("load.global");m(a)})}}});AJS.namespace("JIRA.Projects.Sidebar.Analytics",null,require("jira/projects/sidebar/analytics/analytics"));AJS.namespace("JIRA.Projects.Sidebar.Analytics.Hash",null,require("jira/projects/sidebar/analytics/hash"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Projects.Sidebar.ScopeFilter.Templates.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Projects == 'undefined') { JIRA.Projects = {}; }
if (typeof JIRA.Projects.Sidebar == 'undefined') { JIRA.Projects.Sidebar = {}; }
if (typeof JIRA.Projects.Sidebar.ScopeFilter == 'undefined') { JIRA.Projects.Sidebar.ScopeFilter = {}; }
if (typeof JIRA.Projects.Sidebar.ScopeFilter.Templates == 'undefined') { JIRA.Projects.Sidebar.ScopeFilter.Templates = {}; }


JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedContainer = function(opt_data, opt_ignored) {
  return '<div class="aui-sidebar-group aui-sidebar-group-actions collapsed-scope-filter-container"><!-- AUI sidebar does a if (!hasSubmenu) check while initializing submenu hence we need aui-nav element even if it is empty, so that our sidebar group gets properly initialized --><ul class="aui-nav"><!-- On first hover, while we are waiting for data, this content will be displayed in submenu inline dialog. Once we have data we will replace this with the actual data in DOM. Any further hover will clone the new DOM structure (actual data without progress indicator) and display in the submenu dialog. This is the only way I could find to pass a progress indicator to submenu inside dialog, because AUI does a destructive `submenuInlineDialog.innerHTML=` AFTER `sidebarSubmenuBeforeShow` event handler is executed, hence losing anything injected from it--><li><aui-spinner size="small" style="margin: auto"/></li></ul></div>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedContainer.soyTemplateName = 'JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedContainer';
}


JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedScopeList = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.selectableScopes || opt_data.createActions) {
    output += '<div class="aui-nav-heading" title="' + soy.$$escapeHtml('Pizarras en este proyecto') + '"><strong class="collapsed-scope-header">' + soy.$$escapeHtml('Pizarras en este proyecto') + '</strong></div><ul class="aui-nav collapsed-scope-list" title="' + soy.$$escapeHtml('Seleccionar un tablero') + '">';
    if (opt_data.selectedScope) {
      output += '<li class="scope-filter selected-scope-filter" title="' + soy.$$escapeHtml(opt_data.selectedScope.label) + '">' + soy.$$escapeHtml(opt_data.selectedScope.label) + '</li>';
      var scopeFilterList21 = opt_data.selectableScopes;
      var scopeFilterListLen21 = scopeFilterList21.length;
      for (var scopeFilterIndex21 = 0; scopeFilterIndex21 < scopeFilterListLen21; scopeFilterIndex21++) {
        var scopeFilterData21 = scopeFilterList21[scopeFilterIndex21];
        output += JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedSelectableItem({itemClass: 'scope-filter', anchorClass: scopeFilterData21.styleClass, label: scopeFilterData21.label, link: scopeFilterData21.link});
      }
    }
    if (opt_data.createActions && opt_data.createActions[0]) {
      output += '<hr/>';
      var createActionList31 = opt_data.createActions;
      var createActionListLen31 = createActionList31.length;
      for (var createActionIndex31 = 0; createActionIndex31 < createActionListLen31; createActionIndex31++) {
        var createActionData31 = createActionList31[createActionIndex31];
        output += JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedSelectableItem({itemClass: 'create-scope-action', anchorClass: createActionData31.styleClass, label: createActionData31.label, link: createActionData31.link});
      }
    }
    output += '</ul>';
  }
  return output;
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedScopeList.soyTemplateName = 'JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedScopeList';
}


JIRA.Projects.Sidebar.ScopeFilter.Templates.scopeListError = function(opt_data, opt_ignored) {
  return '<div class="scope-filter-error-message-container"><div class="scope-filter-error-message">' + soy.$$escapeHtml('Tenemos problemas para recuperar la lista de tableros') + '</div><div class="aui-button aui-button-compact">' + soy.$$escapeHtml('Volver a intentar') + '</div></div>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ScopeFilter.Templates.scopeListError.soyTemplateName = 'JIRA.Projects.Sidebar.ScopeFilter.Templates.scopeListError';
}


JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedSelectableItem = function(opt_data, opt_ignored) {
  return '<li class="' + soy.$$escapeHtml(opt_data.itemClass) + '"><a href="' + soy.$$escapeHtml(opt_data.link) + '" title="' + soy.$$escapeHtml(opt_data.label) + '"' + ((opt_data.anchorClass) ? ' class="' + soy.$$escapeHtml(opt_data.anchorClass) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.label) + '</a></li>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedSelectableItem.soyTemplateName = 'JIRA.Projects.Sidebar.ScopeFilter.Templates.collapsedSelectableItem';
}


JIRA.Projects.Sidebar.ScopeFilter.Templates.renderScopefilterItems = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.scopeFilterItems.length > 0) {
    output += '<div class="aui-dropdown2-section"><strong>' + soy.$$escapeHtml('Pizarras en este proyecto') + '</strong><ul class="aui-list-truncate">';
    var itemList67 = opt_data.scopeFilterItems;
    var itemListLen67 = itemList67.length;
    for (var itemIndex67 = 0; itemIndex67 < itemListLen67; itemIndex67++) {
      var itemData67 = itemList67[itemIndex67];
      output += '<li><a href="' + soy.$$escapeHtml(itemData67.link) + '" title="' + soy.$$escapeHtml(itemData67.label) + '" data-scope-filter-id="' + soy.$$escapeHtml(itemData67.id) + '">' + soy.$$escapeHtml(itemData67.label) + '</a></li>';
    }
    output += '</ul></div>';
  } else if (! opt_data.canCreateScope) {
    output += '<div class="aui-dropdown2-section"><strong>' + soy.$$escapeHtml('Pizarras en este proyecto') + '</strong><div class="empty-boards-list">' + soy.$$escapeHtml('No hay tableros para mostrar') + '</div></div>';
  }
  return output;
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ScopeFilter.Templates.renderScopefilterItems.soyTemplateName = 'JIRA.Projects.Sidebar.ScopeFilter.Templates.renderScopefilterItems';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/templates.js' */
define("jira/projects/sidebar/scopefilter/templates",function(){return JIRA.Projects.Sidebar.ScopeFilter.Templates});AJS.namespace("JIRA.Projects.Sidebar.ScopeFilter.Templates",null,require("jira/projects/sidebar/scopefilter/templates"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/model.js' */
define("jira/projects/sidebar/scopefilter/model",["underscore","jira/api/projects"],function(c,d){var b=function(a){this.selectedScope=null;this.createScopeActions=[];this.selectableScopes=[];this.setData(a)};b.prototype.setData=function(a){a&&(a.selectedScope&&(this.selectedScope=a.selectedScope),a.createScopeActions.length&&(this.createScopeActions=a.createScopeActions),a.scopes.length&&(this.selectableScopes=a.selectedScope?c.reject(a.scopes,function(a){return a.label===this.selectedScope.label&&
a.link===this.selectedScope.link},this):a.scopes))};b.prototype.getSelectedScope=function(){return this.selectedScope};b.prototype.getSelectableScopes=function(){return this.selectableScopes};b.prototype.getCreateScopeActions=function(){return this.createScopeActions};b.prototype.shouldDisplayWhenSidebarIsCollapsed=function(){const a=d.getCurrentProjectType();return"service_desk"!==a&&"business"!==a};return b});AJS.namespace("JIRA.Projects.Sidebar.ScopeFilter.Model",null,require("jira/projects/sidebar/scopefilter/model"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/scopeFilterDropdownView.js' */
define("jira/projects/sidebar/scopefilter/scopefilter-view",["jquery","jira/projects/libs/marionette","jira/projects/sidebar/scopefilter/templates"],function(c,d,b){return d.ItemView.extend({template:b.renderScopefilterItems,events:{"aui-dropdown2-show":"show"},initialize:function(a){this.controller=a.controller;this.rendered=!1},show:function(){if(!this.rendered){var a=c('\x3caui-spinner size\x3d"small"/\x3e').css("margin","auto");this.$el.prepend(a);this.$el.addClass("data-load-in-progress");this.controller.fetchScopeFilterList().then(this.onFetchSuccess.bind(this)).fail(this.onFetchFail.bind(this)).always(function(){this.$el.addClass("data-load-finished").removeClass("data-load-in-progress");
a.remove()}.bind(this))}},onFetchSuccess:function(){this.$el.addClass("data-load-success");var a=this.model.getSelectableScopes(),b=!!this.model.getCreateScopeActions().length;a&&(a=this.template({scopeFilterItems:a,canCreateScope:b}),this.$el.prepend(a),this.rendered=!0)},onFetchFail:function(){this.$el.addClass("data-load-fail");var a=b.scopeListError();this.$el.prepend(a);this.rendered=!0;this.$el.find(".scope-filter-error-message-container .aui-button").on("click",this.onRetryClick.bind(this))},
onRetryClick:function(a){a.stopPropagation();a=this.$el.find(".scope-filter-error-message-container");a.length&&a.remove();this.rendered=!1;return this.show()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/collapsed-view.js' */
define("jira/projects/sidebar/scopefilter/collapsed-view",["jquery","jira/projects/libs/marionette","jira/projects/sidebar/scopefilter/templates"],function(d,e,c){return e.ItemView.extend({template:c.collapsedContainer,ui:{trigger:".aui-sidebar-group-actions"},events:{"aui-sidebar-submenu-before-show @ui.trigger":"show"},initialize:function(a){this.controller=a.controller;this.rendered=!1},serializeData:function(){return{selectedScope:this.model.getSelectedScope(),selectableScopes:this.model.getSelectableScopes(),
createActions:this.model.getCreateScopeActions()}},show:function(a,b){this.rendered||(this.$el.addClass("data-load-in-progress"),this.controller.fetchScopeFilterList().then(this.onFetchSuccess.bind(this,b)).fail(this.onFetchFail.bind(this,b)).always(function(){this.$el.addClass("data-load-finished").removeClass("data-load-in-progress")}.bind(this)))},onFetchSuccess:function(a){this.$el.addClass("data-load-success");var b=c.collapsedScopeList(this.serializeData());this.renderPreparedTemplate(a,b);
this.rendered=!0},onFetchFail:function(a){this.$el.addClass("data-load-fail");var b=c.scopeListError();this.renderPreparedTemplate(a,b);d(a).find(".scope-filter-error-message-container .aui-button").click(this.onRetryClick.bind(this,a))},renderPreparedTemplate:function(a,b){this.ui.trigger.html(b);d(a).find(".aui-navgroup-inner").html(b)},onRetryClick:function(a){return this.show(null,a)}})});AJS.namespace("JIRA.Projects.Sidebar.ScopeFilter.CollapsedView",null,require("jira/projects/sidebar/scopefilter/collapsed-view"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/scopeFilterController.js' */
define("jira/projects/sidebar/scopefilter/controller","jquery wrm/data jira/api/projects wrm/context-path jira/util/logger jira/projects/libs/marionette jira/projects/sidebar/scopefilter/model jira/projects/sidebar/scopefilter/scopefilter-view jira/projects/sidebar/scopefilter/collapsed-view".split(" "),function(b,c,d,e,f,g,h,k,l){return g.Controller.extend({initialize:function(a){this.sidebarAPI=a.sidebarAPI;this.sidebar=this.sidebarAPI.getAUISidebar();this.$sidebarContentContainer=this.sidebarAPI.getContentContainer();
this.sidebarAPI.isProjectSidebar()&&(a=c.claim("scope-filter-data"),this.scopeFilterModel=new h(a),this.dataFetched=!1,this.shouldRenderScopeFilterView=!this.scopeFilterModel.getSelectableScopes().length,this.sidebar.isCollapsed()?this.createCollapsedScopeFilterView():this.createScopeFilterView(),this.listenToSidebarEvents())},createCollapsedScopeFilterView:function(){this.scopeFilterModel.shouldDisplayWhenSidebarIsCollapsed()&&(this.collapsedView=new l({model:this.scopeFilterModel,controller:this}),
this.collapsedView.render(),this.$sidebarContentContainer.prepend(this.collapsedView.el),f.trace("sidebar.scopefilter.collapsed"))},createScopeFilterView:function(){this.shouldRenderScopeFilterView&&(this.scopeFilterDropdownView=new k({el:"#sidebar-scope-filter-list",model:this.scopeFilterModel,controller:this}))},fetchScopeFilterList:function(){var a=b.Deferred();if(this.dataFetched||this.scopeFilterModel.getSelectableScopes().length)return a.resolve();a=e()+"/rest/projects/1.0/project/"+d.getCurrentProjectKey()+
"/rapidviews";return b.ajax({contentType:"application/json",type:"GET",url:a}).done(function(a){this.dataFetched=!0;this.scopeFilterModel.setData(a)}.bind(this))},listenToSidebarEvents:function(){this.sidebar.on("collapse-start",function(){this.collapsedView||this.createCollapsedScopeFilterView()}.bind(this));this.sidebar.on("expand-end",function(){this.collapsedView&&(this.collapsedView.destroy(),this.collapsedView=null);this.scopeFilterDropdownView||this.createScopeFilterView()}.bind(this))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:scope-filter', location = '/sidebar/scopefilter/scopeFilter-init.js' */
require(["jira/api/projects/sidebar","jira/projects/sidebar/scopefilter/controller"],function(a,b){a.getSidebar().done(function(a){new b({sidebarAPI:a})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:feature-discovery', location = '/sidebar/feature-discovery/feature-discovery.js' */
define("jira/projects/sidebar/feature-discovery",["jira/api/projects","jira/api/projects/sidebar","wrm/context-path","underscore","jquery"],function(c,d,e,f,g){function h(b,a){f.each(a,function(a){(a=b.getItem(a))&&a.removeBadge()})}function k(b){d.getSidebar().done(function(a){h(a,b)})}return{updateBadges:function(){"undefined"!==typeof c.getCurrentProjectKey()&&g.ajax({url:e()+"/rest/projects/1.0/project/"+encodeURIComponent(c.getCurrentProjectKey())+"/badges",type:"PUT",contentType:"application/json"}).done(function(b){k(b.badgesToRemove||
[])})}}});AJS.namespace("JIRA.Projects.Sidebar.FeatureDiscovery",null,require("jira/projects/sidebar/feature-discovery"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-last-visited', location = '/sidebar/lastvisited/last-visited-updater.js' */
define("jira/projects/sidebar/lastvisited/updater",["jira/api/projects","jira/util/logger","wrm/context-path","jquery"],function(f,g,h,k){function d(a,c,b){a&&(b=b||function(){g.trace("last.visited.item.saved")},k.ajax({url:h()+"/rest/projects/1.0/project/"+encodeURIComponent(a)+"/lastVisited",type:"PUT",contentType:"application/json",data:JSON.stringify({id:c})}).done(b))}return{start:function(a,c){var b=f.getCurrentProjectKey(),e=a.getSelectedNavigationItem();e&&d(b,e.getId(),c);a.on("before:navigate:prevented",
function(a){d(b,a.emitter.id,c)});a.on("before:select",function(a){a.isInitial&&d(b,a.emitter.id,c)})}}});AJS.namespace("JIRA.Projects.Sidebar.LastVisited.Updater",null,require("jira/projects/sidebar/lastvisited/updater"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar', location = '/sidebar/sidebar-init.js' */
define("jira/projects/sidebar/sidebar-initializer",["require"],function(a){function e(a){a.id="sidebar"}function f(a){a.setAttribute("aria-label","Barra lateral")}var h=a("jira/util/logger"),k=a("jira/api/projects"),g=a("jira/api/projects/sidebar"),l=a("jira/project/types/warning/dialog"),m=a("jira/projects/sidebar/lastvisited/updater"),n=a("jira/projects/sidebar/component"),p=a("jira/projects/sidebar/analytics/analytics"),q=a("jira/projects/sidebar/analytics/hash"),r=a("wrm/context-path"),
d=a("jquery"),t=a("underscore"),c=a("jira/util/formatter"),u="NONE com.atlassian.jira.jira-projects-plugin:project-issue-search-link com.atlassian.jira.jira-projects-plugin:components-page com.atlassian.jira.jira-projects-plugin:reports-panel com.atlassian.jira.jira-projects-plugin:summary-panel com.atlassian.jira.jira-projects-plugin:summary-page com.atlassian.jira.jira-projects-plugin:components-page com.atlassian.jira.jira-projects-plugin:release-page com.atlassian.jira.jira-projects-plugin:release-sidebar-version- com.atlassian.jira.jira-projects-plugin:report-page com.pyxis.greenhopper.jira:global-sidebar-report com.pyxis.greenhopper.jira:global-sidebar-plan-scrum com.pyxis.greenhopper.jira:global-sidebar-work-scrum com.pyxis.greenhopper.jira:global-sidebar-work-kanban com.pyxis.greenhopper.jira:project-sidebar-plan-scrum com.pyxis.greenhopper.jira:project-sidebar-work-scrum com.pyxis.greenhopper.jira:project-sidebar-work-kanban com.atlassian.jira.jira-projects-issue-navigator:embedded-issue-navigator-link com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator".split(" ");
return{init:function(a){function c(a){function b(){a.getAUISidebar().reflow()}setTimeout(b,200);setInterval(b,3E5)}g.initAPI(new n({el:a.$el[0]}));t(u).each(q.addPrefix);p.register();(function(a){a.on("collapse-start",function(){var b=a.$el.find(".scope-filter-trigger");b.hasClass("aui-dropdown2-active")&&b.trigger("aui-button-invoke")})})(a);(function(a){var b=d(".aui-sidebar .aui-badge");b.tooltip({gravity:"w"});a.isCollapsed()&&b.tooltip("disable");a.on("collapse-end expand-end",function(){d(".tipsy").remove();
d(".aui-sidebar .aui-badge").tooltip("toggleEnabled")})})(a);(function(){l.init({onProjectTypeChanged:function(){var a=k.getCurrentProjectKey();window.location.replace(r()+"/projects/"+a+"/summary")}});h.trace("project.types.warning.messages.init")})();g.getSidebar().done(function(a){e(a.el);f(a.el);c(a);m.start(a)})},setSidebarId:e,setSidebarAriaLabel:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Projects.Sidebar.ProjectShortcuts.Templates.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Projects == 'undefined') { JIRA.Projects = {}; }
if (typeof JIRA.Projects.Sidebar == 'undefined') { JIRA.Projects.Sidebar = {}; }
if (typeof JIRA.Projects.Sidebar.ProjectShortcuts == 'undefined') { JIRA.Projects.Sidebar.ProjectShortcuts = {}; }
if (typeof JIRA.Projects.Sidebar.ProjectShortcuts.Templates == 'undefined') { JIRA.Projects.Sidebar.ProjectShortcuts.Templates = {}; }


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.content = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.canManage || opt_data.numberOfShortcuts > 0) {
    output += '<div id="project-shortcuts-list-align-container" class="aui-sidebar-group jira-sidebar-group-with-divider project-shortcuts-group' + ((opt_data.numberOfShortcuts == 0) ? ' project-shortcuts-group_empty' : '') + '" data-id="project-shortcuts-group"><span class="aui-icon aui-icon-small aui-iconfont-link">' + soy.$$escapeHtml('Accesos directos del proyecto') + '</span><div class="aui-nav-heading">' + soy.$$escapeHtml('Accesos directos del proyecto') + '</div>' + ((opt_data.canManage) ? '<p class="project-shortcuts-group__description' + ((opt_data.numberOfShortcuts > 0) ? ' hidden' : '') + '">' + soy.$$escapeHtml('A\xf1ada un enlace a informaci\xf3n \xfatil para que todo el equipo la pueda ver.') + '</p>' : '') + '<ul class="aui-nav project-shortcuts-list">';
    if (opt_data.shortcuts) {
      var shortcutList26 = opt_data.shortcuts;
      var shortcutListLen26 = shortcutList26.length;
      for (var shortcutIndex26 = 0; shortcutIndex26 < shortcutListLen26; shortcutIndex26++) {
        var shortcutData26 = shortcutList26[shortcutIndex26];
        output += JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcut({id: shortcutData26.id, name: shortcutData26.name, url: shortcutData26.url, icon: shortcutData26.icon, canManage: opt_data.canManage, iconsMap: opt_data.iconsMap, isWithIcon: opt_data.isWithIcons});
      }
    }
    output += ((opt_data.canManage) ? '<li><a class="aui-nav-item project-shortcuts-group__add" href="#" data-link-id="project-shortcut-add"><span class="aui-icon aui-icon-large aui-iconfont-add-small"></span><span class="aui-nav-item-label">' + soy.$$escapeHtml('A\xf1adir enlace') + '</span></a></li>' : '') + '</ul></div>';
  }
  return output;
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.content.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.content';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcut = function(opt_data, opt_ignored) {
  return '<li class="project-shortcut"><a class="aui-nav-item project-shortcuts-group__link" href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.name) + '" target="_blank" rel="nofollow noopener noreferrer" data-shortcut-id="' + soy.$$escapeHtml(opt_data.id) + '" data-link-id="project-shortcut-' + soy.$$escapeHtml(opt_data.id) + '">' + ((opt_data.isWithIcon) ? '<span class="aui-icon aui-icon-large ' + JIRA.Projects.Sidebar.ProjectShortcuts.Templates.icon({iconId: opt_data.icon, iconsMap: opt_data.iconsMap}) + '" data-project-shortcuts-icon-id="' + soy.$$escapeHtml(opt_data.icon) + '">' + soy.$$escapeHtml('\xcdcono de acceso directo a proyectos') + '</span>' : '') + '<span class="aui-nav-item-label">' + soy.$$escapeHtml(opt_data.name) + '</span></a>' + ((opt_data.canManage) ? '<button class="aui-button aui-button-subtle aui-dropdown2-trigger aui-dropdown2-trigger-arrowless project-shortcuts-group__actions" aria-owns="project-shortcuts-dropdown_' + soy.$$escapeHtml(opt_data.id) + '" aria-controls="project-shortcuts-dropdown_' + soy.$$escapeHtml(opt_data.id) + '" aria-haspopup="true" data-aui-alignment-container="#project-shortcuts-list-align-container"><span class="aui-icon aui-icon-small aui-iconfont-more">' + soy.$$escapeHtml('Acciones de Filtro') + '</span></button><div id="project-shortcuts-dropdown_' + soy.$$escapeHtml(opt_data.id) + '" class="aui-dropdown2 aui-style-default project-shortcuts-group__dropdown"><ul class="aui-list-truncate"><li><a class="project-shortcuts-group__actions__edit" href="#">' + soy.$$escapeHtml('Editar') + '</a></li><li><a class="project-shortcuts-group__actions__delete  " href="#">' + soy.$$escapeHtml('Eliminar') + '</a></li></ul></div>' : '') + '</li>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcut.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcut';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.icon = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.iconsMap) {
    var id__soy85 = opt_data.iconId && opt_data.iconsMap[opt_data.iconId] ? opt_data.iconId : '1';
    output += (opt_data.iconsMap[id__soy85]) ? soy.$$escapeHtml(opt_data.iconsMap[id__soy85].className) : '';
  }
  return output;
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.icon.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.icon';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcutFormFields = function(opt_data, opt_ignored) {
  return '<div class="project-shortcuts-field-group">' + aui.form.textField({name: 'project-shortcuts-url-' + opt_data.action, isRequired: true, id: 'project-shortcuts-url-' + opt_data.action, labelContent: 'Direcci\xf3n web', placeholderText: 'p. ej. http://www.atlassian.com', extraClasses: 'project-shortcuts-url', value: opt_data.url ? opt_data.url : '', errorTexts: opt_data.errors.urlError ? [opt_data.errors.urlError] : []}) + '<div class="field-group project-shortcuts-name">' + aui.form.label({isRequired: true, forField: 'project-shortcuts-name-' + opt_data.action, content: 'Etiqueta'}) + '<div class="project-shortcuts-name-icon-block"><div class="project-shortcuts-icon-picker-block"></div>' + aui.form.input({name: 'project-shortcuts-name-' + opt_data.action, id: 'project-shortcuts-name-' + opt_data.action, placeholderText: 'p. ej. sitio web de Atlassian', extraClasses: 'project-shortcuts-name-input' + (opt_data.isWithIcon ? ' project-shortcuts-name-input-with-icon' : ''), value: opt_data.name ? opt_data.name : '', type: 'text'}) + '</div>' + ((opt_data.errors.iconError) ? aui.form.fieldError({message: opt_data.errors.iconError}) : '') + ((opt_data.errors.nameError) ? aui.form.fieldError({message: opt_data.errors.nameError}) : '') + '</div></div>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcutFormFields.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcutFormFields';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsPicker = function(opt_data, opt_ignored) {
  return '<span>' + JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsList(opt_data) + '</span>' + aui.dropdown2.trigger({menu: {id: 'project-shortcuts-icons-list-' + opt_data.cid}, extraClasses: 'aui-button project-shortcuts-icons-picker', iconClasses: 'aui-icon aui-icon-large  ' + soy.$$escapeHtml(opt_data.icon.className), extraAttributes: {href: '#'}});
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsPicker.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsPicker';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsList = function(opt_data, opt_ignored) {
  var output = '<div id="project-shortcuts-icons-list-' + soy.$$escapeHtml(opt_data.cid) + '" hidden class="aui-style-default aui-dropdown2 project-shortcuts-icons-list aui-dropdown2-section"><ul>';
  var iconList140 = opt_data.iconsList;
  var iconListLen140 = iconList140.length;
  for (var iconIndex140 = 0; iconIndex140 < iconListLen140; iconIndex140++) {
    var iconData140 = iconList140[iconIndex140];
    output += '<li><a class="project-shortcuts-icons-icon" data-project-shortcuts-icons-id="' + soy.$$escapeHtml(iconData140.name) + '"><span class="aui-icon aui-icon-large ' + soy.$$escapeHtml(iconData140.className) + '">' + soy.$$escapeHtml('\xcdcono de acceso directo a proyectos') + '</span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsList.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.iconsList';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.addDialog = function(opt_data, opt_ignored) {
  return '<form action="" method="post" class="aui"><h3>' + soy.$$escapeHtml('A\xf1adir enlace') + '</h3><fieldset>' + JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcutFormFields(soy.$$augmentMap(opt_data, {action: 'add'})) + '<div class="buttons-container"><div class="buttons"><button class="aui-button project-shortcuts-submit aui-button-primary">' + soy.$$escapeHtml('A\xf1adir') + '</button><button class="aui-button aui-button-link project-shortcuts-cancel">' + soy.$$escapeHtml('Cancelar') + '</button></div></div></fieldset></form>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.addDialog.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.addDialog';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialogChrome = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="edit-project-shortcut-dialog" class="aui-layer aui-dialog2 aui-dialog2-small" hidden data-aui-remove-on-hide="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Editar enlace') + '</h2></header></section>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialogChrome.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialogChrome';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialog = function(opt_data, opt_ignored) {
  return '<div class="aui-dialog2-content"><form class="aui" method="post">' + JIRA.Projects.Sidebar.ProjectShortcuts.Templates.shortcutFormFields(soy.$$augmentMap(opt_data, {action: 'edit'})) + '<button type="submit" class="project-shortcuts-hidden-submit"></button></form></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary project-shortcuts-submit">' + soy.$$escapeHtml('Guardar') + '</button><button class="aui-button aui-button-link project-shortcuts-cancel">' + soy.$$escapeHtml('Cancelar') + '</button></div></footer>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialog.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.editDialog';
}


JIRA.Projects.Sidebar.ProjectShortcuts.Templates.deleteDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="delete-project-shortcut-dialog" class="aui-layer aui-dialog2 aui-dialog2-small" hidden data-aui-remove-on-hide="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Eliminar acceso directo') + '</h2></header><div class="aui-dialog2-content"><p>' + soy.$$escapeHtml('\xbfEst\xe1 seguro de que desea eliminar este acceso directo?') + '</p></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary project-shortcuts-submit">' + soy.$$escapeHtml('Eliminar') + '</button><button class="aui-button aui-button-link project-shortcuts-cancel">' + soy.$$escapeHtml('Cancelar') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  JIRA.Projects.Sidebar.ProjectShortcuts.Templates.deleteDialog.soyTemplateName = 'JIRA.Projects.Sidebar.ProjectShortcuts.Templates.deleteDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/templates.js' */
define("jira/projects/sidebar/project-shortcuts/templates",function(){return JIRA.Projects.Sidebar.ProjectShortcuts.Templates});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Templates",null,require("jira/projects/sidebar/project-shortcuts/templates"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/project-shortcuts-analytics.js' */
define("jira/projects/sidebar/project-shortcuts/analytics",["jira/ajs/dark-features","jira/analytics","jquery"],function(h,d,g){var e=h.isEnabled("com.atlassian.jira.projects.ProjectCentricNavigation.ProjectShortcutIcons");return{initialize:function(a){this.projectId=a},initShortcutClick:function(a,b){var k=b.getAUISidebar(),c=g(a),f=this;c.on("click","a.project-shortcuts-group__link",function(a){a=c.find("a.project-shortcuts-group__link");var b=g(this);d.send({name:"jira.projects.shortcut.clicked",
data:{shortcutId:b.data("shortcutId"),shortcutPosition:b.closest("li").index()+1,shortcutIconName:e?b.find(".aui-icon").data("projectShortcutsIconId"):"",shortcutCount:a.size(),isWithIcons:e,isSidebarCollapsed:k.isCollapsed(),projectId:f.projectId}})})},initDialogActions:function(a){var b=this;a.on("childview:edit:open",function(a,c){a=c.collection.indexOf(c)+1;d.send({name:"jira.projects.shortcut.edit.dialog.opened",data:{isWithIcons:e,shortcutId:c.get("id"),shortcutPosition:a,shortcutCount:c.collection.size(),
projectId:b.projectId}})});a.on("childview:edit:close",function(a,c,f){a=c.collection.indexOf(c)+1;d.send({name:"jira.projects.shortcut.edit.dialog.closed",data:{isWithIcons:e,isSave:f,shortcutId:c.get("id"),shortcutPosition:a,shortcutCount:c.collection.size(),projectId:b.projectId}})});a.on("add:open",function(){d.send({name:"jira.projects.shortcut.add.dialog.opened",data:{isWithIcons:e,projectId:b.projectId}})});a.on("add:close",function(a){d.send({name:"jira.projects.shortcut.add.dialog.closed",
data:{isWithIcons:e,isSave:a,projectId:b.projectId}})})},iconChanged:function(a,b,e){d.send({name:"jira.projects.shortcut.icon.changed",data:{iconName:b,oldIconName:e,shortcutId:a.isNew()?"":a.get("id"),isNew:a.isNew(),cid:a.cid,projectId:this.projectId}})},iconChangeConfirmed:function(a,b){d.send({name:"jira.projects.shortcut.icon.confirmed",data:{oldIconName:a.get("icon"),iconName:b,shortcutId:a.isNew()?"":a.get("id"),isNew:a.isNew(),cid:a.cid,projectId:this.projectId}})},iconPickerOpened:function(a){d.send({name:"jira.projects.shortcut.icon.picker.opened",
data:{shortcutId:a.isNew()?"":a.get("id"),isNew:a.isNew(),cid:a.cid,projectId:this.projectId}})},iconPickerClosed:function(a,b){d.send({name:"jira.projects.shortcut.icon.picker.closed",data:{shortcutId:a.isNew()?"":a.get("id"),isNew:a.isNew(),cid:a.cid,isSave:b,projectId:this.projectId}})}}});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Analytics",null,require("jira/projects/sidebar/project-shortcuts/analytics"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/services/AvailableIcons.js' */
define("jira/projects/sidebar/project-shortcuts/services/available-icons",["underscore"],function(d){var b=[],c={},e=!1;return{initialize:function(a){b=a||b;c={};d.each(a,function(a){c[a.name]=a})},getIconsList:function(){return b},getIconsMap:function(){return c},getAllIconsClasses:function(){return d.reduce(b,function(a,b){return a+b.className+" "},"")},getIconFromName:function(a){return this.getIconsMap()[a]?this.getIconsMap()[a]:this.getIconsList()[0]?this.getIconsList()[0]:{}},setWithIcons:function(a){e=
a},isWithIcons:function(){return e}}});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Services.AvailableIcons",null,require("jira/projects/sidebar/project-shortcuts/services/available-icons"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/entities/Shortcut.js' */
define("jira/projects/sidebar/project-shortcuts/entities/shortcut",["jira/util/formatter","jira/util/logger","jira-projects-backbone","wrm/context-path"],function(g,d,e,h){function f(b){try{var a=JSON.parse(b.responseText)}catch(c){a={message:"No pudimos realizar esta acci\u00f3n porque parece haber un problema de comunicaci\u00f3n."}}return a}return e.Model.extend({defaults:{url:"",name:"",icon:""},initialize:function(b,a){if(!a||!a.projectKey)throw"Project key is required";this.projectKey=a.projectKey},urlRoot:function(){return h()+
"/rest/projects/1.0/project/"+encodeURIComponent(this.projectKey)+"/shortcut"},clear:function(){this.unset("id");this.set("url",this.defaults.url);this.set("name",this.defaults.name);this.set("icon",this.defaults.icon)},save:function(){if(!0!==this.saving){this.saving=!0;var b=this;b.trigger("save:start");var a=this.isNew()?"create":"update";this.sync(a,b).always(function(){b.saving=!1;b.trigger("save:finish")}).done(function(c){b.set(c,{silent:!0});d.trace("jira.projects.shortcuts."+a+".success");
b.trigger("save:success")}).fail(function(c){c=f(c);d.trace("jira.projects.shortcuts."+a+".fail");b.trigger("save:failure",c)})}},destroy:function(){if(!0!==this.saving){this.saving=!0;var b=this;b.trigger("remove:start");var a=e.Model.prototype.destroy.apply(this,arguments);a.always(function(){b.saving=!1;b.trigger("remove:finish")}).done(function(){b.trigger("remove:success")}).fail(function(a){a=f(a);b.trigger("remove:failure",a)});return a}}})});
AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Entities.Shortcut",null,require("jira/projects/sidebar/project-shortcuts/entities/shortcut"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/entities/ShortcutErrors.js' */
define("jira/projects/sidebar/project-shortcuts/entities/shortcut-errors",["jira-projects-backbone"],function(b){return b.Model.extend({defaults:{urlError:"",nameError:"",iconError:"",generalError:""},initialize:function(c,b){c=b.model;this.listenTo(c,"save:failure remove:failure",function(a){this.set({urlError:a.errors&&a.errors.url,nameError:a.errors&&a.errors.name,iconError:a.errors&&a.errors.icon,generalError:a.message||a.errorMessages&&0<a.errorMessages.length?a.message||a.errorMessages[0]:void 0})});
this.listenTo(c,"save:success remove:success",this.clear)}})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Entities.ShortcutErrors",null,require("jira/projects/sidebar/project-shortcuts/entities/shortcut-errors"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/entities/Shortcuts.js' */
define("jira/projects/sidebar/project-shortcuts/entities/shortcuts",["jira/projects/sidebar/project-shortcuts/entities/shortcut","jira-projects-backbone"],function(b,a){return a.Collection.extend({model:b,initialize:function(b,a){this.projectKey=a.projectKey}})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Entities.Shortcuts",null,require("jira/projects/sidebar/project-shortcuts/entities/shortcuts"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/IconPickerContent.js' */
define("jira/projects/sidebar/project-shortcuts/views/icon-picker-content",["jira/projects/sidebar/project-shortcuts/templates","jira/projects/sidebar/project-shortcuts/analytics","jira/projects/sidebar/project-shortcuts/services/available-icons","jira/projects/libs/marionette","jquery"],function(f,g,h,k,e){return k.ItemView.extend({template:f.iconsPicker,ui:{icon:".project-shortcuts-icons-icon",iconList:".project-shortcuts-icons-list",iconPicker:".project-shortcuts-icons-picker"},modelEvents:{"change:icon":function(){var a=
this._modelIcon(),b=this.ui.iconPicker.children();b.removeClass(this.iconFactory.getAllIconsClasses());b.addClass(a.className);this.ui.iconPicker.data("projectShortcutsIconsId",a.name)},"save:start":function(){this.ui.iconPicker.attr("aria-disabled",!0)},"save:finish":function(){this.ui.iconPicker.attr("aria-disabled",!1)}},events:{"keydown @ui.iconPicker":function(a){if(this.isPickerActive())switch(a.keyCode){case AJS.keyCode.LEFT:case AJS.keyCode.RIGHT:case AJS.keyCode.DOWN:case AJS.keyCode.UP:var b=
this.ui.iconList.find(".active"),d=this.ui.iconList.find("li").size();switch(a.keyCode){case AJS.keyCode.LEFT:var c=-1;break;case AJS.keyCode.RIGHT:c=1;break;case AJS.keyCode.DOWN:c=5;break;case AJS.keyCode.UP:c=-5;break;default:c=0}c=b.closest("li").index()+c;if(0>c||c>=d)c=(c+d)%d;b.removeClass("active aui-dropdown2-active");this.ui.icon.eq(c).addClass("active aui-dropdown2-active");a.stopPropagation();a.preventDefault();this.ui.iconList.trigger("aui-dropdown2-item-selected");break;case AJS.keyCode.ESCAPE:this.hideIconPicker(),
a.stopPropagation(),a.preventDefault()}}},initialize:function(a){this.iconFactory=h;this.analytics=g},onRender:function(){var a=this;this.ui.icon.on("click",function(){var b=e(this).data("projectShortcutsIconsId");a.analytics.iconChangeConfirmed(a.model,b);a.analyticsOldIconId="";a.analyticsIconClicked=!0;a.model.set("icon",b);a.ui.iconPicker.focus()});this.ui.iconList.on("aui-dropdown2-show",function(){a.ui.iconPicker.focus();a.analyticsIconClicked=!1;a.analytics.iconPickerOpened(a.model)});this.ui.iconList.on("aui-dropdown2-hide",
function(){a.analytics.iconPickerClosed(a.model,a.analyticsIconClicked)});this.analyticsOldIconId="";this.ui.iconList.on("aui-dropdown2-item-selected",function(b){b=e(this).find(".active").data("projectShortcutsIconsId");a.analyticsOldIconId&&a.analyticsOldIconId!==b&&a.analytics.iconChanged(a.model,b,a.analyticsOldIconId);a.analyticsOldIconId=b});this.ui.iconPicker.data("projectShortcutsIconsId",this.model.get("icon"))},hideIconPicker:function(){this.isPickerActive()&&this.ui.iconPicker.trigger("aui-button-invoke")},
isPickerActive:function(){return this.ui.iconPicker.hasClass("active")},_modelIcon:function(){return this.iconFactory.getIconFromName(this.model.get("icon"))},onFormSubmit:function(){this.model.set("icon",this.ui.iconPicker.data("projectShortcutsIconsId")||"")},focus:function(){this.ui.iconPicker.focus()},serializeData:function(){return{iconsList:this.iconFactory.getIconsList(),icon:this._modelIcon(),cid:this.cid}}})});
AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.IconPickerContent",null,require("jira/projects/sidebar/project-shortcuts/views/icon-picker-content"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/DialogContent.js' */
define("jira/projects/sidebar/project-shortcuts/views/dialog-content","jira/util/formatter jira/flag jira/projects/sidebar/project-shortcuts/views/icon-picker-content jira/projects/sidebar/project-shortcuts/services/available-icons jira/projects/libs/marionette underscore".split(" "),function(d,e,f,g,h,k){function c(a){a.preventDefault();this.ensureProtocolPrefix();this.tryToAutomagicallyDeriveNameFromUrl();if(this.iconPickerContent)this.iconPickerContent.onFormSubmit();this.model.set("url",this.ui.url.val());
this.model.set("name",this.ui.name.val());this.model.save()}var b=h.LayoutView.extend({ui:{form:"form",inputs:"input, button",submit:".project-shortcuts-submit",cancel:".project-shortcuts-cancel",url:".project-shortcuts-url input",name:".project-shortcuts-name input"},regions:{iconPicker:".project-shortcuts-icon-picker-block"},events:{"click @ui.cancel":function(a){a.preventDefault();this.model.clear();this.setNameAutomagically=!0;this.errorModel.clear();this.trigger("cancel")},"click @ui.submit":c,
"submit @ui.form":c,"blur @ui.url":function(){this.ensureProtocolPrefix();this.tryToAutomagicallyDeriveNameFromUrl()},"input @ui.url":function(){this.model.set("url",this.ui.url.val());this.tryToAutomagicallyDeriveNameFromUrl()},"input @ui.name":function(){this.setNameAutomagically=!1;this.model.set("name",this.ui.name.val())},"keydown @ui.name":function(a){this.iconPickerContent&&a.shiftKey&&a.keyCode===AJS.keyCode.TAB&&(a.preventDefault(),this.iconPickerContent.focus())},"keydown @ui.url":function(a){this.iconPickerContent&&
!a.shiftKey&&a.keyCode===AJS.keyCode.TAB&&(a.preventDefault(),this.iconPickerContent.focus())}},modelEvents:{"save:start":function(){this.ui.inputs.prop("disabled",!0);this.ui.submit.addClass("loading");this.ui.submit[0].busy()},"save:finish":function(){this.ui.inputs.prop("disabled",!1);this.ui.submit.removeClass("loading");this.ui.submit[0].idle()},"save:failure":function(){this.render();this.errorModel.get("generalError")&&e({type:"error",title:"No pudimos guardar el enlace para usted",
close:"auto",body:this.errorModel.get("generalError")});this.errorModel.get("nameError")&&this.ui.name.focus();this.errorModel.get("urlError")&&this.ui.url.focus();return this},"save:success":function(){this.setNameAutomagically=!0}},initialize:function(a){this.errorModel=a.errorModel;this.setNameAutomagically=0===this.model.get("name").length;this.iconFactory=g},serializeData:function(){return k.extend(this.model.toJSON(),{errors:this.errorModel.toJSON(),action:this.action,isWithIcon:this.iconFactory.isWithIcons()})},
onRender:function(){this.iconFactory.isWithIcons()?(this.iconPickerContent=new f({model:this.model,action:this.action,observable:this}),this.getRegion("iconPicker").show(this.iconPickerContent)):delete this.iconPickerContent},hideIconPicker:function(){this.iconPickerContent&&this.iconPickerContent.hideIconPicker()},setName:function(a){this.ui.name.val(a);this.model.set("name",a)},setUrl:function(a){this.ui.url.val(a);this.model.set("url",a)},ensureProtocolPrefix:function(){var a=this.ui.url.val().trim();
0<a.length&&!b.urlPattern.test(a)&&this.setUrl("http://"+a)},tryToAutomagicallyDeriveNameFromUrl:function(){var a=this.ui.url.val().trim();this.setNameAutomagically&&(b.urlOptionalProtocolPattern.test(a)?(a=b.urlOptionalProtocolPattern.exec(a),this.setName(a[3])):this.setName(a))}},{urlPattern:/^[a-zA-Z0-9]+:(\/\/)?([^\/]*).*/,urlOptionalProtocolPattern:/^([a-zA-Z0-9]+:(\/\/)?)?([^\/]*).*/});return b});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.DialogContent",null,require("jira/projects/sidebar/project-shortcuts/views/dialog-content"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/AddDialogContent.js' */
define("jira/projects/sidebar/project-shortcuts/views/add-dialog-content",["jira/projects/sidebar/project-shortcuts/templates","jira/projects/sidebar/project-shortcuts/views/dialog-content"],function(a,b){return b.extend({template:a.addDialog})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.AddDialogContent",null,require("jira/projects/sidebar/project-shortcuts/views/add-dialog-content"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/EditDialogContent.js' */
define("jira/projects/sidebar/project-shortcuts/views/edit-dialog-content",["jira/projects/sidebar/project-shortcuts/templates","jira/projects/sidebar/project-shortcuts/views/dialog-content"],function(a,b){return b.extend({template:a.editDialog})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.EditDialogContent",null,require("jira/projects/sidebar/project-shortcuts/views/edit-dialog-content"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/dialogs/Delete.js' */
define("jira/projects/sidebar/project-shortcuts/dialogs/delete","jira/projects/sidebar/project-shortcuts/templates jira/util/formatter jira/util/logger jira/flag jira/projects/libs/marionette underscore".split(" "),function(b,c,d,e,f,g){return f.ItemView.extend({template:b.deleteDialog,ui:{inputs:"input, button",submit:".project-shortcuts-submit",cancel:".project-shortcuts-cancel"},events:{"click @ui.cancel":function(a){a.preventDefault();this.dialog.hide()},"click @ui.submit":function(a){a.preventDefault();
this.model.destroy({wait:!0})}},modelEvents:{"remove:start":function(){this.ui.inputs.prop("disabled",!0);this.ui.submit.addClass("loading");this.ui.submit[0].busy()},"remove:finish":function(){this.ui.inputs.prop("disabled",!1);this.ui.submit.removeClass("loading");this.ui.submit[0].idle();this.dialog.hide();d.trace("jira.projects.shortcuts.deleted")},"remove:failure":function(a){(a.message||a.errorMessages&&0<a.errorMessages.length)&&e({type:"error",title:"No pudimos eliminar el enlace para usted",
close:"auto",body:a.message||a.errorMessages[0]})}},initialize:function(){this.render();this.$el.appendTo("body");this.dialog=AJS.dialog2(this.$el);this.dialog.show();var a=this;this.dialog.on("hide",function(){g.defer(function(){a.destroy()})})},onRender:function(){this.unwrapTemplate()}})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Dialogs.Delete",null,require("jira/projects/sidebar/project-shortcuts/dialogs/delete"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/dialogs/Edit.js' */
define("jira/projects/sidebar/project-shortcuts/dialogs/edit","jira/projects/sidebar/project-shortcuts/templates jira/projects/sidebar/project-shortcuts/views/edit-dialog-content jira/projects/sidebar/project-shortcuts/entities/shortcut jira/projects/sidebar/project-shortcuts/entities/shortcut-errors jira/projects/libs/marionette underscore jquery".split(" "),function(e,f,g,h,k,l,c){return k.Controller.extend({initialize:function(a){var b=this;l.bindAll(this,"hide");this.model=new g(a.model.toJSON(),
{projectKey:a.model.projectKey||a.model.collection.projectKey});this.errorModel=new h(void 0,{model:this.model});this.view=new f({model:this.model,errorModel:this.errorModel});this.analyticsSave=!1;this.view.render();var d=c(e.editDialogChrome({}));this.view.$el.appendTo(d);this.dialog=AJS.dialog2(d);this.dialog.show();this.view.ui.url.focus();this._onResizeWindow=function(){b.hideIconPicker()};c(window).on("resize",this._onResizeWindow);this.listenTo(this.view,"cancel",this.hide);this.listenTo(this.model,
"save:success",function(){this.analyticsSave=!0;this.hide();a.model.set(b.model.toJSON())});this.dialog.on("hide",function(){b.trigger("dialog:close",b.analyticsSave)})},hideIconPicker:function(){this.view.hideIconPicker()},hide:function(){this.dialog.hide();c(window).off("resize",this._onResizeWindow)}})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Dialogs.Edit",null,require("jira/projects/sidebar/project-shortcuts/dialogs/edit"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/dialogs/Add.js' */
define("jira/projects/sidebar/project-shortcuts/dialogs/add","aui/inline-dialog jira/projects/sidebar/project-shortcuts/views/add-dialog-content jira/projects/sidebar/project-shortcuts/entities/shortcut jira/projects/sidebar/project-shortcuts/entities/shortcut-errors jira/projects/libs/marionette underscore jquery".split(" "),function(h,k,e,l,m,n,c){return m.Controller.extend({initialize:function(b){n.bindAll(this,"hide","refresh","focusForm");var a=this;this.analyticsSave=!1;this.sidebarItem=b.sidebarItem;
this.projectKey=b.projectKey;this.collection=b.collection;this.model=new e(null,{projectKey:this.projectKey});this.errorModel=new l(null,{model:this.model});this.view=new k({model:this.model,errorModel:this.errorModel});this.view.render();var d=c(window),f=c(document),g=c(".aui-sidebar-body");this.dialog=new h(this.sidebarItem.ui.link,"project-shortcuts-group__add-dialog",function(p,q,b){a.sidebarItem.$el.addClass("aui-nav-selected");a.view.render();a.view.$el.appendTo(p);a.view.ui.url.focus();d.on("scroll.project-shortcuts",
function(){a.refresh()});g.on("scroll.project-shortcuts",function(){a.hide()});f.on("showLayer",a.focusForm);d.on("resize",a.refresh);b();return!1},{gravity:"w",autoWidth:!0,initCallback:function(){a.trigger("dialog:open");a.analyticsSave=!1},hideCallback:function(){a.sidebarItem.$el.removeClass("aui-nav-selected");a.sidebarItem.ui.link.blur();d.off("scroll.project-shortcuts");g.off("scroll.project-shortcuts");f.off("showLayer",a.focusForm);a.trigger("dialog:close",a.analyticsSave)},persistent:!0,
closeOnTriggerClick:!0,offsetY:function(a,b){b=b.target.height();return a.height()/2-b-10},arrowOffsetY:function(a,b){b=b.target.height()/2;return-(a.height()/2)+22+b}});b=this.dialog.find(".contents");b.off("mouseenter");b.off("mouseleave");this.listenTo(this.view,"render",this.refresh);this.listenTo(this.view,"cancel",this.hideAndRender);this.listenTo(this.model,"save:success",function(){var a=new e(this.model.toJSON(),{projectKey:this.projectKey});this.model.clear();this.collection.add(a);this.analyticsSave=
!0;this.hide()});this.listenTo(this.sidebarItem,"before:select",function(a){a.preventDefault()});AJS.sidebar(".aui-sidebar").on("collapse-start",this.hide);c(".project-shortcuts-group").on("click","li",this.hide)},hide:function(){this.view.hideIconPicker();this.dialog.hide()},refresh:function(){this.view.hideIconPicker();this.dialog.refresh()},hideAndRender:function(){this.hide()},focusForm:function(){this.view.ui.url.focus()}})});
AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Dialogs.Add",null,require("jira/projects/sidebar/project-shortcuts/dialogs/add"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/Shortcut.js' */
define("jira/projects/sidebar/project-shortcuts/views/shortcut","jira/projects/sidebar/project-shortcuts/templates jira/projects/sidebar/project-shortcuts/services/available-icons jira/projects/sidebar/project-shortcuts/dialogs/edit jira/projects/sidebar/project-shortcuts/dialogs/delete jira/projects/libs/marionette underscore jquery".split(" "),function(f,d,g,h,k,c,e){return k.ItemView.extend({template:f.shortcut,initialize:function(){c.bindAll(this,"toggleDropdown");this.iconFactory=d},ui:{del:".project-shortcuts-group__actions__delete",
edit:".project-shortcuts-group__actions__edit",trigger:".project-shortcuts-group__actions",dropdown:".project-shortcuts-group__dropdown",link:".project-shortcuts-group__link"},modelEvents:{change:"render"},events:{"click @ui.link":function(){this.trigger("click:link",this.model)}},onRender:function(){var a=this;this.unwrapTemplate();e(window);e(".aui-sidebar-body");this.ui.edit.on("click",function(b){b.preventDefault();a.ui.trigger.blur();b=new g({model:a.model});a.trigger("edit:open",a.model);a.listenToOnce(b,
"dialog:close",function(b){a.trigger("edit:close",a.model,b)})});this.ui.del.on("click",function(b){b.preventDefault();a.ui.trigger.blur();new h({model:a.model})});this.ui.dropdown.on({"aui-dropdown2-show":function(){a.$el.addClass("aui-nav-selected")},"aui-dropdown2-hide":function(){a.$el.removeClass("aui-nav-selected")}})},serializeData:function(){var a=c.extend(this.model.toJSON(),{canManage:!0,isWithIcon:this.iconFactory.isWithIcons()});this.iconFactory.isWithIcons()&&(a=c.extend(a,{iconsMap:d.getIconsMap()}));
return a},toggleDropdown:function(){this.ui.trigger.trigger("aui-button-invoke")}})});AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.Shortcut",null,require("jira/projects/sidebar/project-shortcuts/views/shortcut"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts', location = '/sidebar/project-shortcuts/views/ShortcutsList.js' */
define("jira/projects/sidebar/project-shortcuts/views/list","jira/api/projects/sidebar jira/projects/sidebar/project-shortcuts/templates jira/projects/sidebar/project-shortcuts/views/shortcut jira/projects/sidebar/project-shortcuts/dialogs/add jira/projects/sidebar/component/navigation-group jira/projects/libs/marionette jquery".split(" "),function(c,e,f,g,h,k,d){return k.CompositeView.extend({template:e.content,childView:f,ui:{itemsContainer:".aui-nav",description:".project-shortcuts-group__description",
add:".project-shortcuts-group__add"},collectionEvents:{"add remove":function(){if(0===this.collection.length&&0!==this.lastCollectionLength||0!==this.collection.length&&0===this.lastCollectionLength)this.lastCollectionLength=this.collection.length,this.ui.description.toggleClass("hidden",0<this.collection.length),this.$el.toggleClass("project-shortcuts-group_empty",0===this.collection.length)}},initialize:function(){var a=this;c.getSidebar().done(function(b){b=b.getAUISidebar();b.on("expand-end",
function(){d(".aui-sidebar-submenu-dialog .project-shortcuts-group__dropdown").remove()});b.on("collapse-start",function(){a.$(".project-shortcuts-group__actions.aui-dropdown2-active").trigger("aui-button-invoke")})});this.lastCollectionLength=this.collection.length},attachElContent:function(a){var b=new h({el:a});this.$el=d(b.getElement());c.getSidebar().done(function(a){a.replaceGroup(this.options.targetGroup,b)}.bind(this));return this},onRender:function(){c.getSidebar().done(function(a){a=new g({sidebarItem:a.getGroup("project-shortcuts-group").getItem("project-shortcut-add"),
projectKey:this.collection.projectKey,collection:this.collection});this.listenTo(a,"dialog:open",function(){this.trigger("add:open")});this.listenTo(a,"dialog:close",function(a){this.trigger("add:close",a)})}.bind(this))},serializeData:function(){return{canManage:!0,numberOfShortcuts:this.collection.length}},attachBuffer:function(a,b){this.ui.itemsContainer.prepend(b)},onAddChild:function(a){this.ui.add.parent().before(a.$el)}})});
AJS.namespace("JIRA.Projects.Sidebar.ProjectShortcuts.Views.List",null,require("jira/projects/sidebar/project-shortcuts/views/list"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:sidebar-project-shortcuts-init', location = '/sidebar/project-shortcuts/project-shortcuts-init.js' */
require("jira/projects/sidebar/project-shortcuts/analytics jira/projects/sidebar/project-shortcuts/views/list jira/projects/sidebar/project-shortcuts/services/available-icons jira/projects/sidebar/project-shortcuts/entities/shortcuts jira/api/projects/sidebar jira/api/projects wrm/data".split(" "),function(c,f,e,g,d,h,b){d.getSidebar().done(function(d){var a=b.claim("com.atlassian.jira.projects.shortcuts:project-id");c.initialize(a);b.claim("com.atlassian.jira.projects.shortcuts:can-manage")&&((a=
b.claim("com.atlassian.jira.projects.shortcuts:with-icons"))&&e.initialize(b.claim("com.atlassian.jira.projects.shortcuts:icons-list")),e.setWithIcons(a),a=h.getCurrentProjectKey(),a=new g(b.claim("com.atlassian.jira.projects.shortcuts:shortcuts"),{projectKey:a}),a=new f({collection:a,targetGroup:"project-shortcuts-group"}),a.render(),c.initDialogActions(a));c.initShortcutClick(".project-shortcuts-list",d)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:report-page-assets', location = '/page/project/report/analytics.js' */
define("jira/projects/page/report/analytics",["jira/analytics","jquery"],function(c,b){return function(){b(".reports .reports__list__report").on("click",function(a){a=b(this);c.send({name:"jira.projects.report.clicked",data:{report:a.attr("data-report-key"),category:a.closest("ul").attr("data-category-key"),listPosition:a.closest("li").prevAll().length+1}})})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:reports-link-storage', location = '/sidebar/reports/reports-link-storage.js' */
define("jira/projects/sidebar/reports/link-storage",["jira/util/logger","jira/data/local-storage","jira/api/projects","jira/api/projects/sidebar"],function(d,e,g,c){function f(a){a=a.getSelectedScopeFilterId();var b="last.viewed.report."+g.getCurrentProjectKey();a&&(b+="."+a);return b}return{storeLastViewedReportLink:function(a){c.getSidebar().done(function(b){if(b.isProjectSidebar()){var c=f(b);e.setItem(c,a);b.setReportsItemLink(a)}d.trace("jira.projects.sidebar.reports.link.stored")})},restoreLastViewedReportLink:function(){c.getSidebar().done(function(a){if(a.isProjectSidebar()){var b=
f(a);(b=e.getItem(b))&&a.setReportsItemLink(b)}d.trace("jira.projects.sidebar.reports.link.restored")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.jira-projects-plugin:reports-link-init', location = '/sidebar/reports/reports-link-init.js' */
require(["jira/projects/sidebar/reports/link-storage"],function(a){a.restoreLastViewedReportLink()});AJS.namespace("JIRA.Projects.Sidebar.Reports",null,require("jira/projects/sidebar/reports/link-storage"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board-router.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

ZEPHYR.Agile.TestBoard.Router = {URL: {}};
ZEPHYR.Agile.TestBoard.Router.URL.prefix = contextPath + '/secure/RapidBoard.jspa';


/**
 * Set the URL parameters
 */
ZEPHYR.Agile.TestBoard.Router.URL.setParams = function() {
	var viewType = ZEPHYR.Agile.TestBoard.data.view || ZEPHYR.Agile.TestBoard.view,
		page = ZEPHYR.Agile.TestBoard.data.page,
		boardSuffix = '&view=' + viewType + '&page=' + page;
	
	if(ZEPHYR.Agile.TestBoard.data.selectedSprint) {
		boardSuffix += '&selectedSprint=' + ZEPHYR.Agile.TestBoard.data.selectedSprint;
	}
	if(page == ZEPHYR.Agile.TestBoard.page.sprint) {
		if(ZEPHYR.Agile.TestBoard.data.selectedCycle) {
			boardSuffix += '&selectedCycle=' + ZEPHYR.Agile.TestBoard.data.selectedCycle;
		}
		if(ZEPHYR.Agile.TestBoard.data.selectedStatus) {
			boardSuffix += '&selectedStatus=' + ZEPHYR.Agile.TestBoard.data.selectedStatus;
		}
	} else if(page == ZEPHYR.Agile.TestBoard.page.issues) {
		// Issues board routes
	}
	if(ZEPHYR.Agile.TestBoard.data.isVersionsVisible) {
		boardSuffix += '&versions=visible';
	}
	if(ZEPHYR.Agile.TestBoard.data.versionId && !isNaN(ZEPHYR.Agile.TestBoard.data.versionId)) {
		boardSuffix += '&selectedVersion=' + ZEPHYR.Agile.TestBoard.data.versionId;
	}
    if(ZEPHYR.Agile.TestBoard.data.projectKey){
        boardSuffix = '&projectKey=' + ZEPHYR.Agile.TestBoard.data.projectKey + boardSuffix;
    }
	ZEPHYR.Agile.TestBoard.Router.URL.href = ZEPHYR.Agile.TestBoard.Router.URL.prefix + '?rapidView=' + ZEPHYR.Agile.TestBoard.data.agileBoardId + boardSuffix;
}

ZEPHYR.Agile.TestBoard.Router.URL.getURL = function() {
	return ZEPHYR.Agile.TestBoard.Router.URL.href;
}

ZEPHYR.Agile.TestBoard.Router.TestBoardRouter = Backbone.Router.extend({
    initialize: function(options) {
    	this.options = options;
    	this.testBoardURLRegex = /\?rapidView=(.*)(&projectKey=(.*))+&view=(.*)&page=(.*)/; // Regex to match testboard URL
    	this.route(/(.*)/, 'defaultAction');
    	this.route(this.testBoardURLRegex, "navigateToTestBoard");
    },
    navigateToTestBoard: function(agileId, projectKey, view, page) {
    	page = ZephyrURL('?page');
    	ZEPHYR.Agile.TestBoard.initTestBoard(page);    	
    },
    defaultAction: function(url) {
    	var location = window.location.href,
    		page = ZephyrURL('?page');
    		
    	if(this.testBoardURLRegex.test(location)) {
    		if(page) {
    			this.setParamaFromURL();
    			ZEPHYR.Agile.TestBoard.initTestBoard(page);
    		}
    	} else {
    		var view = ZephyrURL('?view');
    		if(view == ZEPHYR.Agile.TestBoard.view || view == ZEPHYR.Agile.TestBoard.viewDetail) {
    			this.setParamaFromURL();
    			ZEPHYR.Agile.TestBoard.initTestBoard(page);
    		}
    	}
    },
    setParamaFromURL: function() {
    	var versionId = ZephyrURL('?selectedVersion') || ZEPHYR.Agile.TestBoard.versionAllCycles;		// selected version id || 'all' 
    	var isVersionsVisible = (ZephyrURL('?versions') == 'visible')? true: false; 			// visible 
    	var selectedSprint = ZephyrURL('?selectedSprint');			// selected sprint id
    	var selectedCycle = ZephyrURL('?selectedCycle'); 			// selected cycle id
    	var selectedStatus = ZephyrURL('?selectedStatus'); 			// selected status id:offset
    	var view = ZephyrURL('?view'); 								// planning.test || planning.test.detail
    	var page = ZephyrURL('?page');								// sprint || issues
    	var isDetailView = (view == ZEPHYR.Agile.TestBoard.viewDetail)? true: false;
        var projectKey = ZephyrURL('?projectKey');  

    	ZEPHYR.Agile.TestBoard.data['versionId'] = versionId;
    	ZEPHYR.Agile.TestBoard.data['isVersionsVisible'] = isVersionsVisible;
    	ZEPHYR.Agile.TestBoard.data['selectedSprint'] = selectedSprint;
    	ZEPHYR.Agile.TestBoard.data['selectedCycle'] = selectedCycle;
    	ZEPHYR.Agile.TestBoard.data['selectedStatus'] = selectedStatus;
    	ZEPHYR.Agile.TestBoard.data['view'] = view;
    	ZEPHYR.Agile.TestBoard.data['page'] = page;
    	ZEPHYR.Agile.TestBoard.data['isDetailView'] = isDetailView;
        ZEPHYR.Agile.TestBoard.data['projectKey'] = projectKey;
    }
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board-header.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

/**
 * Display the header,
 * Back to Boards option
 * Collapsible/Expandable option
 * Toggle between Sprint and Issue view
 */
ZEPHYR.Agile.TestBoard.HeaderView = Backbone.View.extend({
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'displayBacklogUI');
		this.render();
		ZEPHYR.Agile.TestBoard.globalDispatcher.bind(ZEPHYR.Agile.TestBoard.Events.BOARD_NAME_UPDATE, this.updateHeader, this);
	},
	updateHeader: function(boardName) {
		AJS.$('#zephyr-tb-board-name').html(boardName);
	},
	displayBacklogUI: function(ev) {
		ev.preventDefault();
		var targetEl = AJS.$('.aui-nav-item[data-link-id="com.pyxis.greenhopper.jira:project-sidebar-' + ZEPHYR.Agile.TestBoard.data.mode + '-scrum"]');
		if(!targetEl.length)
			targetEl = AJS.$('.aui-nav-item[data-link-id="com.pyxis.greenhopper.jira:global-sidebar-' + ZEPHYR.Agile.TestBoard.data.mode + '-scrum"]');
		AJS.$('#ghx-view-pluggable, #ghx-controls, .ghx-sprint-meta').show();
		AJS.$('#zephyr-tb-back-to-boards-wrapper').remove();
		if(targetEl.length) {
			// If safari browser, since router navigate is not JIRA's router assigning to href
			// which will perform page reload
			if(navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0) {
				window.location.href = targetEl.attr('href');
			} else {
				ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(targetEl.attr('href'), {trigger: false}); 
			}
		}
		targetEl.trigger('click');
	},
	filterFocus: function(ev) {
		AJS.$(ev.target).animate({
		    width: "150px"
		  }, 'fast', 'linear');
	},
	filterBlur:function(ev) {
		var targetEl = AJS.$(ev.target),
		rawQuery = AJS.$.trim(targetEl.val());
		if (_.isEmpty(rawQuery)) {
			targetEl.animate({
			    width: "48px"
			}, 'fast', 'linear');
		}
	},
	attachEvents: function() {
		AJS.$('#zephyr-tb-back-to-boards-button').unbind('click')
			.bind('click', this.displayBacklogUI);
		AJS.$('.zephyr-tb-compact-toggle').unbind('click')
			.bind('click', this.toggleCompactView);
		AJS.$('#zephyr-tb-sprint-search-input')
			.unbind('keydown')
			.bind('keydown', function(ev){ev.stopImmediatePropagation();}) // Fix for ZFJ-2154
			.unbind('keyup')
			.bind('keyup', this.filterCycles)
			.focus(this.filterFocus)
			.blur(this.filterBlur);
		
		AJS.$('#zephyr-tb-issue-search-input')
			.unbind('keydown')
			.bind('keydown', function(ev){ev.stopImmediatePropagation();}) // Fix for ZFJ-2154
			.unbind('keyup')
			.bind('keyup', this.filterIssues)
			.focus(this.filterFocus)
			.blur(this.filterBlur);
		
		AJS.$('#zephyr-tb-filter-cycle-icon').unbind('click')
			.bind('click', function(ev) {
				ev.preventDefault();
				if(AJS.$(ev.target).hasClass('aui-iconfont-remove')) {
					AJS.$('#zephyr-tb-sprint-search-input').val('').trigger('keyup').focus();
				}
			});
		AJS.$('#zephyr-tb-filter-issue-icon').unbind('click')
			.bind('click', function(ev) {
				ev.preventDefault();
				if(AJS.$(ev.target).hasClass('aui-iconfont-remove')) {
					AJS.$('#zephyr-tb-issue-search-input').val('').trigger('keyup').focus();
				}
			});
		
		// Attach Test view toggle button
		AJS.$('#zephyr-tb-testboard-toggle-button').unbind('click')
			.bind('click', function(ev) {
				ev.preventDefault();
				var pageType = AJS.$(ev.target).data('page');
				
				AJS.$(ev.target).attr('disabled', 'disabled');
				ZEPHYR.Agile.TestBoard.navigateToTestBoardView(pageType);
			});

		AJS.$('#zephyr-include-all-sprint').unbind('click')
			.bind('click', function() {
				AJS.$(".sprint-module-heading").trigger("click", [{forcedTrigger: true}]);
				AJS.$(".zephyr-include-all-sprint-wait").show();
				var timeInterval = setInterval(function() {
					if(!AJS.$(".zephyr-tb-by-issues-sprint-wait").is(":visible")) {
						clearInterval(timeInterval);
						AJS.$(".zephyr-include-all-sprint-wait").hide();
						AJS.$(".zephyr-search-bar-wrap").show();
						AJS.$("#zephyr-include-all-sprint").hide();	
					}
				}, 500);
			});
	},
	filterCycles: function(ev) {
		var keyCode = ev.which;
		if(keyCode == 13) {
			ev.preventDefault();
			return false;
		}
		var input = AJS.$(ev.target).val();
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.CYCLES_FILTER,input);
		if(input) {
			AJS.$('#zephyr-tb-filter-cycle-icon').removeClass('aui-iconfont-search-small').addClass('aui-iconfont-remove');
		} else {
			AJS.$('#zephyr-tb-filter-cycle-icon').removeClass('aui-iconfont-remove').addClass('aui-iconfont-search-small');
		}
	},
	filterIssues: function(ev) {
		var keyCode = ev.which;
		if(keyCode == 13) {
			ev.preventDefault();
			return false;
		}
		var input = AJS.$(ev.target).val();
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.ISSUES_FILTER,input);
		if(input) {
			AJS.$('#zephyr-tb-filter-issue-icon').removeClass('aui-iconfont-search-small').addClass('aui-iconfont-remove');
		} else {
			AJS.$('#zephyr-tb-filter-issue-icon').removeClass('aui-iconfont-remove').addClass('aui-iconfont-search-small');
		}
	},
	toggleCompactView: function(ev) {
		ev.preventDefault();
		if(AJS.$('body').hasClass('zephyr-tb-header-compact')) {
			AJS.$('body').removeClass('zephyr-tb-header-compact');
		} else {
			AJS.$('body').addClass('zephyr-tb-header-compact');
		}
	},
	render: function() {	
		var boardName = '';
		if(GH.WorkControls && GH.WorkControls.rapidViewConfig && GH.WorkControls.rapidViewConfig.name) {
			boardName = GH.WorkControls.rapidViewConfig.name;
		} else {
			boardName = AJS.$('#ghx-board-name').text() || ZEPHYR.Agile.TestBoard.data.projectKey;
		}	
		// Hide the pluggable drop downs and agile controls
		AJS.$('#ghx-header, #ghx-operations').hide();
		AJS.$('#zephyr-tb-header, #zephyr-tb-operations').remove();
		
		var backToBoardsHTML = ZEPHYR.Templates.TestBoard.backToBoardsHTML({
			boardName: boardName,
			page: ZEPHYR.Agile.TestBoard.data.page
		});
		AJS.$(backToBoardsHTML).insertAfter('#ghx-header');
		
		var testboardOperationsHTML = ZEPHYR.Templates.TestBoard.testboardOperationsHTML();
		AJS.$(testboardOperationsHTML).insertAfter('#ghx-operations');
		this.attachEvents();
		return this;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board-view.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
ZEPHYR.Agile.TestBoard.Events = {
	RENDER_LAYOUT_SUCCESS: 'RENDER_LAYOUT_SUCCESS',
	VERSION_SELECT_SPRINTS_GET: 'VERSION_SELECT_SPRINTS_GET',
	EXECUTIONS_GET: 'EXECUTIONS_GET',
	CYCLES_FILTER: 'CYCLES_FILTER',
	CYCLES_COUNT_UPDATE: 'CYCLES_COUNT_UPDATE',
	CYCLE_PROGRESS_BAR_UPDATE: 'CYCLE_PROGRESS_BAR_UPDATE',
	VERSION_SELECT: 'VERSION_SELECT',
    BOARD_NAME_UPDATE: 'BOARD_NAME_UPDATE',
    ISSUES_FILTER: 'ISSUES_FILTER',
    ISSUES_COUNT_UPDATE: 'ISSUES_COUNT_UPDATE',
    ISSUE_PROGRESS_BAR_UPDATE: 'ISSUE_PROGRESS_BAR_UPDATE',
};

ZEPHYR.Agile.TestBoard.view = "planning.test";
ZEPHYR.Agile.TestBoard.viewDetail = "planning.test.detail";
ZEPHYR.Agile.TestBoard.versionAllCycles = "all";
ZEPHYR.Agile.TestBoard.page = {};
ZEPHYR.Agile.TestBoard.page.sprint = 'sprint';
ZEPHYR.Agile.TestBoard.page.issues = 'issues';


ZEPHYR.Agile.TestBoard.executionStatus = [];
//Fetch the test level status
ZEPHYR.Agile.TestBoard.getTestLevelStatus = function() {
	//ZEPHYR.Loading.showLoadingIndicator();
	AJS.$.ajax({
        url: getRestURL() + "/util/testExecutionStatus",
        type : "get",
        success : function(response){
        	ZEPHYR.Agile.TestBoard.executionStatus = response;
        },
        error: function() {
        	// Error handling
        	//ZEPHYR.Loading.hideLoadingIndicator();
        }
    });	
}

ZEPHYR.Agile.TestBoard.Loading = {
	showLoadingIndicator: function() {
		AJS.dim();
		AJS.$('.aui-blanket').html('<span class="zephyr-tb-wait"></span>');
	},
	hideLoadingIndicator: function() {
		AJS.$('.aui-blanket').remove();
	}
}

ZEPHYR.Agile.TestBoard.auiSelect2 = {
	DIACRITICS: {"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z"},
   	stripDiacritics: function(str) {
        var ret, i, l, c;

        if (!str || str.length < 1) return str;

        ret = "";
        for (i = 0, l = str.length; i < l; i++) {
            c = str.charAt(i);
            ret += ZEPHYR.Agile.TestBoard.auiSelect2.DIACRITICS[c] || c;
        }
        return ret;
    },
	markMatch: function(text, term, markup, escapeMarkup, container) {
        var match= ZEPHYR.Agile.TestBoard.auiSelect2.stripDiacritics(text.toUpperCase()).indexOf(ZEPHYR.Agile.TestBoard.auiSelect2.stripDiacritics(term.toUpperCase())),
            tl=term.length;

        if (match<0) {
            markup.push(escapeMarkup(text));
            return;
        }

        markup.push(escapeMarkup(text.substring(0, match)));
        markup.push("<span class='select2-match'>");
        markup.push(escapeMarkup(text.substring(match, match + tl)));
        markup.push("</span>");
        markup.push(escapeMarkup(text.substring(match + tl, text.length)));
        if(container && container.length) {
        	container.attr('title', text);
        }
    },
    formatResult: function(result, container, query, escapeMarkup) {
        var markup=[];
        ZEPHYR.Agile.TestBoard.auiSelect2.markMatch(result.text, query.term, markup, escapeMarkup, container);
        return markup.join("");
    },
	formatSelection: function(data, container, escapeMarkup) {
		if(container && container.length) {
			container.attr('title', data.text).text(data.text);
		} else 
			return data ? escapeMarkup(data.text) : undefined;
	}
}

// Event Dispatcher
ZEPHYR.Agile.TestBoard.globalDispatcher = _.extend({}, Backbone.Events);

ZEPHYR.Agile.TestBoard.setTestBoardParams = function() {
	ZEPHYR.Agile.TestBoard.views = {};   
	var agileBoardId = AJS.$('#zephyr-tb-agile-board-id').val(),
		agileBoardMode = AJS.$('#zephyr-tb-agile-board-mode').val();
	ZEPHYR.Agile.TestBoard.data = {
		testBoardElId: 'ghx-plan',
		projectId: JIRA.API.Projects.getCurrentProjectId(),
		projectKey: JIRA.API.Projects.getCurrentProjectKey(),
		agileBoardId: agileBoardId,
		mode: agileBoardMode
	};
}

ZEPHYR.Agile.TestBoard.escapeString = function (str) {
	if(str) {
	    return str.toString().
			replace(/\\/g, '\\\\').
	        replace(/\u0008/g, '\\b').
	        replace(/\t/g, '\\t').
	        replace(/\n/g, '\\n').
	        replace(/\f/g, '\\f').
	        replace(/\r/g, '\\r').
	        replace(/'/g, '\\\'').
	        replace(/"/g, '\\"');
	}
}

ZEPHYR.Agile.TestBoard.showErrorMessage = function(response, responseText, timeout) {
	var notFadeMessage = false;
	if(response.status == 403) {
		notFadeMessage = true;
	}
	showErrorMessage(responseText, 3000, notFadeMessage);
}

ZEPHYR.Agile.TestBoard.navigateToTestBoardView = function(page) {
	// Set/clear the previous data
	ZEPHYR.Agile.TestBoard.setTestBoardParams();
	ZEPHYR.Agile.TestBoard.data.page = page;
	ZEPHYR.Agile.TestBoard.Router.URL.setParams();
   	ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.href, {trigger: false});        
	ZEPHYR.Agile.TestBoard.initTestBoard(page);
}

ZEPHYR.Agile.TestBoard.initTestBoard = function(page) {
	page = page || ZEPHYR.Agile.TestBoard.page.sprint;
		
    AJS.$('#ghx-plan').html('').show();
    AJS.$('#ghx-report, #ghx-work, .ghx-sprint-meta').hide();
	if(page == ZEPHYR.Agile.TestBoard.page.sprint) {
		ZEPHYR.Agile.TestBoard.getTestLevelStatus();		
		ZEPHYR.Agile.TestBoard.views.sprintBoard = new ZEPHYR.Agile.TestBoard.SprintBoardView({
			el: '#' + ZEPHYR.Agile.TestBoard.data.testBoardElId
		});
		ZEPHYR.Agile.TestBoard.views.sprintBoard.render();
	} else if(page == ZEPHYR.Agile.TestBoard.page.issues) {
		ZEPHYR.Agile.TestBoard.getTestLevelStatus();	
		ZEPHYR.Agile.TestBoard.views.issuesBoard = new ZEPHYR.Agile.TestBoard.IssuesBoardView({
			el: '#' + ZEPHYR.Agile.TestBoard.data.testBoardElId
		});
		ZEPHYR.Agile.TestBoard.views.issuesBoard.render();
	}
	// Determine in which page we are
	ZEPHYR.page = 'testview-' + page;
}

/**
 * Update the container (#ghx-plan) height on content update
 */
ZEPHYR.Agile.TestBoard.updateContentAreaHeight = function() {
    var $containers = AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId);
    if ($containers.length) {
        var height = AJS.$(window).height() - 2; // take into account top border of content area
        var offset = $containers.offset();

        if (offset && offset.top) {
            height -= offset.top;
        }
		
        $containers.css({height: height});
    }
};


/**
 * Process the data which was loaded.
 */
ZEPHYR.Agile.TestBoard.processData = function(data) {
    // set the projects data
    var projectList = data.projects || [];
    // Fix for ZFJ-1729, If projects are empty display warning
    if(!projectList.length)  {
        ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
        AJS.messages.warning(AJS.$(AJS.$('.zephyr-aui-message-bar')[0]), {
           body: "Este panel no tiene proyectos o usted no tiene permiso para verlo."
        });
        return; 
    }
    ZEPHYR.Agile.TestBoard.data.projects = new ZEPHYR.Agile.TestBoard.ProjectCollection(projectList);
    	
    // Set the sprints data
    ZEPHYR.Agile.TestBoard.data.sprints = new ZEPHYR.Agile.TestBoard.SprintCollection(data.sprints);
    
	if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.sprint) {
		// Set versions
	    ZEPHYR.Agile.TestBoard.data.versionList = data.versionData;
	
	    // draw views    
	    // Attach Classification menu and Versions View
	    ZEPHYR.Agile.TestBoard.Menu.init();
	    // Sprints View
	    ZEPHYR.Agile.TestBoard.views.sprintsView = new ZEPHYR.Agile.TestBoard.SprintsView({
	        el: '#zephyr-tb-sprints-column',
	        model: ZEPHYR.Agile.TestBoard.data.sprints
	    });
	    ZEPHYR.Agile.TestBoard.views.sprintsView.render();
	    // Attach test board layout events
	    ZEPHYR.Agile.TestBoard.views.sprintBoard.trigger(ZEPHYR.Agile.TestBoard.Events.RENDER_LAYOUT_SUCCESS);
	} else if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.issues) {
		var issues = data.issues;
		issues = issues.map(function(issue) {
			if(!issue.hasOwnProperty('typeUrl')) {
				issue['typeUrl'] = data['entityData'] && data['entityData']['types'] && data['entityData']['types'][issue.typeId] && data['entityData']['types'][issue.typeId]['typeUrl'];
			}
			if(!issue.hasOwnProperty('priorityUrl')) {
				issue['priorityUrl'] = data['entityData'] && data['entityData']['types'] && data['entityData']['priorities'][issue.priorityId] && data['entityData']['priorities'][issue.priorityId]['priorityUrl'];
			}
			return issue;
		});
		ZEPHYR.Agile.TestBoard.data.issues = new ZEPHYR.Agile.TestBoard.IssueCollection(issues);
		
		ZEPHYR.Agile.TestBoard.views.issuesBoard.trigger(ZEPHYR.Agile.TestBoard.Events.RENDER_LAYOUT_SUCCESS);
	}

    // hide loading indicator
    ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
};

ZEPHYR.Agile.TestBoard.loadData = function() {
    var params = {
        rapidViewId: ZEPHYR.Agile.TestBoard.data.agileBoardId
    };

	ZEPHYR.Agile.TestBoard.Loading.showLoadingIndicator();
    var settings = {
        url: contextPath + '/rest/greenhopper/1.0/xboard/plan/backlog/data.json',
        data: params
    };

    var dataLoading = AJS.$.ajax(settings).done(ZEPHYR.Agile.TestBoard.processData);

    dataLoading.fail(function() {
        // Hide loading for the backlog
        ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
    });

    return dataLoading.promise();
};

/**
 * - HeaderView
 * - VersionsView
 * - SprintBoardView / IssueBoardView
 */
ZEPHYR.Agile.TestBoard.TestBoardView = Backbone.View.extend({
	initialize: function(options) {
		this.options = options;
		ZEPHYR.Agile.TestBoard.globalDispatcher.unbind(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);
		ZEPHYR.Agile.TestBoard.globalDispatcher.bind(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET, this.fetchSprints, this);
	},
	attachViews: function() {
		// Header View
		var hearderView = new ZEPHYR.Agile.TestBoard.HeaderView();
		
		// Attach Classification menu and Versions View
		// this.trigger(ZEPHYR.Agile.TestBoard.Events.RENDER_LAYOUT_SUCCESS);
	},
	render: function() {
		this.renderHTML = ZEPHYR.Templates.TestBoard.testBoardLayout({
			page: ZEPHYR.Agile.TestBoard.data.page
		});
		
		this.$el.html(this.renderHTML);
		this.attachViews();
		ZEPHYR.Agile.TestBoard.loadData();
		return this;
	}
});

/**
 * Check if all the AJAX call are completed, then enable the Test View toggle button
 */
AJS.$(document).bind("ajaxStop", function(){
	AJS.$('#zephyr-tb-testboard-toggle-button').removeAttr('disabled');
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board-execution.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
ZEPHYR.Agile.TestBoard.EXECUTION_MAX_RESULT_ALLOWED = 10;

// Executions
ZEPHYR.Agile.TestBoard.Execution = Backbone.Model.extend();
ZEPHYR.Agile.TestBoard.ExecutionCollection = Backbone.Collection.extend({
	model: ZEPHYR.Agile.TestBoard.Execution,
 	url: function() {
 		if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.sprint) {
 			return getRestURL() + "/zql/executeSearch";
 		} else if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.issues) {
 			return getRestURL() + "/execution/executionsByIssue";
 		}
 	},
 	parse: function(resp, xhr) {
		this.offset = resp.offset;
		this.currentIndex = resp.currentIndex;
		this.maxResultAllowed = resp.maxResultAllowed;
		this.linksNew = resp.linksNew;
		this.totalCount = resp.totalCount;
		this.executionStatus = resp.executionStatuses;
 		return resp.executions;
 	}
});

//{call ZEPHYR.Agile.TestBoard.getCycleZQLQuery data="[$cycle.versionName, $cycle.name]" /}
ZEPHYR.Agile.TestBoard.getCycleZQLQuery = function(params, output) {
	var fixVersion = params[0],
		cycleName = params[1],
		projectKey = params[2],
		zql = 'project = "' + ZEPHYR.Agile.TestBoard.escapeString(projectKey) + '" AND fixVersion = "' + ZEPHYR.Agile.TestBoard.escapeString(fixVersion) + '" AND cycleName in ("' 
			+ ZEPHYR.Agile.TestBoard.escapeString(cycleName) +'")';
	
	return appendSoyOutputOnCall(encodeURIComponent(zql), output);
}

/**
 * Execution pagination view
 */
ZEPHYR.Agile.TestBoard.ExecutionPaginationView = Backbone.View.extend({
    tagName:'div',
    events:{
    	"click [id^='zql-pagination-']" : 'executePaginatedSearch',
    	"click [id^='refreshZQLId']"	: "refreshZQLView"
    },
    initialize:function (options) {
    	this.eventId = (options.eventId) ? '_' + options.eventId: '';
        this.model.bind("reset", this.render, this);
    }, 
    render:function () {
    	if(this.model.length > 0) {
    		var addZQLPaginationFooterHTML = ZEPHYR.Templates.TestBoard.addZQLPaginationFooterHTML({
	    		totalCount: this.model.totalCount,
	    		currentIndex: this.model.currentIndex,
	    		maxAllowed: this.model.maxResultAllowed,
	    		linksNew: this.model.linksNew
	    	})
    		this.$el.html(addZQLPaginationFooterHTML);
    	} else {
			this.$el.html('');
		}
		return this;
    },
    executePaginatedSearch : function(ev) {
    	ev.preventDefault();
    	this.offset = eval(ev.target.attributes['page-id'].value);
    	this.currentOffset = (this.offset/ZEPHYR.Agile.TestBoard.EXECUTION_MAX_RESULT_ALLOWED) + 1;
    	ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET + this.eventId, this.offset);
    },
    
    refreshZQLView: function(ev) {
    	ev.preventDefault();
    	ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET + this.eventId, this.offset);
    }
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board.soy' */
// This file was automatically generated from zephyr-test-board.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ZEPHYR.Templates.TestBoard.
 */

if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Templates == 'undefined') { ZEPHYR.Templates = {}; }
if (typeof ZEPHYR.Templates.TestBoard == 'undefined') { ZEPHYR.Templates.TestBoard = {}; }


ZEPHYR.Templates.TestBoard.testBoardLayout = function(opt_data, opt_ignored) {
  return '<div id="zephyr-tb-plan-group" class="zephyr-tb-plan-group"><div id="zephyr-tb-classification-menu-column" class="zephyr-tb-ide-menu zephyr-tb-classification-menu"></div>' + ((opt_data.page == 'sprint') ? '<div id="zephyr-tb-version-column" class="zephyr-tb-version-column zephyr-tb-classification-column"></div>' : '') + '<div id="zephyr-tb-sprints-column" class="zephyr-tb-sprints-column"></div><div id="zephyr-tb-detail-column" class="zephyr-tb-detail-view"></div></div>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.testBoardLayout.soyTemplateName = 'ZEPHYR.Templates.TestBoard.testBoardLayout';
}


ZEPHYR.Templates.TestBoard.classificationMenuHTML = function(opt_data, opt_ignored) {
  return '<ul id="zephyr-tb-classification-menu" class="zephyr-tb-ide-menu zephyr-tb-classification-menu"><li role="button" id="zephyr-tb-version-toggle" data-target-id="zephyr-tb-version-column" class="js-version-toggle zephyr-tb-version-toggle zephyr-tb-active" title="' + soy.$$escapeHtml('Mostrar panel de versiones') + '"><span class="zephyr-tb-inner" data-target-id="zephyr-tb-version-column">' + soy.$$escapeHtml('Versiones') + '</span></li></ul>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.classificationMenuHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.classificationMenuHTML';
}


ZEPHYR.Templates.TestBoard.versionsHTML = function(opt_data, opt_ignored) {
  var output = '<div class="zephyr-tb-classification-group"><div class="zephyr-tb-classification-header"><div class="zephyr-tb-actions"><div class="zephyr-tb-close js-release-toggle zephyr-tb-version-close" title="' + soy.$$escapeHtml('Ocultar panel de versiones') + '"><span class="zephyr-tb-iconfont aui-icon aui-icon-small aui-iconfont-remove-label"></span></div></div><h2>' + soy.$$escapeHtml('Versiones') + '</h2></div><div class="zephyr-tb-classification-scrollview"><div class="zephyr-tb-classification-item zephyr-tb-classification-all" data-version-id="' + soy.$$escapeHtml(opt_data.allVersionIds) + '" data-project-id="' + soy.$$escapeHtml(opt_data.allProjectIds) + '"><div class="zephyr-tb-inner"><div class="zephyr-tb-header"><h3 class="zephyr-tb-name"><span class="js-version-name" role="button">' + soy.$$escapeHtml('All cycles') + '</span></h3></div></div></div><div class="zephyr-tb-classification-cards">';
  var versionList26 = opt_data.versions;
  var versionListLen26 = versionList26.length;
  for (var versionIndex26 = 0; versionIndex26 < versionListLen26; versionIndex26++) {
    var versionData26 = versionList26[versionIndex26];
    output += (versionData26.released == false) ? '<div class="zephyr-tb-classification-item zephyr-tb-closed" data-project-id="' + soy.$$escapeHtml(versionData26.projectId) + '" data-version-id="' + soy.$$escapeHtml(versionData26.versionId) + '"><div class="zephyr-tb-inner"><div class="zephyr-tb-header"><h3 class="zephyr-tb-name">' + ((opt_data.showProjectName) ? '<span class="zephyr-tb-project-key" title="' + soy.$$escapeHtml(versionData26.projectId) + '">' + soy.$$escapeHtml(versionData26.projectName) + '</span>' : '') + '<span class="js-version-name" role="button"><span class="field-value js-editable-field js-edit-versionName-trigger" data-fieldname="' + soy.$$escapeHtml(versionData26.name) + '" data-project-id="' + soy.$$escapeHtml(versionData26.projectId) + '" data-fieldvalue="' + soy.$$escapeHtml(versionData26.id) + '">' + soy.$$escapeHtml(versionData26.name) + '</span></span></h3></div></div></div>' : '';
  }
  output += '</div></div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.versionsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.versionsHTML';
}


ZEPHYR.Templates.TestBoard.backToBoardsHTML = function(opt_data, opt_ignored) {
  return '<div id="zephyr-tb-header"><div id="ghx-modes-tools"><span id="ghx-view-pluggable"><div class="ghx-view-section"><div id="zephyr-tb-back-to-boards-wrapper" class="ghx-view-section"><button id="zephyr-tb-testboard-toggle-button" disabled="disabled" data-page="' + ((opt_data.page == 'sprint') ? 'issues' : (opt_data.page == 'issues') ? 'sprint' : '') + '" class="aui-button">' + ((opt_data.page == 'sprint') ? soy.$$escapeHtml('Vista de Prueba') + '&nbsp;-&nbsp;' + soy.$$escapeHtml('Por Problemas') : (opt_data.page == 'issues') ? soy.$$escapeHtml('Vista de Prueba') + '&nbsp;-&nbsp;' + soy.$$escapeHtml('Por Sprint') : '') + '</button><button id="zephyr-tb-back-to-boards-button" class="aui-button">' + soy.$$escapeHtml('Volver a los Paneles') + '</button></div></div></span><div id="ghx-view-presentation"><button id="zephyr-tb-compact-toggle" class="aui-button zephyr-tb-compact-toggle js-compact-toggle" title="' + soy.$$escapeHtml('Oculta encabezado ( Z )') + '"><span class="aui-icon ghx-iconfont aui-icon-small aui-iconfont-arrows-up"></span></button></div></div><div id="ghx-view-selector"><h1><span id="zephyr-tb-board-name" class="subnav-page-header">' + soy.$$escapeHtml(opt_data.boardName) + '</span><span class="subnav-container"><span id="subnav-title"><span class="subnavigator-title" title="' + soy.$$escapeHtml('Backlog') + '&nbsp;' + ((opt_data.page == 'sprint') ? '(' + soy.$$escapeHtml('Por Sprint') + ')' : (opt_data.page == 'issues') ? '(' + soy.$$escapeHtml('Por Problemas') + ')' : '') + '">' + soy.$$escapeHtml('Backlog') + '&nbsp;' + ((opt_data.page == 'sprint') ? '(' + soy.$$escapeHtml('Por Sprint') + ')' : (opt_data.page == 'issues') ? '(' + soy.$$escapeHtml('Por Problemas') + ')' : '') + '</span><form onsubmit="return false;" id="zephyr-tb-sprint-search" class="aui">' + ((opt_data.page == 'sprint') ? '<div class="zephyr-tb-sprint-search"><div class="zephyr-search-bar-wrap" style="display: none"><input class="text zephyr-tb-search" title="' + soy.$$escapeHtml('Filtrar por nombre de ciclo') + '" type="text" id="zephyr-tb-sprint-search-input" /><span title="' + soy.$$escapeHtml('Filtrar por nombre de ciclo') + '" id="zephyr-tb-filter-cycle-icon" class="js-search-trigger zephyr-tb-iconfont aui-icon aui-icon-small aui-iconfont-search-small"></span></div><button id="zephyr-include-all-sprint" data-page="sprint" class="aui-button">Enable Search</button><aui-spinner class="zfj-icon-wait zephyr-include-all-sprint-wait" style="display:none"></aui-spinner></div>' : (opt_data.page == 'issues') ? '<div class="zephyr-tb-issues-search"><div class="zephyr-search-bar-wrap" style="display: none"><input class="text zephyr-tb-search" title="' + soy.$$escapeHtml('Filtrar por clave de problema y resumen') + '" type="text" id="zephyr-tb-issue-search-input" /><span title="' + soy.$$escapeHtml('Filtrar por clave de problema y resumen') + '" id="zephyr-tb-filter-issue-icon" class="js-search-trigger zephyr-tb-iconfont aui-icon aui-icon-small aui-iconfont-search-small"></span></div><button id="zephyr-include-all-sprint" data-page="sprint" class="aui-button">Enable Search</button><aui-spinner class="zfj-icon-wait zephyr-include-all-sprint-wait" style="display:none"></aui-spinner></div>' : '') + '</form></span></span></h1></div><div class="active zfj-permission-test-view" id="zfj-permission-message-bar-test-view"></div><div class="zephyr-aui-message-bar" id="zephyr-aui-message-bar" class="zephyr-tb-message-bar"></div></div>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.backToBoardsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.backToBoardsHTML';
}


ZEPHYR.Templates.TestBoard.testboardOperationsHTML = function(opt_data, opt_ignored) {
  return '<div id="zephyr-tb-operations"><div id="zephyr-tb-controls"><div id="zephyr-tb-controls-plan" class="zephyr-tb-controls-plan zephyr-tb-controls-list"><button class="aui-button zephyr-tb-compact-toggle js-compact-toggle" title="' + soy.$$escapeHtml('Oculta encabezado ( Z )') + '"><span class="aui-icon zephyr-tb-iconfont aui-icon-small aui-iconfont-arrows-down"></span></button></div></div></div>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.testboardOperationsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.testboardOperationsHTML';
}


ZEPHYR.Templates.TestBoard.addZQLPaginationFooterHTML = function(opt_data, opt_ignored) {
  var output = '<div class="aui-group count-pagination navigator-results" id="displayDetailId"><div class="results-count aui-item">' + ((opt_data.currentIndex * opt_data.maxAllowed < opt_data.totalCount) ? '<span class=\'results-count-start\'>' + soy.$$escapeHtml((opt_data.currentIndex - 1) * opt_data.maxAllowed + 1) + '</span><span>-</span><span class="results-count-end">' + soy.$$escapeHtml(opt_data.currentIndex * opt_data.maxAllowed) + '</span><span> of </span><span class="results-count-total results-count-link"> ' + soy.$$escapeHtml(opt_data.totalCount) + ' </span>' : '<span class=\'results-count-start\'>' + soy.$$escapeHtml((opt_data.currentIndex - 1) * opt_data.maxAllowed + 1) + '</span><span>-</span><span class="results-count-end">' + soy.$$escapeHtml(opt_data.totalCount) + '</span><span> of </span><span class="results-count-total results-count-link"> ' + soy.$$escapeHtml(opt_data.totalCount) + ' </span>') + '<a href="#" id=\'refreshZQLId\' class="refresh-table" title="Refresh results"><span class="aui-icon aui-icon-small aui-iconfont-build"></span></a></div>';
  if (opt_data.linksNew.length > 0) {
    output += '<div class="pagination aui-item" id="zqlPageId">' + ((opt_data.currentIndex > 1) ? '<a href=\'#\' id=\'zql-pagination-' + soy.$$escapeHtml(opt_data.currentIndex - 2) + ' * ' + soy.$$escapeHtml(opt_data.maxAllowed) + '\' page-id=\'' + soy.$$escapeHtml(opt_data.currentIndex - 2) + '*' + soy.$$escapeHtml(opt_data.maxAllowed) + '\' class=\'icon icon-previous push-state\'><span>Previous &gt;&gt;</span></a>' : '');
    var linkList152 = opt_data.linksNew;
    var linkListLen152 = linkList152.length;
    for (var linkIndex152 = 0; linkIndex152 < linkListLen152; linkIndex152++) {
      var linkData152 = linkList152[linkIndex152];
      output += (linkData152 == opt_data.currentIndex) ? '<strong>' + soy.$$escapeHtml(linkData152) + '&nbsp;</strong>' : '<a href=\'#\' id=\'zql-pagination-' + soy.$$escapeHtml(linkData152 - 1) + '*' + soy.$$escapeHtml(opt_data.maxAllowed) + '\' page-id=\'' + soy.$$escapeHtml(linkData152 - 1) + '*' + soy.$$escapeHtml(opt_data.maxAllowed) + '\'>' + soy.$$escapeHtml(linkData152) + '&nbsp;</a>';
    }
    output += ((opt_data.currentIndex * opt_data.maxAllowed < opt_data.totalCount) ? '<a href=\'#\' id=\'zql-pagination-' + soy.$$escapeHtml(opt_data.currentIndex) + ' * ' + soy.$$escapeHtml(opt_data.maxAllowed) + '\' page-id=\'' + soy.$$escapeHtml(opt_data.currentIndex) + ' * ' + soy.$$escapeHtml(opt_data.maxAllowed) + '\' class=\'icon icon-next\'><span>Next &gt;&gt;</span></a>' : '') + '</div>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.addZQLPaginationFooterHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.addZQLPaginationFooterHTML';
}


ZEPHYR.Templates.TestBoard.defectColumnValue = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.defects && opt_data.defects.length) {
    var defectList187 = opt_data.defects;
    var defectListLen187 = defectList187.length;
    for (var defectIndex187 = 0; defectIndex187 < defectListLen187; defectIndex187++) {
      var defectData187 = defectList187[defectIndex187];
      var defectStatus__soy188 = '' + convertToLowerCase([defectData187.defectStatus]);
      output += ((defectData187.defectKey == 'XXXXX') ? '<span ' + ((defectData187.defectResolutionId) ? ' style="text-decoration:line-through;"' : '') + ' data-defect-resolution="' + soy.$$escapeHtml(defectData187.defectResolutionId) + '" data-issueKey="' + soy.$$escapeHtml(defectData187.defectKey) + '" data-status="' + soy.$$escapeHtml(defectData187.defectStatus) + '" data-summary="' + soy.$$escapeHtml(defectData187.defectSummary) + '">' + soy.$$escapeHtml(defectData187.defectKey) + '</span>' : '<a ' + ((defectData187.defectResolutionId) ? ' style="text-decoration:line-through;"' : '') + ' href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(defectData187.defectKey) + '" data-defect-resolution="' + soy.$$escapeHtml(defectData187.defectResolutionId) + '" data-issueKey="' + soy.$$escapeHtml(defectData187.defectKey) + '" data-status="' + soy.$$escapeHtml(defectData187.defectStatus) + '" data-summary="' + soy.$$escapeHtml(defectData187.defectSummary) + '">' + soy.$$escapeHtml(defectData187.defectKey) + '</a>') + ((! (defectIndex187 == defectListLen187 - 1)) ? ', ' : '');
    }
  } else {
    output += soy.$$escapeHtml('-');
  }
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.defectColumnValue.soyTemplateName = 'ZEPHYR.Templates.TestBoard.defectColumnValue';
}


ZEPHYR.Templates.TestBoard.versionProgressHTML = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.summaryList && opt_data.summaryList.executionSummary) {
    output += '<div class="zephyr-tb-versions-table-progress"><div class="zephyr-tb-progressbar-container"><div class="zephyr-tb-progressbar zephyr-tb-progressbar-full">';
    var summaryList237 = opt_data.summaryList.executionSummary;
    var summaryListLen237 = summaryList237.length;
    for (var summaryIndex237 = 0; summaryIndex237 < summaryListLen237; summaryIndex237++) {
      var summaryData237 = summaryList237[summaryIndex237];
      output += (summaryData237.count > 0) ? '<div statusKey=' + soy.$$escapeHtml(summaryData237.statusKey) + ' statusCount=' + soy.$$escapeHtml(summaryData237.count) + ' class="zephyr-tb-progressbar-entry" title="' + soy.$$escapeHtml(summaryData237.statusName) + ' ' + soy.$$escapeHtml(summaryData237.count) + ' / ' + soy.$$escapeHtml(Math.round(summaryData237.count / opt_data.totalExecutions * 100 * 100) / 100) + '%" style="background: ' + soy.$$escapeHtml(summaryData237.statusColor) + '; width:' + soy.$$escapeHtml(summaryData237.count * 160 / opt_data.totalExecutions) + 'px;"></div>' : '';
    }
    output += '</div></div></div>';
  }
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.versionProgressHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.versionProgressHTML';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/zephyr-test-board-menu.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

// Projects
ZEPHYR.Agile.TestBoard.Project = Backbone.Model.extend();
ZEPHYR.Agile.TestBoard.ProjectCollection = Backbone.Collection.extend({
    model: ZEPHYR.Agile.TestBoard.Project
});

// Versions
ZEPHYR.Agile.TestBoard.Version = Backbone.Model.extend();
ZEPHYR.Agile.TestBoard.VersionCollection = Backbone.Collection.extend({
    model: ZEPHYR.Agile.TestBoard.Version,
    url: function() {
    	return getRestURL() + "/util/versionBoard-list?projectId=" + ZEPHYR.Agile.TestBoard.data.projectId;
    },
    parse: function(resp, xhr) {
    	return resp;
    }
});

/**
 * Display versions
 */
ZEPHYR.Agile.TestBoard.VersionsView = Backbone.View.extend({
	events: {
		'click .zephyr-tb-version-close': 'hideVersionNav',
		'click .zephyr-tb-classification-item': 'selectVersion'
	},
	initialize: function(options) {
		this.options = options;
		// this.model.bind('reset', this.render, this);
		this.showProjectName = options.showProjectName;
	},
	selectVersion: function(ev) {
		var targetEl = AJS.$(ev.target).closest('.zephyr-tb-classification-item'),
			versionIds = targetEl.data('version-id'),
			projectId = targetEl.data('project-id');
		
		this.$el.find('.zephyr-tb-classification-item').removeClass('zephyr-tb-selected');
		targetEl.addClass('zephyr-tb-selected');
		
		// Clear the detail column view if expanded
		AJS.$('#zephyr-tb-detail-column').html('').width(0);
		AJS.$('.zephyr-tb-issue-content').removeClass('zephyr-tb-selected');
		ZEPHYR.Agile.TestBoard.data.versionId = versionIds;
		ZEPHYR.Agile.TestBoard.data['selectedSprint'] = null;
		ZEPHYR.Agile.TestBoard.data['selectedCycle'] = null;
		ZEPHYR.Agile.TestBoard.data['selectedStatus'] = null;
		ZEPHYR.Agile.TestBoard.data['projectId'] = projectId;
		if(targetEl.hasClass('zephyr-tb-classification-all')) {
			this.getAllVersions();			
		} else {
			this.getVersionById(versionIds);
		}
		/** Update URL **/
		ZEPHYR.Agile.TestBoard.Router.URL.setParams();
		ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false}); 
		// Trigger call to sprint view 
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);		
	},
	hideVersionNav: function() {
		this.$el.hide();
		AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId).removeClass('zephyr-tb-version-expanded');
		/** Update URL **/
		ZEPHYR.Agile.TestBoard.data.isVersionsVisible = false;
		ZEPHYR.Agile.TestBoard.Router.URL.setParams();
		ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false}); 
	},
	getAllVersionIds: function() {
		var versionIds = _.pluck(this.model.toJSON(), 'versionId');

		return _.unique(versionIds);
	},
	getAllProjectIds: function() {
		var projectIds = _.pluck(ZEPHYR.Agile.TestBoard.data.projects.toJSON(), 'id');

		return projectIds;
	},
	getAllVersions: function() {
		var versions = this.model.toJSON() || [];
		ZEPHYR.Agile.TestBoard.data.versions = versions;
	},
	getVersionById: function(versionId) {
		var versions = this.model.toJSON() || [];
		ZEPHYR.Agile.TestBoard.data.versions = [];
		
		if(versions.length) {
			_.each(versions, function(version) {
				if(version.versionId == versionId)
					ZEPHYR.Agile.TestBoard.data.versions.push(version);
			});
		}
	},
	render: function() {
		var versions = this.model.toJSON() || [];
		var allVersionIds = this.getAllVersionIds();
		var allProjectIds = this.getAllProjectIds();
		var versionsHTML = ZEPHYR.Templates.TestBoard.versionsHTML({
			versions: versions,
			allVersionIds: allVersionIds,
			allProjectIds: allProjectIds,
			showProjectName: this.showProjectName
		});
		this.$el.html(versionsHTML);
		if(!AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId + '.zephyr-tb-version-expanded').length) {
			this.$el.hide();
		}
		var selectedVersion = this.$el.find('.zephyr-tb-classification-item[data-version-id="' + ZEPHYR.Agile.TestBoard.data.versionId + '"]');
		// Select all Cycles option
		if(selectedVersion.length) {
			if(selectedVersion.hasClass('zephyr-tb-classification-all')) {
				/** Update URL **/
				selectedVersion.filter('.zephyr-tb-classification-all').addClass('zephyr-tb-selected'); // Select 'All Cycles' option
				this.getAllVersions();
			} else {
				/** Update URL **/
				selectedVersion.addClass('zephyr-tb-selected');
				this.getVersionById(ZEPHYR.Agile.TestBoard.data.versionId);
			}
			ZEPHYR.Agile.TestBoard.data.projectId = selectedVersion.data('project-id');
		} else {
			ZEPHYR.Agile.TestBoard.data.versionId = this.$el.find('.zephyr-tb-classification-all').data('version-id');
			ZEPHYR.Agile.TestBoard.data.projectId = this.$el.find('.zephyr-tb-classification-all').data('project-id');
			this.$el.find('.zephyr-tb-classification-all').addClass('zephyr-tb-selected');
			this.getAllVersions();
		}
		return this;
	}
});

ZEPHYR.Agile.TestBoard.Menu = {
	init: function() {
		this.attachClassificationMenuWrapper();
		this.attachViews();
	},
	attachClassificationMenuWrapper: function() {
		var projectCount = (ZEPHYR.Agile.TestBoard.data.projects)? ZEPHYR.Agile.TestBoard.data.projects.length: 0;
		var classificationHTML = ZEPHYR.Templates.TestBoard.classificationMenuHTML();
		AJS.$('#zephyr-tb-classification-menu-column').html(classificationHTML);
		
		if(ZEPHYR.Agile.TestBoard.data.isVersionsVisible) {
			AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId).addClass('zephyr-tb-version-expanded');
		} else {
			AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId).removeClass('zephyr-tb-version-expanded');
		}
		
		this.attachEvents();
	},
	attachEvents: function() {
		AJS.$('#zephyr-tb-classification-menu-column').find('#zephyr-tb-version-toggle').unbind('click')
			.bind('click', function(ev) {
				ev.preventDefault();
				var targetElId= AJS.$(ev.target).data('target-id');
				
				AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId).addClass('zephyr-tb-version-expanded');
				AJS.$('#' + targetElId).show();
				/** Update URL **/
				ZEPHYR.Agile.TestBoard.data.isVersionsVisible = true;
				ZEPHYR.Agile.TestBoard.Router.URL.setParams();
				ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false}); 
			});
	},
	attachViews: function() {
		// Attach versions view
		this.attachVersionsView();
	},
	attachVersionsView: function(projectId) {	
		var showProjectName = (ZEPHYR.Agile.TestBoard.data.projects.length > 1) ? true: false;

		// Attach Versions view
		this.versions = new ZEPHYR.Agile.TestBoard.VersionCollection(versionsJSON);
		var versionsJSON = this.processVersions(this.versions);
		this.versionsView = new ZEPHYR.Agile.TestBoard.VersionsView({
			model: this.versions,
			el: '#zephyr-tb-version-column',
			showProjectName: showProjectName
		});
		this.versionsView.render();
	},
	processVersions: function(versions) {
		var versionsPerProject = ZEPHYR.Agile.TestBoard.data.versionList.versionsPerProject;

		if(ZEPHYR.Agile.TestBoard.data.projects.length) {
			_.each(ZEPHYR.Agile.TestBoard.data.projects.models, function(project) {
				// Add unscheduled version
				versions.add({
					id: -1  + '-' + project.get('id'),	// Setting to null
					versionId: -1,
					name: "Sin programar",
					released: false,
					projectId: project.get('id'),
					projectKey: project.get('key'),
					projectName: project.get('name')
				});
				var versionList = _(versionsPerProject[project.id]).map(function(version, i){  
						version.versionId = version.id; // Setting this because since for unscheduled ID is -1, duplicates won't be added to collection.
						version.projectId = project.get('id'); 
						version.projectKey = project.get('key');
						version.projectName = project.get('name');
						return version;
					});
				versions.add(versionList);				
			});
		}
	}
};

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprint-board-view.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

/**
 * - Extend from Testboard View
 * - Attach the sprint board layout
 * - Attach the SprintsView
 */
ZEPHYR.Agile.TestBoard.SprintBoardView = ZEPHYR.Agile.TestBoard.TestBoardView.extend({
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'removeDOMListeners');
		ZEPHYR.Agile.TestBoard.TestBoardView.prototype.initialize.call(this);
		this.bind(ZEPHYR.Agile.TestBoard.Events.RENDER_LAYOUT_SUCCESS, this.attachSprintsView, this);
	},
	fetchSprints: function() {
		ZEPHYR.Agile.TestBoard.Loading.showLoadingIndicator();
		ZEPHYR.Agile.TestBoard.views.sprintsView.render();
		ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
	},
	attachEvents: function() {
		try {
			// Toggle list/ detail view on keypress of alphabet 'T' not 't' since JIRA Agile has already
			AJS.whenIType("T").execute(function () {
				if(ZEPHYR.Agile.TestBoard.data.isDetailView) {
					AJS.$('.zephyr-tb-detail-close').trigger('click');
				} else {
					if(ZEPHYR.Agile.TestBoard.data.selectedCycle) {
						AJS.$('.zephyr-tb-cycle-content[data-cycle-id="' + ZEPHYR.Agile.TestBoard.data.selectedCycle + '"]').click();
					}
				}
			});
		} catch(e) {
			console.log(e.message);
		}		
	},
	attachSprintsView: function() {
		this.attachEvents();
		//this.fetchSprints();
	},
	removeDOMListeners: function() {
	    this.unbind();
	    // Check for older Backbone versions which does not have this.stopListening()
	    if (typeof this.stopListening == 'function') 
	    	this.stopListening();
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprint-board.soy' */
// This file was automatically generated from zephyr-sprint-board.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ZEPHYR.Templates.TestBoard.Sprint.
 */

if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Templates == 'undefined') { ZEPHYR.Templates = {}; }
if (typeof ZEPHYR.Templates.TestBoard == 'undefined') { ZEPHYR.Templates.TestBoard = {}; }
if (typeof ZEPHYR.Templates.TestBoard.Sprint == 'undefined') { ZEPHYR.Templates.TestBoard.Sprint = {}; }


ZEPHYR.Templates.TestBoard.Sprint.sprintsHTML = function(opt_data, opt_ignored) {
  var output = '<div id="zephyr-tb-sprints-wrapper" class="zephyr-tb-sprints-wrapper zephyr-tb-border-left">';
  var sprintList4 = opt_data.sprints;
  var sprintListLen4 = sprintList4.length;
  for (var sprintIndex4 = 0; sprintIndex4 < sprintListLen4; sprintIndex4++) {
    var sprintData4 = sprintList4[sprintIndex4];
    output += '<div id="zephyr-tb-sprints-module-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-state="' + soy.$$escapeHtml(sprintData4.state) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '" class="module toggle-wrap collapsed zephyr-je-sprint-group zephyr-tb-sprints-module"><div id="sprint-module-heading" class="mod-header sprint-module-heading"><h3 class="zephyr-tb-toggle-custom aui-icon aui-icon-small zephyr-tb-toggle-header aui-iconfont-collapsed"><span class="pseudo">&</span></h3><div class="zephyr-tb-name">' + soy.$$escapeHtml(sprintData4.name) + '</div><div class="zephyr-tb-issue-count" id="zephyr-tb-cycle-count">' + soy.$$escapeHtml(sprintData4.cycleCount) + '</div>' + ((sprintData4.state == 'ACTIVE') ? '<span class="active-sprint-lozenge aui-lozenge aui-lozenge-success">Active</span>' : '') + '<a id=\'refreshId-' + soy.$$escapeHtml(sprintData4.id) + '\' class="refresh-table" title="Refresh results"><span class="aui-icon aui-icon-small aui-iconfont-build"/></a><aui-spinner class="zfj-icon-wait zephyr-tb-by-issues-sprint-wait" style="display:none"></aui-spinner><div class="zephyr-tb-controls aui-group"><div class="aui-item"><a href="#sprint-module-dropdown-' + soy.$$escapeHtml(sprintData4.id) + '" aria-owns="sprint-module-dropdown-' + soy.$$escapeHtml(sprintData4.id) + '" class="aui-button aui-style-default aui-dropdown2-trigger zephyr-je-dropdown-trigger" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '" tabindex="0"><span class="aui-icon zephyr-tb-iconfont aui-icon-small aui-iconfont-more"></span></a><div id="sprint-module-dropdown-' + soy.$$escapeHtml(sprintData4.id) + '" class="aui-style-default aui-dropdown2"><ul class="aui-list-truncate"><li id="zephyr-tb-link-test-cycles_' + soy.$$escapeHtml(sprintData4.id) + '" class="zephyr-tb-link-test-cycles"><a href="#">' + soy.$$escapeHtml('Zephyr de Enlazar Ciclo(s) de Prueba') + '</a></li></ul></div></div></div></div><div class="mod-content" id="sprint-content-container-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '"><div id="sprint-cycle-container-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '" class="sprint-cycle-container zephyr-tb-cycles js-cycle-list zephyr-tb-has-cycles"></div></div></div>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.sprintsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.sprintsHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.cyclesHTML = function(opt_data, opt_ignored) {
  var output = '';
  var cycleIdList45 = soy.$$getMapKeys(opt_data.cycles);
  var cycleIdListLen45 = cycleIdList45.length;
  for (var cycleIdIndex45 = 0; cycleIdIndex45 < cycleIdListLen45; cycleIdIndex45++) {
    var cycleIdData45 = cycleIdList45[cycleIdIndex45];
    output += '<div class="zephyr-tb-cycle-compact' + ((cycleIdIndex45 == 0) ? ' zephyr-tb-cycle-compact-first' : '') + ((cycleIdIndex45 == cycleIdListLen45 - 1) ? ' zephyr-tb-cycle-compact-last' : '') + '" data-cycle-id="' + soy.$$escapeHtml(cycleIdData45) + '">' + ((opt_data.cycles[cycleIdData45].sprintId == opt_data.sprintId) ? '<div class="zephyr-tb-cycle-content aui-group" data-cycle-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].id) + '" data-sprint-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].sprintId) + '" data-cycle-name="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '" data-version-name="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '" data-project-key="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].projectKey) + '"><div class="zephyr-tb-row aui-item"><span class="zephyr-tb-type zephyr-cycle-type" title="' + soy.$$escapeHtml(AJS.format('Ciclo',opt_data.cycles[cycleIdData45].versionId)) + '">C</span><div class="zephyr-tb-key"><a href=' + soy.$$escapeHtml(contextPath) + '/secure/enav/#?query=' + ZEPHYR.Agile.TestBoard.getCycleZQLQuery([opt_data.cycles[cycleIdData45].versionName, opt_data.cycles[cycleIdData45].name, opt_data.cycles[cycleIdData45].projectKey]) + ' title="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '" class="zephyr-tb-cycle-link js-key-link">' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '</a></div></div><div class="zephyr-tb-end zephyr-tb-row aui-item"><div class="zephyr-tb-version" title="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '"><span class="zephyr-tb-inner"><span class="aui-lozenge aui-lozenge-subtle zephyr-tb-version-lozenge">' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '</span></span></div><span class="zephyr-tb-versions-table zephyr-tb-end">' + ((opt_data.cycles[cycleIdData45].totalExecutions == 0) ? '<!--<span>' + soy.$$escapeHtml('Ninguna prueba') + '</span>-->' : ZEPHYR.Templates.TestBoard.versionProgressHTML({summaryList: opt_data.cycles[cycleIdData45].executionSummaries, totalExecutions: opt_data.cycles[cycleIdData45].totalExecutions}) + ((opt_data.cycles[cycleIdData45].totalExecutions > 0) ? '<span class="zephyr-tb-version-progress-percentage">' + soy.$$escapeHtml(Math.round(opt_data.cycles[cycleIdData45].totalExecuted * 100 / opt_data.cycles[cycleIdData45].totalExecutions * 100) / 100) + '%</span>' : '')) + '</span><span data-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].id) + '" title="' + soy.$$escapeHtml('Quitar Ciclo de Sprint') + '" data-version-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionId) + '" class="aui-icon aui-icon-small aui-iconfont-remove zephyr-tb-cycle-remove"></span></div></div>' : '');
    if (opt_data.cycles[cycleIdData45].folders) {
      var folderList106 = opt_data.cycles[cycleIdData45].folders;
      var folderListLen106 = folderList106.length;
      for (var folderIndex106 = 0; folderIndex106 < folderListLen106; folderIndex106++) {
        var folderData106 = folderList106[folderIndex106];
        output += '<div class="zephyr-tb-cycle-content aui-group" data-cycle-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].id) + '" data-sprint-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].sprintId) + '" data-folder-id="' + soy.$$escapeHtml(folderData106.folderId) + '" data-folder-name="' + soy.$$escapeHtml(folderData106.folderName) + '" data-cycle-name="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '" data-version-name="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '" data-project-key="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].projectKey) + '"><div class="zephyr-tb-row aui-item"><span class="zephyr-tb-type zephyr-folder-type" title="' + soy.$$escapeHtml(AJS.format('Carpeta',opt_data.cycles[cycleIdData45].versionId)) + '">F</span><div class="zephyr-tb-key"><a href=' + soy.$$escapeHtml(contextPath) + '/secure/enav/#?query=' + ZEPHYR.Agile.TestBoard.getFolderZQLQuery([opt_data.cycles[cycleIdData45].versionName, opt_data.cycles[cycleIdData45].name, opt_data.cycles[cycleIdData45].projectKey, folderData106.folderName]) + ' title="' + soy.$$escapeHtml(folderData106.folderName) + '" class="zephyr-tb-cycle-link js-key-link">' + soy.$$escapeHtml(folderData106.folderName) + '</a></div></div><div class="zephyr-tb-end zephyr-tb-row aui-item"><div class="zephyr-tb-version" title="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '"><span class="zephyr-tb-inner"><span class="aui-lozenge aui-lozenge-subtle zephyr-tb-version-lozenge">' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionName) + '</span></span></div><div class="zephyr-tb-version" title="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '"><span class="zephyr-tb-inner"><span class="aui-lozenge aui-lozenge-subtle zephyr-tb-version-lozenge">' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].name) + '</span></span></div><span class="zephyr-tb-versions-table zephyr-tb-end">' + ((folderData106.totalExecutions == 0) ? '<!--<span>' + soy.$$escapeHtml('Ninguna prueba') + '</span>-->' : ZEPHYR.Templates.TestBoard.versionProgressHTML({summaryList: folderData106.executionSummaries, totalExecutions: folderData106.totalExecutions}) + ((folderData106.totalExecutions > 0) ? '<span class="zephyr-tb-version-progress-percentage">' + soy.$$escapeHtml(Math.round(folderData106.totalExecuted * 100 / folderData106.totalExecutions * 100) / 100) + '%</span>' : '')) + '</span><span data-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].id) + '" title="' + soy.$$escapeHtml('Eliminar carpeta de la iteraci\xf3n') + '" data-folder-id="' + soy.$$escapeHtml(folderData106.folderId) + '" data-folder-name="' + soy.$$escapeHtml(folderData106.folderName) + '" data-version-id="' + soy.$$escapeHtml(opt_data.cycles[cycleIdData45].versionId) + '" class="aui-icon aui-icon-small aui-iconfont-remove zephyr-tb-cycle-remove"></span></div></div>';
      }
    }
    output += '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.cyclesHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.cyclesHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.cycleDetailsHTML = function(opt_data, opt_ignored) {
  return '<div id="zephyr-tb-detail-contents" class="zephyr-tb-detail-contents"><div id="zephyr-tb-detail-issue" class="zephyr-tb-detail-issue" data-cycle-id=""><div id="zephyr-tb-detail-head" class="zephyr-tb-detail-head js-issue-fields"><div class="zephyr-tb-controls"><div class="zephyr-tb-detail-close js-detailclose" title="' + soy.$$escapeHtml('Zephyr de Detalle cercano ( T )') + '"><span class="zephyr-tb--iconfont aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Zephyr de Detalle cercano ( T )') + '</span></div></div><div class="zephyr-tb-group"><span class="zephyr-tb-project-avatar"><img src="' + soy.$$escapeHtml(contextPath) + '/download/resources/com.thed.zephyr.je/images/icons/repository_24x24.png"></span><span id="zephyr-tb-js-sizer" class="zephyr-tb-sizer ui-resizable-handle ui-resizable-w" title="' + soy.$$escapeHtml('Zephyr de Cambiar Tama\xf1o de Vista Detallada') + '"><span class="zephyr-tb-icon zephyr-tb-icon-sizer"></span></span><div class="zephyr-tb-key-group"><div class="zephyr-tb-key js-view-in-jira">' + ((opt_data.folderId) ? '<span><a href=' + soy.$$escapeHtml(contextPath) + '/secure/enav/#?query=' + ZEPHYR.Agile.TestBoard.getFolderZQLQuery([opt_data.versionName, opt_data.cycleName, opt_data.projectKey, opt_data.folderName]) + ' title="' + soy.$$escapeHtml(opt_data.folderName) + '" >' + soy.$$escapeHtml(opt_data.folderName) + '</a></span>' : '<span><a href=' + soy.$$escapeHtml(contextPath) + '/secure/enav/#?query=' + ZEPHYR.Agile.TestBoard.getCycleZQLQuery([opt_data.versionName, opt_data.cycleName, opt_data.projectKey]) + ' title="' + soy.$$escapeHtml(opt_data.cycleName) + '" >' + soy.$$escapeHtml(opt_data.cycleName) + '</a></span>') + '</div></div></div></div><div class="zephyr-tb-statistic-group"><div class="zephyr-tb-detail-statistic zephyr-tb-estimate js-estimate zephyr-tb-empty"><dl class="zephyr-tb-detail-list"><dt class="zephyr-tb-detail-term zephyr-tb-detail-filter">' + soy.$$escapeHtml('Zephyr de Filtrar Por Estado') + ':</dt><dd class="zephyr-tb-detail-description"><form class="aui">' + ZEPHYR.Templates.TestBoard.Sprint.executionStatusSelectHTML(opt_data) + '</form></dd></dl></div></div><div class="zephyr-tb-detail-nav-content" id="zephyr-tb-detail-execution-section"><div id="zephyr-tb-detail-section" class="zephyr-tb-detail-section"></div><div id="execution-pagination-container"></div><div id="zephyr-tb-executions-clear-height" style="clear: both; height: 10px;"></div></div><div class="zephyr-tb-detail-nav-menu" id="zephyr-tb-detail-execution-nav-menu"></div></div></div>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.cycleDetailsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.cycleDetailsHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.executionStatusSelectHTML = function(opt_data, opt_ignored) {
  var output = '<select class="aui select aui-ss-select"  multiple="multiple" id="zephyr-tb-status-dd" style="max-width: 80%">';
  var statusList207 = opt_data.executionStatus;
  var statusListLen207 = statusList207.length;
  for (var statusIndex207 = 0; statusIndex207 < statusListLen207; statusIndex207++) {
    var statusData207 = statusList207[statusIndex207];
    output += '<option value="' + soy.$$escapeHtml(statusData207.id) + '" data-id="' + soy.$$escapeHtml(statusData207.id) + '" data-name="' + soy.$$escapeHtml(statusData207.id) + '" rel="' + soy.$$escapeHtml(statusData207.name) + '" title="' + soy.$$escapeHtml(statusData207.description) + '">' + soy.$$escapeHtml(statusData207.name) + '</option>';
  }
  output += '</select>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.executionStatusSelectHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.executionStatusSelectHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.executionDetailNavHTML = function(opt_data, opt_ignored) {
  return '<ul><li class="zephyr-tb-detail-nav-item zephyr-tb-selected"><a><span class="zephyr-tb-iconfont"><img src="' + soy.$$escapeHtml(contextPath) + '/download/resources/com.thed.zephyr.je/images/project/zephyr_feather_20x20.png"></span><b>' + soy.$$escapeHtml(opt_data.executionCount) + '</b></a></li></ul>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.executionDetailNavHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.executionDetailNavHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.executionsHTML = function(opt_data, opt_ignored) {
  var output = '<div class="zephyr-tb-container"><table class="aui" id="zephyr-tb-executions-table"><thead><tr><th id="sub-key" class="ghx-nowrap">' + soy.$$escapeHtml('ID') + '</th><th id="folder-name">' + soy.$$escapeHtml('Nombre de carpeta') + '</th><th id="sub-status" class="">' + soy.$$escapeHtml('Estado') + '</th><th id="sub-summary">' + soy.$$escapeHtml('Resumen') + '</th><th id="sub-actions">' + soy.$$escapeHtml('Defecto') + '</th><th></th></tr></thead><tbody>';
  if (opt_data.executions.length) {
    var executionList243 = opt_data.executions;
    var executionListLen243 = executionList243.length;
    for (var executionIndex243 = 0; executionIndex243 < executionListLen243; executionIndex243++) {
      var executionData243 = executionList243[executionIndex243];
      output += '<tr>';
      if (executionData243.canViewIssue) {
        output += '<td>' + ((executionData243.issueKey == 'XXXXX') ? '<span>' + soy.$$escapeHtml(executionData243.issueKey) + '</span>' : '<a href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(executionData243.issueKey) + '">' + soy.$$escapeHtml(executionData243.issueKey) + '</a>') + '</td><td>' + ((executionData243.folderName) ? '<a href="' + soy.$$escapeHtml(contextPath) + '/DisplayCycle.jspa?cycleId=' + soy.$$escapeHtml(executionData243.cycleId) + '&versionId=' + soy.$$escapeHtml(executionData243.versionId) + '&issueKey=' + soy.$$escapeHtml(executionData243.issueKey) + '&folderId=' + soy.$$escapeHtml(executionData243.folderId) + '"> ' + soy.$$escapeHtml(executionData243.folderName) + '</a>' : '') + '</td><td class="zephyr-break-word execution-status-td"><div class="field-group execution-status-container ' + soy.$$escapeHtml(executionData243.executionWorkflowStatus == 'COMPLETED' ? 'executionWorkflowStatusCompletedWhole' : '') + '"><div id="execution-status-value-schedule-' + soy.$$escapeHtml(executionData243.id) + '" class="labels exec-status-container"><dl class="zfj-editable-field"><dd id="current-execution-status-dd-schedule-' + soy.$$escapeHtml(executionData243.id) + '" class="new-session-status" style="background-color:' + soy.$$escapeHtml(executionData243.status.color) + ';" title="' + soy.$$escapeHtml(executionData243.status.name) + soy.$$escapeHtml(executionData243.status.description ? ': ' + executionData243.status.description : '') + '">' + soy.$$escapeHtml(executionData243.status.name) + '</dd><a id="executionStatus-labels-schedule-' + soy.$$escapeHtml(executionData243.id) + '" href="#" class="zfj-overlay-icon icon icon-edit-sml"><span rel="' + soy.$$escapeHtml(executionData243.status.id) + '">' + soy.$$escapeHtml(executionData243.status.name) + '</span></a></dl></div><div id="execution-field-select-schedule-' + soy.$$escapeHtml(executionData243.id) + '" style="display: none; "><select id="exec_status-schedule-' + soy.$$escapeHtml(executionData243.id) + '" class="select" style="height:auto; max-height: 200px; width:150px; z-index:10;" size="4">';
        var execList301 = opt_data.executionStatusList;
        var execListLen301 = execList301.length;
        for (var execIndex301 = 0; execIndex301 < execListLen301; execIndex301++) {
          var execData301 = execList301[execIndex301];
          output += (execData301.id == executionData243.status.id) ? '<option value="' + soy.$$escapeHtml(execData301.id) + '" selected="selected" rel="' + soy.$$escapeHtml(execData301.color) + '" title="' + soy.$$escapeHtml(execData301.description) + '">' + soy.$$escapeHtml(execData301.name) + '</option>' : '<option value="' + soy.$$escapeHtml(execData301.id) + '" rel="' + soy.$$escapeHtml(execData301.color) + '" title="' + soy.$$escapeHtml(execData301.description) + '">' + soy.$$escapeHtml(execData301.name) + '</option>';
        }
        output += '</select></div></div></td><td class="zephyr-break-word"><a href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(executionData243.issueKey) + '" title="' + soy.$$escapeHtml(executionData243.issueKey) + ' - ' + soy.$$escapeHtml(executionData243.issueSummary) + '">' + soy.$$escapeHtml(executionData243.issueSummary) + '</a></td><td class="zephyr-break-word">' + ((executionData243.totalDefectCount > 0) ? '<div class="zfj-defect-hover" data-issueKey="' + soy.$$escapeHtml(executionData243.issueKey) + '" data-executionId="' + soy.$$escapeHtml(executionData243.id) + '" data-color="' + soy.$$escapeHtml(executionData243.status.color) + '"><span class="aui-lozenge aui-lozenge-defects">' + soy.$$escapeHtml(executionData243.executionDefectCount) + ' | ' + soy.$$escapeHtml(executionData243.stepDefectCount) + '</span>' : '') + ZEPHYR.Templates.TestBoard.defectColumnValue({defects: executionData243.executionDefects}) + ((executionData243.defects) ? '</div>' : '') + '</td><td><button id="zephyr-td-detail-execute-test" class="aui-button zephyr-td-detail-execute-test" title="' + soy.$$escapeHtml('Zephyr de Ejecutar Test') + '" data-index="' + soy.$$escapeHtml(executionIndex243) + '" data-href="' + soy.$$escapeHtml(contextPath) + '/secure/enav/#' + soy.$$escapeHtml(executionData243.id) + '?query=">E</a></button></td>';
      } else {
        output += '<td colspan=\'15\' style="text-align:center;vertical-align:middle" class="new-session-status">No Permission on Test/Issue (' + soy.$$escapeHtml(executionData243.issueKey) + ')</td>';
      }
      output += '</tr>';
    }
  } else {
    output += '<tr><td colspan="4">' + soy.$$escapeHtml('No se han encontrado pruebas que coincidan con la solicitud.') + '</td></tr>';
  }
  output += '</tbody></table></div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.executionsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.executionsHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesHTML = function(opt_data, opt_ignored) {
  var output = '<div class="zephyr-tb-eval-lic"></div><form class="aui"><div id="zephyr-tb-module"><div class="field-group"><label for="zephyr-tb-link-tests-project-select">' + soy.$$escapeHtml('Seleccionar Proyecto') + '</label><select id="zephyr-tb-link-tests-project-select" class="select">';
  if (opt_data.projects && opt_data.projects.length != 0) {
    var projectList379 = opt_data.projects;
    var projectListLen379 = projectList379.length;
    for (var projectIndex379 = 0; projectIndex379 < projectListLen379; projectIndex379++) {
      var projectData379 = projectList379[projectIndex379];
      output += '<option value="' + soy.$$escapeHtml(projectData379.id) + '"' + ((opt_data.selectedProjectId == projectData379.id) ? ' selected=selected' : '') + '>' + soy.$$escapeHtml(projectData379.name) + '</option>';
    }
  }
  output += '</select></div><br/><div class="field-group"><label for="zephyr-tb-link-tests-version-select">' + soy.$$escapeHtml('Zephyr de Seleccionar Versi\xf3n') + '</label><select id="zephyr-tb-link-tests-version-select" class="select"></select></div><br/><div class="field-group"><label for="zephyr-tb-link-tests-cycle-select">' + soy.$$escapeHtml('Seleccionar Ciclo de Prueba') + '</label><select id="zephyr-tb-link-tests-cycle-select" class="select"></select></div><br/><div class="field-group"><label for="zephyr-tb-link-tests-cycle-select">' + soy.$$escapeHtml('Seleccionar carpeta del ciclo') + '</label><select id="zephyr-tb-link-tests-folder-select" class="select"></select></div></div></div></form>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesCheckboxHTML = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" id="zephyr-tb-add-more-cycle" class="zephyr-tb-add-more-cycle" ' + ((opt_data.isLinked) ? 'checked="checked"' : '') + '><label title="' + soy.$$escapeHtml('Enlazar a m\xe1s de Ciclo(s) de Prueba') + '" for="zephyr-tb-add-more-cycle">&nbsp;&nbsp;' + soy.$$escapeHtml('Enlazar a m\xe1s de Ciclo(s) de Prueba') + '&nbsp;&nbsp;</label></span>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesCheckboxHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesCheckboxHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesConfirmationHTML = function(opt_data, opt_ignored) {
  return '<div class="zephyr-tb-eval-lic-confirm"></div><form class="aui"><div class="form-body"><div id="cycle-aui-message-bar"><div class="aui-message warning" id=""><span class="aui-icon icon-warning"></span>' + ((opt_data.folderId) ? soy.$$escapeHtml(AJS.format('La carpeta {0} se mover\xe1 del Sprint {1} al {2}.',opt_data.name,opt_data.sprintName,opt_data.selectedSprintName)) : soy.$$escapeHtml(AJS.format('El Ciclo {0} ser\xe1 movido del Sprint {1} al {2}.',opt_data.name,opt_data.sprintName,opt_data.selectedSprintName))) + '</div></div><label for="unresolved-ignore" id="unresolved-ignore-label">' + soy.$$escapeHtml('\xbfEst\xe1 seguro de que desea continuar?') + '</label></div></form>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesConfirmationHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesConfirmationHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.removeCycleFromSprintHTML = function(opt_data, opt_ignored) {
  return '<div class="zephyr-tb-eval-lic"></div><form class="aui"><div class="form-body"><div id="cycle-aui-message-bar"><div class="aui-message warning" id=""><span class="aui-icon icon-warning"></span>' + soy.$$escapeHtml(AJS.format('El ciclo {0} ser\xe1 quitado del Sprint {1}.',opt_data.cycleName,opt_data.sprintName)) + '</div></div><label for="unresolved-ignore" id="unresolved-ignore-label">' + soy.$$escapeHtml('\xbfEst\xe1 seguro de que desea continuar?') + '</label></div></form>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.removeCycleFromSprintHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.removeCycleFromSprintHTML';
}


ZEPHYR.Templates.TestBoard.Sprint.removeFolderFromSprintHTML = function(opt_data, opt_ignored) {
  return '<div class="zephyr-tb-eval-lic"></div><form class="aui"><div class="form-body"><div id="cycle-aui-message-bar"><div class="aui-message warning" id=""><span class="aui-icon icon-warning"></span>' + soy.$$escapeHtml(AJS.format('La carpeta {0} se eliminar\xe1 de la iteraci\xf3n{1}.',opt_data.folderName,opt_data.sprintName)) + '</div></div><label for="unresolved-ignore" id="unresolved-ignore-label">' + soy.$$escapeHtml('\xbfEst\xe1 seguro de que desea continuar?') + '</label></div></form>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Sprint.removeFolderFromSprintHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Sprint.removeFolderFromSprintHTML';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/issues/zephyr-issues-board-view.js' */
/**
 * Zephyr Test Board Issues
 * IssuesBoardView
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
if (typeof ZEPHYR.Agile.TestBoard.Issues == 'undefined') { ZEPHYR.Agile.TestBoard.Issues = {}; }

/**
 * - Extend from Testboard View
 * - Attach the issues board layout
 * - Attach the SprintsView
 */
ZEPHYR.Agile.TestBoard.IssuesBoardView = ZEPHYR.Agile.TestBoard.TestBoardView.extend({
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'removeDOMListeners');
		ZEPHYR.Agile.TestBoard.TestBoardView.prototype.initialize.call(this);
		this.bind(ZEPHYR.Agile.TestBoard.Events.RENDER_LAYOUT_SUCCESS, this.attachSprintsView, this);
	},
	attachSprintsView: function() {
		// Sprints View
	    ZEPHYR.Agile.TestBoard.views.sprintsView = new ZEPHYR.Agile.TestBoard.Issues.SprintsView({
	        el: '#zephyr-tb-sprints-column',
	        model: ZEPHYR.Agile.TestBoard.data.sprints
	    });
	    ZEPHYR.Agile.TestBoard.views.sprintsView.render();
		// Displaying the defects on default position
	    ZEPHYR.defectHover.INLINE_DIALOG_OPTIONS.gravity = undefined;
	},
	removeDOMListeners: function() {
	    this.unbind();
	    // Check for older Backbone versions which does not have this.stopListening()
	    if (typeof this.stopListening == 'function') 
	    	this.stopListening();
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/issues/zephyr-issues-view.js' */
/**
 * Zephyr Test Board View
 * 
 * Issues view 
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
if (typeof ZEPHYR.Agile.TestBoard.Issues == 'undefined') { ZEPHYR.Agile.TestBoard.Issues = {}; }

ZEPHYR.Agile.TestBoard.Issues.ACTION_EXPAND = 'expand';
ZEPHYR.Agile.TestBoard.Issues.ACTION_COLLAPSE = 'collapse';
ZEPHYR.Agile.TestBoard.Issues.ClassNames = {
	ACTION_ICON_EXPANDED: 'aui-iconfont-expanded',
	ACTION_ICON_COLLAPSED: 'aui-iconfont-collapsed',
	ACTION_ISSUES_EXPANDED: 'zephyr-tb-issues-expanded'
}

// Issues
ZEPHYR.Agile.TestBoard.Issue = Backbone.Model.extend();
ZEPHYR.Agile.TestBoard.IssueCollection = Backbone.Collection.extend({
	model: ZEPHYR.Agile.TestBoard.Issue
});

/**
 * - show/hide execution details
 * - Toggle between show/hide issues [remember in API]
 * - Show expand only if executions for that issue exists
 */
ZEPHYR.Agile.TestBoard.Issues.SprintIssueView = Backbone.View.extend({
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'toggleExecutions');
		this.issueId = this.model.get('id');
		this.sprintId = options.sprintId;
		this.attachEvents();
		ZEPHYR.Agile.TestBoard.globalDispatcher.off(ZEPHYR.Agile.TestBoard.Events.ISSUE_PROGRESS_BAR_UPDATE + '_' + this.issueId);
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.ISSUE_PROGRESS_BAR_UPDATE + '_' + this.issueId, this.updateExecutionSummaryDetails, this);
	},
	updateExecutionSummaryDetails: function(executionId) {
		var instance = this,
			updatedExecutionId = parseInt(executionId);
		this.fetchIssuesBySprintAndIds(function(response) {
			if(!response.successful)
				return;
			var issueSummaries = response.successful[instance.issueId];
			if(issueSummaries) {
				instance.model.set(issueSummaries);
				var versionProgressHTML = ZEPHYR.Templates.TestBoard.versionProgressHTML({
					summaryList: instance.model.get('executionSummaries'),
					totalExecutions: instance.model.get('totalExecutions')
				}),
				versionProgressPercentageHTML = ((instance.model.get('totalExecuted')*100)/instance.model.get('totalExecutions')).toFixed(2);
				instance.$el.find('span.zephyr-tb-versions-table').html(versionProgressHTML)
					.append('<span class="zephyr-tb-version-progress-percentage">' + versionProgressPercentageHTML + '%</span>');
				/*
				 * If the issue is expanded and the issue contains the execution then re-fetch the executions
				 */
				if(instance.model.get('action')) {
					_.each(instance.$el.find('#zephyr-tb-executions-table .zephyr-tb-sprint-issue-execution'), function(sprintIssueEl) {
						var _executionId = AJS.$(sprintIssueEl).attr('data-execution-id');
						// Fetch the updated executions
						if(_executionId == updatedExecutionId) 
							instance.executionView.fetchExecutions();
					});	
				}
			}
		});
	},

	fetchIssuesBySprintAndIds: function(sucessCallback) {
		var instance = this;
			
		AJS.$.ajax({
			url: getRestURL() + "/execution/executionSummariesBySprintAndIssue",
			type : 'POST',
    		contentType: "application/json",
			data: JSON.stringify({
				sprintId: this.sprintId,
				issueIdOrKeys: this.issueId
			}),
			timeout: 0,
			success: function(response) {
				sucessCallback(response);
			},
			error: function(response) {
				AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000, notFadeMessage);
			}
		});
	},
	attachViews: function(action) {
		var issueId = this.model.get('id');
		// Attach Executions view
		if(!this.executions) {
			this.executions = new ZEPHYR.Agile.TestBoard.ExecutionCollection();
		}
		if(!this.executionView) {
			this.executionView = new ZEPHYR.Agile.TestBoard.Issues.ExecutionsView({
				el : '#zephyr-tb-issue-execution-container-' + issueId,
				model : this.executions,
				issueId: issueId
			});
		}
		this.executionView.action = action;
		return this;
	},
	attachEvents: function() {
		var action = this.model.get('action'),
			issueId = this.model.get('id'),
			totalExecutions = this.model.get('totalExecutions');
		// Attach header toggle event to show/hide executions
		this.$el.find('.zephyr-tb-toggle-header').unbind('click')
			.bind('click', this.toggleExecutions);
		
		// If action is expand, display the executions
		if(action == ZEPHYR.Agile.TestBoard.Issues.ACTION_EXPAND && totalExecutions > 0) {
			var targetEl = '#zephyr-tb-toggle-header-' + issueId;
			this.updateExecutionExpandAction(targetEl);
			this.executionView.fetchExecutions();
		}
	},
	updateExecutionExpandAction: function(targetEl) {
		AJS.$(targetEl).removeClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ICON_COLLAPSED)
			.addClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ICON_EXPANDED);
		this.$el.addClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ISSUES_EXPANDED);
		this.model.set('action', ZEPHYR.Agile.TestBoard.Issues.ACTION_EXPAND);
		this.attachViews(ZEPHYR.Agile.TestBoard.Issues.ACTION_EXPAND);
	},
	updateExecutionCollapseAction: function(targetEl) {
		var issueId = this.model.get('id');
		
		AJS.$(targetEl).removeClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ICON_EXPANDED)
			.addClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ICON_COLLAPSED);
		this.$el.removeClass(ZEPHYR.Agile.TestBoard.Issues.ClassNames.ACTION_ISSUES_EXPANDED);
		AJS.$('#issue-execution-pagination-container-' + issueId).html('');
		this.model.set('action', ZEPHYR.Agile.TestBoard.Issues.ACTION_COLLAPSE);
		this.attachViews(ZEPHYR.Agile.TestBoard.Issues.ACTION_COLLAPSE);
	},
	toggleExecutions: function(ev) {
		var isCollapsed = AJS.$(ev.target).hasClass('aui-iconfont-collapsed');
		
		if(isCollapsed) {
			this.updateExecutionExpandAction(ev.target);
		} else {
			this.updateExecutionCollapseAction(ev.target);
		}
		this.executionView.fetchExecutions();
	}
});

/**
 * - Display the issues per sprint
 * - Map the JIRA issues data to our execution data 
 */
ZEPHYR.Agile.TestBoard.Issues.SprintIssuesView = Backbone.View.extend({
	initialize : function(options) {
		this.model.bind('reset', this.render, this);
		this.sprintId = options.sprintId;
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.ISSUES_FILTER, this.filterIssues, this);
	},
	/**
	 * Filter issues by issue key / summary
	 */
	filterIssues: function(issueInput) {
		issueInput = (issueInput)? issueInput.toString().toLowerCase(): '';
		var issues = this.model.filter(function(issue) {
				var key = issue.get("key").toLowerCase();
				var summary = issue.get("summary").toLowerCase();
				return (key.indexOf(issueInput) > -1 || summary.indexOf(issueInput) > -1);
			}).map(function(issue) {
				return issue.attributes;
			});
		this.displayIssues(issues);
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.ISSUES_COUNT_UPDATE + '_' + this.sprintId, issues.length);
	},
	attachIssueView : function() {
		var instance = this;
		// Attach issue View
		_.each(this.$el.find('.zephyr-tb-issue-compact'), function(issueEl) {
			var issueId = AJS.$(issueEl).data('issue-id');
			var issue = instance.model.get(issueId);
			if (issue) {
				var sprintIssueView = new ZEPHYR.Agile.TestBoard.Issues.SprintIssueView({
					el : issueEl,
					model : issue,
					sprintId: instance.sprintId
				});
			}
		});
	},
	displayIssues: function(issues) {
		var issuesHTML = ZEPHYR.Templates.TestBoard.Issues.issuesHTML({
			issues: issues
		});
		this.$el.html(issuesHTML);
		this.attachIssueView();
	},
	render : function() {
		var issues = this.model.toJSON();
		this.displayIssues(issues);
		ZEPHYR.Agile.TestBoard.updateContentAreaHeight();
		ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
		return this;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/issues/zephyr-issues-sprints.js' */
/**
 * Zephyr Test Board Issues - Sprints
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
if (typeof ZEPHYR.Agile.TestBoard.Issues == 'undefined') { ZEPHYR.Agile.TestBoard.Issues = {}; }

/**
 * - show/hide issues
 */
ZEPHYR.Agile.TestBoard.Issues.SprintView = Backbone.View.extend({
	initialize : function() {
		this.attachViews();
		this.sprintId = this.model.get('id');
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.ISSUES_COUNT_UPDATE + '_'+ this.sprintId, this.displayIssuesCount, this);
		this.selectedCycleIds = [];
	},
	displayIssuesCount : function(issueCount) {
		var issueCountHTML;

		if (issueCount < this.issueCount) {
			issueCountHTML = AJS.format("{0} de {1} de problemas visibles", issueCount, this.issueCount);
		} else {
			issueCountHTML = AJS.format("{0} de problemas", issueCount);
		}
		this.$el.find('#zephyr-tb-issues-count').html(issueCountHTML);
	},
	attachViews : function() {
		var sprintId = this.model.get('id');
		var instance = this;
		
		// Get issues 
		this.setIssuesByIds();
		// Issues View
		this.issueView = new ZEPHYR.Agile.TestBoard.Issues.SprintIssuesView({
			el: '#sprint-issues-container-' + sprintId,
			model: this.model.issues,
			sprintId: sprintId,
			sprintName: this.model.get('name')
		});
		this.issueCount = this.model.issues.length;
		if(this.issueCount) {
			this.fetchIssuesBySprintAndIds();
		}
		return this;
	},
	getIssueIds: function() {
		var issueIds = this.model.get('issuesIds');
		
		return issueIds.toString();
	},
	fetchIssuesBySprintAndIds: function() {
		var sprintId = this.model.get('id'),
			issueIds = this.getIssueIds(),
			instance = this;
		
		this.$el.find('.zephyr-tb-by-issues-sprint-wait').removeAttr('title');
		this.$el.find('.zephyr-tb-by-issues-sprint-wait').show();	
		// After 60 seconds on hover of the spinning wheel show message
		setTimeout(function() {
			instance.$el.find('.zephyr-tb-by-issues-sprint-wait').attr('title', "Esta operaci\u00f3n est\u00e1 tomando m\u00e1s de lo esperado.");
		}, 6000);
		AJS.$.ajax({
			url: getRestURL() + "/execution/executionSummariesBySprintAndIssue",
			type : 'POST',
    		contentType: "application/json",
			data: JSON.stringify({
				sprintId: sprintId,
				issueIdOrKeys: issueIds
			}),
			timeout: 0,
			success: function(response) {
				instance.setIssueSatus(response);
				instance.issueView.render();
				instance.$el.find('.zephyr-tb-by-issues-sprint-wait').hide();
			},
			error: function(response) {
				instance.$el.find('.zephyr-tb-by-issues-sprint-wait').hide();
				var responseJSON = JSON.parse(response.responseText);
				if(response.status == 403 && responseJSON.PERM_DENIED) {
					AJS.$('.zfj-permission-test-view').addClass('active');
					showPermissionError(response);
					AJS.$('.zfj-permission-test-view').removeClass('active');
					instance.issueView.render();
					return;
				}
				if(!ZEPHYR.globalVars.unloaded) {
					AJS.$('.zephyr-tb-message-bar').html('');
					var responseText = responseJSON.message || responseJSON.errorDescHtml || responseJSON.PERM_DENIED;
					ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
				}
			}
		});
	},
	setIssueSatus: function(response) {
		if(!response.successful)
			return;
		// Parse the response and set it in the execution status in each issue model
		var statusList = response.successful;
		
		_.each(statusList, function(statusJSON, issueId) {
			var issue = this.model.issues.get(issueId); 
			if(issue) {
				issue.set(statusJSON);
			}
		}, this);
		return this;
	},
	setIssuesByIds: function() {
		var issueIds = this.model.get('issuesIds');
		
		this.model.issues.reset([]);
		_.each(issueIds, function(issueId) {
			var issue = ZEPHYR.Agile.TestBoard.data.issues.get(issueId); 
			this.model.issues.add(issue);
		}, this);
	}
});

/**
 * - SprintView - show Sprint details with list of Issues
 */
ZEPHYR.Agile.TestBoard.Issues.SprintsView = Backbone.View.extend({
	events : {
		'click .zephyr-tb-cycle-content' : 'displayCycleDetails'
	},
	initialize : function() {
		this.model.bind('reset', this.render, this);
		this.sprintRows = [];
	},
	attachSprintView : function() {
		var instance = this;
		// TODO: cleanup previous views
		// Attach Sprint View
		_.each(this.$el.find('.zephyr-tb-sprints-module'), function(sprintEl) {
			var sprintId = AJS.$(sprintEl).data('sprint-id');
			var sprintSelector = AJS.$("#zephyr-tb-sprints-module-"+sprintId);
			var sprintState = AJS.$(sprintEl).data('sprint-state');
			sprintSelector.find(".sprint-module-heading").off("click.issues").on("click.issues", function(e, data) {
				if(AJS.$(e.target).closest(".refresh-table").length) return;
				if(!sprintSelector.hasClass("dataLoaded")) {
					var sprint = instance.model.get(sprintId);
					if (sprint) {
						var sprintView = new ZEPHYR.Agile.TestBoard.Issues.SprintView({
							el : sprintEl,
							model : sprint
						});
						instance.sprintRows.push(sprintView);
					}
					sprintSelector.addClass("dataLoaded");
				}
				
				if(data && data.forcedTrigger) {
					return;
				}

				if(!AJS.$(e.target).hasClass("zephyr-tb-toggle-custom")) {
					if(sprintSelector.hasClass("expanded")) {
						sprintSelector.addClass("collapsed").removeClass("expanded");
						sprintSelector.find(".zephyr-tb-toggle-custom").addClass("aui-iconfont-collapsed").removeClass("aui-iconfont-expanded");
					} else {
						sprintSelector.removeClass("collapsed").addClass("expanded");
						sprintSelector.find(".zephyr-tb-toggle-custom").removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded");
					}
				} else {
					if(sprintSelector.hasClass("expanded")) {
						sprintSelector.find(".zephyr-tb-toggle-custom").addClass("aui-iconfont-collapsed").removeClass("aui-iconfont-expanded");
					} else {
						sprintSelector.find(".zephyr-tb-toggle-custom").removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded");
					}
				}
			});

			AJS.$("#refreshId-"+sprintId).off("click.refresh").on("click.refresh", function(e) {
				var sprint = instance.model.get(sprintId);
				if (sprint) {
					var sprintView = new ZEPHYR.Agile.TestBoard.Issues.SprintView({
						el : sprintEl,
						model : sprint
					});
					instance.sprintRows.push(sprintView);
				}
				sprintSelector.addClass("dataLoaded");
			});

			if(sprintState == "ACTIVE") {
				sprintSelector.find(".sprint-module-heading").trigger("click");  // defaultopen active sprint
			}
		});
	},
	render : function() {
		var sprints = this.model.toJSON();
		var sprintsHTML = ZEPHYR.Templates.TestBoard.Issues.sprintsHTML({
			sprints : sprints
		});
		this.$el.html(sprintsHTML);
		this.attachSprintView();
		ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
		return this;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/issues/zephyr-issues-executions.js' */
/**
 * Zephyr Test Board View
 * Execution views
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
if (typeof ZEPHYR.Agile.TestBoard.Issues == 'undefined') { ZEPHYR.Agile.TestBoard.Issues = {}; }

/**
 * - Show hide executions
 */
ZEPHYR.Agile.TestBoard.Issues.ExecutionsView = Backbone.View.extend({
	events: {
		'click .zephyr-td-detail-execute-test': 'navigateToExecuteTest'
	},
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'getExecutionsBasedOnStatusUpdate');
		this.offset = 0;
		this.issueId = options.issueId;
		this.attachViews();
		ZEPHYR.Agile.TestBoard.globalDispatcher.off(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET + '_' + this.issueId);
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET + '_' + this.issueId, this.getExecutionsBasedOnOffset, this);
		jQuery(document).off("ScheduleUpdated");
		jQuery(document).on("ScheduleUpdated", this.getExecutionsBasedOnStatusUpdate);
	},
	getExecutionsBasedOnOffset: function(offset) {
		this.offset = offset;
		this.fetchExecutions();
	},
	getExecutionsBasedOnStatusUpdate: function(ev, executionId) {
		// Loop through all the issues that are containing the version progress bar
		_.each(AJS.$('.zephyr-tb-issue-compact'), function(sprintIssueEl) {
			if(AJS.$(sprintIssueEl).find('span.zephyr-tb-versions-table')) {
				var issueId = AJS.$(sprintIssueEl).attr('data-issue-id');
				// trigger call to update issue execution status progress bar and issue status
				ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.ISSUE_PROGRESS_BAR_UPDATE + '_' + issueId, executionId);
			}
		});
	},
	navigateToExecuteTest: function(ev) {
		ev.preventDefault();
		var targetEl = AJS.$(ev.target),
			index = targetEl.data('index'),
			elHref = targetEl.data('href');

		window.location.href = elHref;
	},
	attachViews: function() {
		// Attach Execution Pagination
		this.executionPaginationView = new ZEPHYR.Agile.TestBoard.ExecutionPaginationView({
			el: '#issue-execution-pagination-container-' + this.issueId,
			model: this.model,
			eventId: this.issueId
		});
	},
	getExecutionDataParams: function(offset) {
		var dataParams = {
			"issueIdOrKey": this.issueId,
			"offset": offset,
			"maxRecords": 10,
			"expand": "executionStatus",
			"action": this.action
		}
		return dataParams;
	},
	fetchExecutions: function() {
		var instance = this,
			dataParams = this.getExecutionDataParams(this.offset);

		ZEPHYR.Agile.TestBoard.Loading.showLoadingIndicator();
		this.model.fetch({
			reset: true,
			data: dataParams,
			timeout: 0, // Removing the timeout
			success: function(executions, response) {
				if(instance.action == 'expand') {
					instance.render();
					if(response.executionSummaries) {
						AJS.$('#issueBoard-defectCount-' + instance.issueId).html(ZEPHYR.Templates.TestBoard.Issues.defectCountHTML({
							totalDefectCount: response.totalDefectCount,
							totalOpenDefectCount: response.totalOpenDefectCount
						}));
						AJS.$('#issueBoard-progressBar-' + instance.issueId).html(ZEPHYR.Templates.TestBoard.versionProgressHTML({
							summaryList: JSON.parse(response.executionSummaries),
							totalExecutions: response.totalExecutions
						}));
						AJS.$('#issueBoard-progressBar-' + instance.issueId).append('<span totalExecuted='+ response.totalExecuted +' totalExecutions='+ response.totalExecutions +' class="zephyr-tb-version-progress-percentage">' + ((response.totalExecuted*100/response.totalExecutions).toFixed(2)) + '%</span>')
					} else {
						AJS.$('#issueBoard-defectCount-' + instance.issueId).html('');
						AJS.$('#issueBoard-progressBar-' + instance.issueId).html('');
					}

				}
				else {
					instance.$el.html('');
					AJS.$('#issue-execution-pagination-container-' + instance.issueId).html('');
				}
				ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
			},
			error: function(executions, response) {
				ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
				AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.error[0] ||responseJSON.message || responseJSON.errorDescHtml;
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
			}
		});
	},
	render: function() {
		var executionStatus = this.model.executionStatus,
			executions = this.model.toJSON() || [];
			executions.forEach(function(cycle){
				cycle.cycleName = cycle.cycleName || '';
				cycle.folderName = cycle.folderName || '';
			});
		var	executionsHTML = ZEPHYR.Templates.TestBoard.Issues.executionsHTML({
				executions: executions,
				executionStatusList: executionStatus,
				issueId: this.issueId
			});
		this.$el.html(executionsHTML);
		// Create editable view for status field.
		var editableFields = AJS.$('#zephyr-tb-executions-table div.field-group.execution-status-container');
		AJS.$.each(editableFields, function(i, $container) {
			var executionStatusView = new ZEPHYR.Schedule.executionStatusView({
				el: 			$container,
				elBeforeEdit:	AJS.$($container).find('[id^=execution-status-value-schedule]'),
				elOnEdit:		AJS.$($container).find('[id^=execution-field-select-schedule]')
			});
		});
		return this;
	}
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/issues/zephyr-issues-board.soy' */
// This file was automatically generated from zephyr-issues-board.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ZEPHYR.Templates.TestBoard.Issues.
 */

if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Templates == 'undefined') { ZEPHYR.Templates = {}; }
if (typeof ZEPHYR.Templates.TestBoard == 'undefined') { ZEPHYR.Templates.TestBoard = {}; }
if (typeof ZEPHYR.Templates.TestBoard.Issues == 'undefined') { ZEPHYR.Templates.TestBoard.Issues = {}; }


ZEPHYR.Templates.TestBoard.Issues.sprintsHTML = function(opt_data, opt_ignored) {
  var output = '<div id="zephyr-tb-sprints-wrapper" class="zephyr-tb-sprints-wrapper">';
  var sprintList4 = opt_data.sprints;
  var sprintListLen4 = sprintList4.length;
  for (var sprintIndex4 = 0; sprintIndex4 < sprintListLen4; sprintIndex4++) {
    var sprintData4 = sprintList4[sprintIndex4];
    output += '<div id="zephyr-tb-sprints-module-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-state="' + soy.$$escapeHtml(sprintData4.state) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '" class="module toggle-wrap collapsed zephyr-je-sprint-group zephyr-tb-sprints-module"><div id="sprint-module-heading" class="mod-header sprint-module-heading"><h3 class="zephyr-tb-toggle-custom aui-icon aui-icon-small zephyr-tb-toggle-header aui-iconfont-collapsed"><span class="pseudo">&</span></h3><div class="zephyr-tb-name">' + soy.$$escapeHtml(sprintData4.name) + '</div><div class="zephyr-tb-issue-count" id="zephyr-tb-issues-count">' + soy.$$escapeHtml(AJS.format('{0} de problemas',sprintData4.issuesIds.length)) + '</div>' + ((sprintData4.state == 'ACTIVE') ? '<span class="active-sprint-lozenge aui-lozenge aui-lozenge-success">Active</span>' : '') + '<a id=\'refreshId-' + soy.$$escapeHtml(sprintData4.id) + '\' class="refresh-table" title="Refresh results"><span class="aui-icon aui-icon-small aui-iconfont-build"/></a><aui-spinner class="zfj-icon-wait zephyr-tb-by-issues-sprint-wait" style="display:none"></aui-spinner></div><div class="mod-content" id="sprint-content-container-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '"><div id="sprint-issues-container-' + soy.$$escapeHtml(sprintData4.id) + '" data-sprint-id="' + soy.$$escapeHtml(sprintData4.id) + '" class="sprint-issues-container zephyr-tb-issues js-issue-list"></div></div></div>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Issues.sprintsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Issues.sprintsHTML';
}


ZEPHYR.Templates.TestBoard.Issues.issuesHTML = function(opt_data, opt_ignored) {
  var output = '<div id="zephyr-tb-issues-wrapper" class="zephyr-tb-issues-wrapper">';
  var issueList34 = opt_data.issues;
  var issueListLen34 = issueList34.length;
  for (var issueIndex34 = 0; issueIndex34 < issueListLen34; issueIndex34++) {
    var issueData34 = issueList34[issueIndex34];
    output += '<div class="js-issue zephyr-tb-issue-compact aui-group" data-issue-id="' + soy.$$escapeHtml(issueData34.id) + '" data-issue-key="' + soy.$$escapeHtml(issueData34.key) + '"><div class="zephyr-tb-issue-content"><div class="zephyr-tb-row aui-item">' + ((issueData34.totalExecutions > 0) ? '<span id="zephyr-tb-toggle-header-' + soy.$$escapeHtml(issueData34.id) + '" data-issue-id="' + soy.$$escapeHtml(issueData34.id) + '" class="aui-icon aui-icon-small aui-iconfont-collapsed zephyr-tb-toggle-header"></span>' : '') + '<span class="zephyr-tb-type" title="' + soy.$$escapeHtml(issueData34.typeName) + '"><img src="' + soy.$$escapeHtml(issueData34.typeUrl) + '"></span><div class="zephyr-tb-flags"><span class="zephyr-tb-priority" title="' + soy.$$escapeHtml(issueData34.priorityName) + '"><img src="' + soy.$$escapeHtml(issueData34.priorityUrl) + '"></span></div><div class="zephyr-tb-key ' + ((issueData34.done) ? ' zephyr-tb-line-through ' : '') + '"><a href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(issueData34.key) + '" title="' + soy.$$escapeHtml(issueData34.key) + '" class="js-key-link">' + soy.$$escapeHtml(issueData34.key) + '</a></div><div class="zephyr-tb-summary" title="' + soy.$$escapeHtml(issueData34.summary) + '"><span class="zephyr-tb-inner">' + soy.$$escapeHtml(issueData34.summary) + '</span></div></div></div><div class="zephyr-tb-end zephyr-tb-row aui-item">' + ((issueData34.totalExecutions > 0) ? '<div class="zephyr-tb-status"><span id="issueBoard-defectCount-' + soy.$$escapeHtml(issueData34.id) + '" class="zephyr-tb-inner zephyr-tb-defect-hover-wrapper">' + ZEPHYR.Templates.TestBoard.Issues.defectCountHTML({totalDefectCount: issueData34.totalDefectCount, totalOpenDefectCount: issueData34.totalOpenDefectCount}) + '</span></div><span id="issueBoard-progressBar-' + soy.$$escapeHtml(issueData34.id) + '" class="zephyr-tb-versions-table zephyr-tb-end">' + ZEPHYR.Templates.TestBoard.versionProgressHTML({summaryList: issueData34.executionSummaries, totalExecutions: issueData34.totalExecutions}) + '<span class="zephyr-tb-version-progress-percentage" totalExecuted=' + soy.$$escapeHtml(issueData34.totalExecuted) + ' totalExecutions=' + soy.$$escapeHtml(issueData34.totalExecutions) + '>' + soy.$$escapeHtml(Math.round(issueData34.totalExecuted * 100 / issueData34.totalExecutions * 100) / 100) + '%</span></span>' : '') + '</div><div class="zephyr-tb-issue-content-container" id="zephyr-tb-issue-content-container-' + soy.$$escapeHtml(issueData34.id) + '" data-issue-id="' + soy.$$escapeHtml(issueData34.id) + '"><div id="zephyr-tb-issue-execution-container-' + soy.$$escapeHtml(issueData34.id) + '" data-issue-id="' + soy.$$escapeHtml(issueData34.id) + '" class="zephyr-tb-issue-execution-container zephyr-tb-issue-executions js-execution-list"></div><div id="issue-execution-pagination-container-' + soy.$$escapeHtml(issueData34.id) + '" class="issue-execution-pagination-container"></div></div></div>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Issues.issuesHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Issues.issuesHTML';
}


ZEPHYR.Templates.TestBoard.Issues.executionsHTML = function(opt_data, opt_ignored) {
  var output = '<div class="zephyr-tb-container"><table class="aui aui-table-rowhover" id="zephyr-tb-executions-table"><thead><tr><th id="sub-key" class="ghx-nowrap">' + soy.$$escapeHtml('ID') + '</th><th id="sub-status" class="">' + soy.$$escapeHtml('Estado') + '</th><th id="sub-summary">' + soy.$$escapeHtml('Resumen') + '</th><th id="sub-cycle">' + soy.$$escapeHtml('Ciclo') + '</th><th id="sub-folder">' + soy.$$escapeHtml('Carpeta') + '</th><th id="sub-actions">' + soy.$$escapeHtml('Defecto') + '</th><th id="sub-executed-by">' + soy.$$escapeHtml('Ejecutado por') + '</th><th id="sub-executed-on">' + soy.$$escapeHtml('Ejecutado el') + '</th><th id="sub-execute-button"></th></tr></thead><tbody>';
  if (opt_data.executions.length) {
    var executionList127 = opt_data.executions;
    var executionListLen127 = executionList127.length;
    for (var executionIndex127 = 0; executionIndex127 < executionListLen127; executionIndex127++) {
      var executionData127 = executionList127[executionIndex127];
      output += '<tr class="zephyr-tb-sprint-issue-execution" data-execution-id="' + soy.$$escapeHtml(executionData127.id) + '">';
      if (executionData127.canViewIssue) {
        output += '<td><a href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(executionData127.issueKey) + '">' + soy.$$escapeHtml(executionData127.issueKey) + '</a></td><td class="zephyr-break-word execution-status-td"><div class="field-group execution-status-container ' + soy.$$escapeHtml(executionData127.executionWorkflowStatus == 'COMPLETED' ? 'executionWorkflowStatusCompletedWhole' : '') + '"><div id="execution-status-value-schedule_' + soy.$$escapeHtml(opt_data.issueId) + '-' + soy.$$escapeHtml(executionData127.id) + '" class="labels exec-status-container"><dl class="zfj-editable-field"><dd id="current-execution-status-dd-schedule_' + soy.$$escapeHtml(opt_data.issueId) + '-' + soy.$$escapeHtml(executionData127.id) + '" class="new-session-status" style="background-color:' + soy.$$escapeHtml(executionData127.status.color) + ';" title="' + soy.$$escapeHtml(executionData127.status.name) + soy.$$escapeHtml(executionData127.status.description ? ': ' + executionData127.status.description : '') + '">' + soy.$$escapeHtml(executionData127.status.name) + '</dd><a id="executionStatus-labels-schedule_' + soy.$$escapeHtml(opt_data.issueId) + '-' + soy.$$escapeHtml(executionData127.id) + '" href="#" class="zfj-overlay-icon icon icon-edit-sml"><span rel="' + soy.$$escapeHtml(executionData127.status.id) + '">' + soy.$$escapeHtml(executionData127.status.name) + '</span></a></dl></div><div id="execution-field-select-schedule_' + soy.$$escapeHtml(opt_data.issueId) + '-' + soy.$$escapeHtml(executionData127.id) + '"  style="display: none; "><select id="exec_status-schedule_' + soy.$$escapeHtml(opt_data.issueId) + '-' + soy.$$escapeHtml(executionData127.id) + '" data-issueId=' + soy.$$escapeHtml(opt_data.issueId) + ' class="select" style="height:auto; max-height: 200px; width:150px; z-index:10;" size="4">';
        var execList175 = opt_data.executionStatusList;
        var execListLen175 = execList175.length;
        for (var execIndex175 = 0; execIndex175 < execListLen175; execIndex175++) {
          var execData175 = execList175[execIndex175];
          output += (execData175.id == executionData127.status.id) ? '<option value="' + soy.$$escapeHtml(execData175.id) + '" selected="selected" rel="' + soy.$$escapeHtml(execData175.color) + '" title="' + soy.$$escapeHtml(execData175.description) + '">' + soy.$$escapeHtml(execData175.name) + '</option>' : '<option value="' + soy.$$escapeHtml(execData175.id) + '" rel="' + soy.$$escapeHtml(execData175.color) + '" title="' + soy.$$escapeHtml(execData175.description) + '">' + soy.$$escapeHtml(execData175.name) + '</option>';
        }
        output += '</select></div></div></td><td class="zephyr-break-word zephyr-td-issues-summary-td"><div class="zephyr-td-issues-summary-td-cell"><a href="' + soy.$$escapeHtml(contextPath) + '/browse/' + soy.$$escapeHtml(executionData127.issueKey) + '" title="' + soy.$$escapeHtml(executionData127.issueKey) + ' - ' + soy.$$escapeHtml(executionData127.issueSummary) + '">' + soy.$$escapeHtml(executionData127.issueSummary) + '</a></div></td><td class="zephyr-break-word zephyr-td-issues-summary-td"><div class="zephyr-td-issues-summary-td-cell"><a href="' + soy.$$escapeHtml(contextPath) + '/DisplayCycle.jspa?cycleId=' + soy.$$escapeHtml(executionData127.cycleId) + '&versionId=' + soy.$$escapeHtml(executionData127.versionId) + '&issueKey=' + soy.$$escapeHtml(executionData127.issueKey) + '" title="' + soy.$$escapeHtml(executionData127.cycleName) + '" class="zephyr-tb-cycle-link js-key-link">' + soy.$$escapeHtml(executionData127.cycleName) + '</a></div></td><td>' + ((executionData127.folderName) ? '<span>' + soy.$$escapeHtml(executionData127.folderName) + '</span>' : '') + '</td><td class="zephyr-break-word">' + ((executionData127.totalDefectCount > 0) ? '<div class="zfj-defect-hover" data-issueKey="' + soy.$$escapeHtml(executionData127.issueKey) + '" data-executionId="' + soy.$$escapeHtml(executionData127.id) + '" data-color="' + soy.$$escapeHtml(executionData127.status.color) + '"><span class="aui-lozenge aui-lozenge-defects">' + soy.$$escapeHtml(executionData127.executionDefectCount) + ' | ' + soy.$$escapeHtml(executionData127.stepDefectCount) + '</span>' : '') + ZEPHYR.Templates.TestBoard.defectColumnValue({defects: executionData127.executionDefects}) + ((executionData127.defects) ? '</div>' : '') + '</td><td class="zephyr-td-issues-user-td"><div class="zephyr-td-issues-summary-td-cell"><a class="zephyr-user-hover" rel="' + soy.$$escapeHtml(executionData127.executedByUserName) + '" href="' + soy.$$escapeHtml(contextPath) + '/secure/ViewProfile.jspa?name=' + soy.$$escapeHtml(executionData127.executedByUserName) + '">' + soy.$$escapeHtml(executionData127.executedByDisplay) + '</a></div></td><td>' + soy.$$escapeHtml(executionData127.executedOn) + '</td><td><button id="zephyr-td-detail-execute-test" class="aui-button zephyr-td-detail-execute-test" title="' + soy.$$escapeHtml('Zephyr de Ejecutar Test') + '" data-index="' + soy.$$escapeHtml(executionIndex127) + '" data-href="' + soy.$$escapeHtml(contextPath) + '/secure/enav/#' + soy.$$escapeHtml(executionData127.id) + '">E</a></button></td>';
      } else {
        output += '<td colspan=\'15\' style="text-align:center;vertical-align:middle" class="new-session-status">No Permission on Test/Issue (' + soy.$$escapeHtml(executionData127.issueKey) + ')</td>';
      }
      output += '</tr>';
    }
  } else {
    output += '<tr><td colspan="4">' + soy.$$escapeHtml('No se han encontrado pruebas que coincidan con la solicitud.') + '</td></tr>';
  }
  output += '</tbody></table></div>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Issues.executionsHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Issues.executionsHTML';
}


ZEPHYR.Templates.TestBoard.Issues.defectCountHTML = function(opt_data, opt_ignored) {
  return '<span class="aui-lozenge aui-lozenge-defects zephyr-tb-defect-hover" title="' + soy.$$escapeHtml(AJS.format('{0} Abrir defectos de {1} total de defectos \xfanicos',opt_data.totalOpenDefectCount,opt_data.totalDefectCount)) + '">' + soy.$$escapeHtml(opt_data.totalOpenDefectCount) + '</span>';
};
if (goog.DEBUG) {
  ZEPHYR.Templates.TestBoard.Issues.defectCountHTML.soyTemplateName = 'ZEPHYR.Templates.TestBoard.Issues.defectCountHTML';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprint-cycle-detail-view.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }
ZEPHYR.Agile.TestBoard.minWidth = 400;
ZEPHYR.Agile.TestBoard.containerSelector = '#zephyr-tb-sprints-wrapper';

ZEPHYR.Agile.TestBoard.resizeUI = {
	getContainer: function() {
	    if (!ZEPHYR.Agile.TestBoard.container) {
	        ZEPHYR.Agile.TestBoard.container = AJS.$(ZEPHYR.Agile.TestBoard.containerSelector);
	    }
	    return ZEPHYR.Agile.TestBoard.container;
	},
	/**
	 * 'Element query' for backlog column - used to resize/change elements
	 */
	checkBacklogWidth: function() {
	    var currentWidth = ZEPHYR.Agile.TestBoard.resizeUI.getContainer().width();

	    // These classes must be placed on the body or they won't apply to the elements created when dragging an issue
	    if (currentWidth < 600) {
	        AJS.$('body').addClass('ghx-plan-band-1').removeClass('ghx-plan-band-2');
	    } else {
	        AJS.$('body').addClass('ghx-plan-band-2').removeClass('ghx-plan-band-1');
	    }
		ZEPHYR.Agile.TestBoard.resizeUI.setExecutionDetailWidth();
	    GH.planOnboarding.refresh();
	    // TODO: Refresh elements (usually due to change in layout).
	},
	attachResizable: function() {
		// TODO: Fix the resizable trigger
	    AJS.$("#zephyr-tb-detail-column").resizable({
	        handles: {
	            w: AJS.$("#zephyr-tb-js-sizer")
	        },
	        resize: ZEPHYR.Agile.TestBoard.resizeUI.checkBacklogWidth,
	        stop: ZEPHYR.Agile.TestBoard.resizeUI.storeWidth,
	        maxWidth: ZEPHYR.Agile.TestBoard.resizeUI.getMaxWidth(),
	        minWidth: ZEPHYR.Agile.TestBoard.resizeUI.minWidth
	    });
		ZEPHYR.Agile.TestBoard.resizeUI.setExecutionDetailWidth();
	},
	setExecutionDetailWidth: function() {
		var detailExecutionWidth = AJS.$('#zephyr-tb-detail-column').width();

		AJS.$('#zephyr-tb-detail-execution-section').width((detailExecutionWidth - 40));
		AJS.$('#zephyr-tb-detail-section').width((detailExecutionWidth - 60));
	},
	getMaxWidth: function() {
	    return Math.max(ZEPHYR.Agile.TestBoard.minWidth, (AJS.$("#zephyr-tb-sprints-column").width() + AJS.$("#zephyr-tb-detail-column").width()) / 2);
	},
	setDetailViewWidth: function(width) {
	    localStorage.setItem('zephyr.tb.detailViewWidth', width);
	},
	getDetailViewWidth: function() {
		var detailViewWidth = localStorage.getItem('zephyr.tb.detailViewWidth') || 400;

		return detailViewWidth;
	},
	storeWidth: function() {
	    var detailViewWidth = AJS.$("#zephyr-tb-detail-column").width();
	    // var backlogWidth = AJS.$("#zephyr-tb-sprints-column").width();

	    //var detailViewPercentage = detailViewWidth <= ZEPHYR.Agile.TestBoard.minWidth ? 0 : (detailViewWidth / (detailViewWidth + backlogWidth));
	    var detailViewColumnWidth = detailViewWidth <= ZEPHYR.Agile.TestBoard.minWidth ? ZEPHYR.Agile.TestBoard.minWidth : detailViewWidth;
	    ZEPHYR.Agile.TestBoard.resizeUI.setDetailViewWidth(detailViewColumnWidth);

	    var isSmallWidth = function(detailViewWidth) {
	        return detailViewWidth >= ZEPHYR.Agile.TestBoard.minWidth && detailViewWidth <= 500;
	    };
	    var isMediumWidth = function(detailViewWidth) {
	        return detailViewWidth > 500 && detailViewWidth <= 600;
	    };
	    var isLargeWidth = function(detailViewWidth) {
	        return detailViewWidth > 600;
	    };
	}
};


/**
 * - Show Cycle details
 * - Next
 * - ExecutionDetailsView
 */
ZEPHYR.Agile.TestBoard.SprintCycleDetailView = Backbone.View.extend({
	events: {
		'click .zephyr-tb-detail-close': 	'hideCycleDetails',
		'click .zephyr-td-detail-execute-test': 'navigateToExecuteTest'
	},
	initialize: function(options) {
		this.options = options;
		_.bindAll(this, 'getExecutionsBasedOnStatusUpdate', 'getZQLQuery', 'getExecutionDataParams');
		var instance = this
		this.cycleName = null;
		this.cycleId = null;
		this.clearStatus = false;
		this.model.bind('reset', this.renderExecutionUI, this);
		ZEPHYR.Agile.TestBoard.globalDispatcher.off(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET);
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.EXECUTIONS_GET, this.getExecutionsBasedOnOffset, this);
		jQuery(document).off("ScheduleUpdated");
		jQuery(document).on("ScheduleUpdated", instance.getExecutionsBasedOnStatusUpdate);
	},
	attachViews: function() {
		var instance = this;
		var resizeTimeout;
		// Attach Single select for Filter By
		this.attachExecutionStatusSelect();
		// Attach Execution Pagination
		this.executionPaginationView = new ZEPHYR.Agile.TestBoard.ExecutionPaginationView({
			el: '#execution-pagination-container',
			model: this.model
		});
		// Attach ExecutionDetailsView
		var dataParams = this.getExecutionDataParams(this.offset);
		this.fetchExecutions(dataParams);
		AJS.$(window).resize(function() {
			clearTimeout(resizeTimeout);

            resizeTimeout = setTimeout(function () {
				instance.resizeUIHeight();
            }, 250);
		});
		// Attach View Resize
		ZEPHYR.Agile.TestBoard.resizeUI.attachResizable();
	},
	attachExecutionStatusSelect: function() {
		var instance = this;
		AJS.$('#zephyr-tb-status-dd').val(instance.statusJSON.id);
		AJS.$('#zephyr-tb-status-dd').auiSelect2({
			allowClear: true
		})
		.on("change", function (ev) {
			instance.statusId = AJS.$(ev.target).val();
			instance.offset = 0;
			var dataParams = instance.getExecutionDataParams(instance.offset);
			instance.fetchExecutions(dataParams);
			instance.setSelectedStatusParams();
		});
		AJS.$('.select2-container').css({'width': '80%'});

	},
	getStatusName: function() {
		var statusIds = this.statusId,
			statusName = [];
		_.each(statusIds, function(statusId) {
			var statusJSON = ZEPHYR.Agile.TestBoard.executionStatus.filter(function(status) {if(status.id == statusId) {return true;}});
			if(statusJSON && statusJSON[0]) {
				statusName.push('"' + ZEPHYR.Agile.TestBoard.escapeString(statusJSON[0].name) + '"');
			}
		});
		return statusName.toString();
	},

	getZQLQuery: function(useCycleId) {
		var fixVersion = this.versionName;
		var statusName = this.getStatusName();
		var statusZQLClause = (statusName == "") ? "" : 'AND executionStatus in (' + statusName + ') ';
		var folderId = this.folderId;
		var cycleZQLClause = (useCycleId) ? ' AND cycleId=' + this.cycleId : ' AND cycleName in ("' + ZEPHYR.Agile.TestBoard.escapeString(this.cycleName) +'")';
		var zql ;
		if (folderId ){
			zql = 'project = "' + ZEPHYR.Agile.TestBoard.escapeString(this.projectKey) + '" AND fixVersion = "' + ZEPHYR.Agile.TestBoard.escapeString(fixVersion) + '"' +
				cycleZQLClause  +' ' + statusZQLClause +  ' AND folderId = ' + folderId + ' ORDER BY Execution ASC';
		} else {
			zql = 'project = "' + ZEPHYR.Agile.TestBoard.escapeString(this.projectKey) + '" AND fixVersion = "' + ZEPHYR.Agile.TestBoard.escapeString(fixVersion) + '"' +
				cycleZQLClause  +' ' + statusZQLClause + ' ORDER BY Execution ASC';
		}
		return zql;
	},
	getExecutionDataParams: function(offset) {
		var zqlQuery = this.getZQLQuery(true),
			dataParams = {
				zqlQuery: zqlQuery,
				offset: offset,
				maxRecords:	10,
				expand: 'executionStatus'
			};
		this.offset = offset;
		return dataParams;
	},
	getExecutionsBasedOnOffset: function(offset) {
		var dataParams = this.getExecutionDataParams(offset);
		this.fetchExecutions(dataParams);
		this.setSelectedStatusParams();
	},
	getExecutionsBasedOnStatusUpdate: function() {
		var dataParams = this.getExecutionDataParams(this.offset);
		this.fetchExecutions(dataParams);
		// trigger call to update cycle progress bar
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.CYCLE_PROGRESS_BAR_UPDATE + '_' + this.sprintId, this.cycleId);
	},
	fetchExecutions: function(dataParams, successCallback) {
		var instance = this,
			detailViewWidth = ZEPHYR.Agile.TestBoard.resizeUI.getDetailViewWidth();
		AJS.$('#zephyr-tb-detail-column').width(detailViewWidth);
		ZEPHYR.Agile.TestBoard.Loading.showLoadingIndicator();
		this.model.fetch({
			reset: true,
			data: dataParams,
			success: function(executions, response) {
				if(successCallback)
					successCallback();
			},
			error: function(executions, response) {
				ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
				AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.error[0] ||responseJSON.message || responseJSON.errorDescHtml;
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
			}
		});
	},
	navigateToExecuteTest: function(ev) {
		ev.preventDefault();
		var targetEl = AJS.$(ev.target),
			index = targetEl.data('index'),
			elHref = targetEl.data('href'),
			zqlQuery = this.getZQLQuery(false);

		window.location.href = elHref + encodeURIComponent(zqlQuery) + '&view=detail&offset='+ (this.offset + index + 1);
	},
	hideCycleDetails: function(ev) {
		this.$el.html('').width(0);
		AJS.$('.zephyr-tb-cycle-content').removeClass('zephyr-tb-selected');
		/** Update URL **/
		//ZEPHYR.Agile.TestBoard.data['selectedSprint'] = null;
		//ZEPHYR.Agile.TestBoard.data['selectedCycle'] = null;
		ZEPHYR.Agile.TestBoard.data['view'] = ZEPHYR.Agile.TestBoard.view;
		ZEPHYR.Agile.TestBoard.data['isDetailView'] = false;
		ZEPHYR.Agile.TestBoard.data['selectedStatus'] = null;
		ZEPHYR.Agile.TestBoard.Router.URL.setParams();
		ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false});
	},
	renderExecutionUI: function() {
		var executionStatus = this.model.executionStatus,
			executions = this.model.toJSON() || [];
			executions.forEach(function(cycle){
				cycle.cycleName = cycle.cycleName || '';
				cycle.folderName = cycle.folderName || '';
			});

		var	executionsHTML = ZEPHYR.Templates.TestBoard.Sprint.executionsHTML({
				executions: executions,
				executionStatusList: executionStatus
			});

		ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
		this.$el.find('#zephyr-tb-detail-section').html(executionsHTML);

		// Attach execution nav menu
		var executionDetailNavHTML = ZEPHYR.Templates.TestBoard.Sprint.executionDetailNavHTML({
			executionCount: (this.model.totalCount || 0)
		});
		AJS.$('#zephyr-tb-detail-execution-nav-menu').html(executionDetailNavHTML);

		// Create editable view for status field.
		var editableFields = AJS.$('#zephyr-tb-executions-table div.field-group.execution-status-container');
		AJS.$.each(editableFields, function(i, $container) {
			var executionStatusView = new ZEPHYR.Schedule.executionStatusView({
				el: 			$container,
				elBeforeEdit:	AJS.$($container).find('[id^=execution-status-value-schedule-]'),
				elOnEdit:		AJS.$($container).find('[id^=execution-field-select-schedule-]')
			});
		});
		/**
		 * Adjust the height dependant on the headers
		 */
		 this.resizeUIHeight();
	},
	resizeUIHeight: function() {
		var containerHeight = AJS.$('#' + ZEPHYR.Agile.TestBoard.data.testBoardElId).height();
		var detailHeaderHeight = AJS.$('#zephyr-tb-detail-head').height() + AJS.$('.zephyr-tb-statistic-group').height() + 20 + 88;		// height +  margin + padding
		AJS.$('#zephyr-tb-detail-execution-section').height(containerHeight - detailHeaderHeight);
		AJS.$('.zephyr-tb-container').height(containerHeight - detailHeaderHeight);
	},
	setSelectedStatusParams: function() {
		var selectedStatus = null;
		var status = AJS.$('#zephyr-tb-status-dd').val();
		if(status) {
			selectedStatus = status + ':' + this.offset;
		}
		ZEPHYR.Agile.TestBoard.data.selectedStatus = selectedStatus;
		/** Update URL */
		ZEPHYR.Agile.TestBoard.Router.URL.setParams();
		ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false});
	},
	getPrevSelectedStatusParams: function() {
		var statusJSON = {};
		if(ZEPHYR.Agile.TestBoard.data.selectedStatus) {
			var statusAttr = ZEPHYR.Agile.TestBoard.data.selectedStatus;
			statusAttr = statusAttr.split(':');
			statusJSON.id = (statusAttr[0]) ? statusAttr[0].split(',') : null;
			statusJSON.offset = statusAttr[1] || 0;
		} else {
			statusJSON.id = null;
			statusJSON.offset = 0;
		}

		return statusJSON;
	},
	render: function() {
		if(AJS.$('#zephyr-tb-js-sizer').length) {
			AJS.$("#zephyr-tb-detail-column").resizable("destroy"); // Destroy the previous resizable
		}
	    this.statusJSON = this.getPrevSelectedStatusParams();
	    this.offset = this.statusJSON.offset;
		var cycleDetailsHTML = ZEPHYR.Templates.TestBoard.Sprint.cycleDetailsHTML({
			executionStatus: ZEPHYR.Agile.TestBoard.executionStatus,
			cycleName: this.cycleName,
			versionName: this.versionName,
			projectKey: this.projectKey,
			folderId : this.folderId,
			folderName : this.folderName
		});
		this.$el.html(cycleDetailsHTML);
		this.statusId = this.statusJSON.id;
		this.attachViews();
		this.clearStatus = true; // To clear the status, if other cycle is selected
		return this;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprint-cycles-view.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

// Cycles
ZEPHYR.Agile.TestBoard.Cycle = Backbone.Model.extend();
ZEPHYR.Agile.TestBoard.CycleCollection = Backbone.Collection.extend({
    model: ZEPHYR.Agile.TestBoard.Cycle,
    url: function() {
    	return getRestURL() + "/cycle/cyclesByVersionsAndSprint";
    },
    parse: function(resp, xhr) {
		/**
		 * Considering only resp[0] and not looping because the cycles are fetched per sprintId.
		 */
		if(resp[0])
		   	return resp[0].cycles;
    }
});

// {call ZEPHYR.Agile.TestBoard.getCycleZQLQuery data="[$cycle.versionName, $cycle.name]" /}
ZEPHYR.Agile.TestBoard.getCycleZQLQuery = function(params, output) {
	var fixVersion = params[0],
		cycleName = params[1],
		projectKey = params[2],
		zql = 'project = "' + ZEPHYR.Agile.TestBoard.escapeString(projectKey) + '" AND fixVersion = "' + ZEPHYR.Agile.TestBoard.escapeString(fixVersion) + '" AND cycleName in ("'
			+ ZEPHYR.Agile.TestBoard.escapeString(cycleName) +'")';

	return appendSoyOutputOnCall(encodeURIComponent(zql), output);
}

// {call ZEPHYR.Agile.TestBoard.getFolderZQLQuery
ZEPHYR.Agile.TestBoard.getFolderZQLQuery = function(params, output) {
	var fixVersion = params[0],
		cycleName = params[1],
		projectKey = params[2],
		folderName = params[3],
		zql = 'project = "' + ZEPHYR.Agile.TestBoard.escapeString(projectKey) + '" AND fixVersion = "' + ZEPHYR.Agile.TestBoard.escapeString(fixVersion) + '" AND cycleName in ("'
			+ ZEPHYR.Agile.TestBoard.escapeString(cycleName) +'")' + ' AND folderName = "' + ZEPHYR.Agile.TestBoard.escapeString(folderName) + '"';

	return appendSoyOutputOnCall(encodeURIComponent(zql), output);
}

/**
 * - Display Cycles.
 * - Need to decide how show more is shown if many cycles
 */
ZEPHYR.Agile.TestBoard.SprintCyclesView = Backbone.View.extend({
	events: {
		'click .zephyr-tb-key .zephyr-tb-cycle-link': 'preventDefaultNavigation',
		'click .zephyr-tb-cycle-remove': 'removeCycleFromSprintDialogUI'
	},
	initialize: function(options) {
		this.options = options;
		this.sprintId = options.sprintId;
		this.sprintName = options.sprintName;
		this.model.bind('reset', this.render, this);
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.CYCLES_FILTER, this.filterCycles, this);
		this.triggerSelectedClick = true;
	},
	filterCycles: function(cycleName) {
		cycleName = (cycleName)? cycleName.toString().toLowerCase(): '';
		// var cycles = this.model.filter(function(cycle) {
		// 		var name = cycle.get("name").toLowerCase();
		// 		return (name.indexOf(cycleName) > -1);
		// 	}).map(function(cycle) {
		// 		return cycle.attributes;
		// 	});
		var allCycles = this.model.toJSON();
		var matchedCycles = [];
		for(var i = 0; i < allCycles.length; i++) {
			var name = allCycles[i].name.toLowerCase();
			if (name.indexOf(cycleName) > -1){
				matchedCycles.push(allCycles[i]);
			}
			if (allCycles[i].folders){
				for (var j = 0; j < allCycles[i].folders.length; j++) {
					var folderName = allCycles[i].folders[j].folderName.toLowerCase();
					if (folderName.indexOf(cycleName) > -1) {
						matchedCycles.push(allCycles[i]);
					}
				}
			}
		}

		// ZFJ-5758 Since we will duplicate elements in array hence we are creating a unique array
		var jsonObject = matchedCycles.map(JSON.stringify);
		var uniqueSet = new Set(jsonObject);
		var uniqueCycles = Array.from(uniqueSet).map(JSON.parse);

		this.displayCycles(uniqueCycles);
		ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.CYCLES_COUNT_UPDATE + '_' + this.sprintId, uniqueCycles.length);
	},
	removeCycleFromSprintDialogUI: function(ev) {
		ev.preventDefault();
		ev.stopImmediatePropagation();
		var cycleId = AJS.$(ev.target).data('id'),
			versionId = AJS.$(ev.target).data('version-id'),
			folderId = AJS.$(ev.target).data('folder-id'),
			folderName = AJS.$(ev.target).data('folder-name'),
			cycleName = this.model.get(cycleId).get('name'),
			sprintId = this.sprintId,
			label = "Zephyr de Quitar Ciclo de Sprint",
			dialogButtons = [
				{
					id : 'zephyr-je-dialog-remove',
				    name : "Quitar"
				},
		        {
		        	id : 'zephyr-je-dialog-cancel',
		            name : "Cancelar",
		            type : 'link'
		        }
		     ];
		     if (folderId) {
                 label = "Eliminar la carpeta de Sprint"
	     	     dialogContentHTML = ZEPHYR.Templates.TestBoard.Sprint.removeFolderFromSprintHTML({
	     	    	 folderName: folderName,
	     			 sprintName: this.sprintName
	     	     });

		     } else {
			     dialogContentHTML = ZEPHYR.Templates.TestBoard.Sprint.removeCycleFromSprintHTML({
			    	 cycleName: cycleName,
					 sprintName: this.sprintName
			     });
			 }
		     dialogId = "zephyr-tb-remove-test-cycle",
		     dialogRenderHTML = ZEPHYR.Templates.Dialog.renderDialog({
				"dialogId" : dialogId,
				"dialogSize" : "aui-dialog2-medium",
				"dialogHeader" : label,
				"dialogContent" : dialogContentHTML,
				"dialogButtons" : dialogButtons,
				isModal: true
		     }),
		     instance = this;

		AJS.$('body').append(dialogRenderHTML);
		var removeCycleFromSprintDialog = AJS.dialog2('#' + dialogId); // Create Dialog2 component
		removeCycleFromSprintDialog.show();
		ZEPHYR.About.evalMessage({selector:".zephyr-tb-eval-lic"}, null, function(){
			var contentHeight = removeCycleFromSprintDialog.$el.find('.dialog2-content').height() + 40; // Content height + padding
			removeCycleFromSprintDialog.$el.find('.aui-dialog2-content').css('height', contentHeight);
		});
		// Remove button
		removeCycleFromSprintDialog.$el.find('#zephyr-je-dialog-remove').click(function(ev) {
	        ev.preventDefault();
			AJS.$('#dialog-icon-wait').show();
	        instance.removeCycleFromSprint(cycleId, versionId, sprintId, folderId,function() {
		        if(ZEPHYR.Agile.TestBoard.data.selectedCycle == cycleId) {
		        	AJS.$('.zephyr-tb-detail-close').trigger('click'); // Close the detail panel if the selected cycle is removed from sprint
		        }
		        removeCycleFromSprintDialog.hide();
	        });
	    });
		// Cancel link
		removeCycleFromSprintDialog.$el.find('#zephyr-je-dialog-cancel').click(function(ev) {
	        ev.preventDefault();
	        removeCycleFromSprintDialog.hide();
	    });
	},
	removeCycleFromSprint: function(cycleId, versionId, sprintId,folderId, callback) {
		jQuery.ajax({
    		url: getRestURL() + "/cycle",
    		type : "PUT",
    		accept: "PUT",
    		contentType :"application/json",
    		dataType: "json",
    		data: JSON.stringify( {
    			  'id' : cycleId,
    	          'projectId': ZEPHYR.Agile.TestBoard.data.projectId,
    	          'versionId': versionId,
    	          'sprintId': "",
    	          'folderId' : folderId
    		}),
    		timeout: 0,
    		success : function(response) {
    			if(callback)
					callback();
				ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.CYCLE_PROGRESS_BAR_UPDATE + '_' + sprintId);
    		},
    		error : function(response) {
    			AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
				if(response.status == 403 && !responseText) { // Cycle permission error messages
					showAUIError(response, AJS.$('.message-bar'));
    				AJS.$('#zephyr-je-dialog-remove').attr('disabled', 'disabled');
    				AJS.$('#dialog-icon-wait').hide();
    				return;
    			} else {
    				if(callback)
    					callback();
    			}
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
    		}
    	});
	},
	preventDefaultNavigation: function(ev) {
		ev.preventDefault();
	},
	displayCycles: function(cycles) {
		cyclesAlias = JSON.parse(JSON.stringify(cycles));
		cyclesAlias.forEach(function(cycle){
			cycle.name = cycle.name;
			cycle.build = cycle.build;
			cycle.description = cycle.description;
			cycle.environment = cycle.environment;
			cycle.folders = cycle.folders || [];
		});
		var cyclesHTML = ZEPHYR.Templates.TestBoard.Sprint.cyclesHTML({
			cycles: cyclesAlias,
			sprintId: this.sprintId
		});
		this.$el.html(cyclesHTML);
		if(ZEPHYR.Agile.TestBoard.data.isDetailView && this.sprintId == ZEPHYR.Agile.TestBoard.data.selectedSprint && this.triggerSelectedClick) {
			// Select the previously selected cycle
			this.$el.find('.zephyr-tb-cycle-content[data-cycle-id="' + ZEPHYR.Agile.TestBoard.data.selectedCycle + '"]').click();
		} else {
			this.$el.find('.zephyr-tb-cycle-content[data-cycle-id="' + ZEPHYR.Agile.TestBoard.data.selectedCycle + '"]').addClass('zephyr-tb-selected');
			this.triggerSelectedClick = true;
		}
	},
	render: function() {
		var cycles = this.model.toJSON();
		this.displayCycles(cycles);
		ZEPHYR.Agile.TestBoard.updateContentAreaHeight();
		return this;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprint-view.js' */
/* global AJS */
/* global Backbone */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

/**
 * - SprintCyclesView - display Cycles. need to decide how show more is shown if many cycles
 * - show/hide cycles
 * - click on cycle render the SprintCycleDetailViews
 */
ZEPHYR.Agile.TestBoard.SprintView = Backbone.View.extend({
	/*events: {
		'.toggle-title':	'toggleSprint'
	},*/
	initialize: function(options) {
		this.options = options;
		this.attachViews();
		this.sprintId = this.model.get('id');
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.CYCLES_COUNT_UPDATE + '_' + this.sprintId, this.displayTestCycleCount, this);
		ZEPHYR.Agile.TestBoard.globalDispatcher.off(ZEPHYR.Agile.TestBoard.Events.CYCLE_PROGRESS_BAR_UPDATE + '_' + this.sprintId);
		ZEPHYR.Agile.TestBoard.globalDispatcher.on(ZEPHYR.Agile.TestBoard.Events.CYCLE_PROGRESS_BAR_UPDATE + '_' + this.sprintId, this.updateCycleProgressBar, this);
		this.selectedCycleIds = [];
	},
	displayTestCycleCount: function(cycleCount) {
		var cycleCountHTML;

		if(cycleCount < this.cycleCount) {
			cycleCountHTML = AJS.format("{0} de {1} visible de Ciclos de Prueba", cycleCount, this.cycleCount);
		} else {
			cycleCountHTML = AJS.format("{0} Ciclos de Prueba", cycleCount);
		}
		this.$el.find('#zephyr-tb-cycle-count').html(cycleCountHTML);
	},
	attachViews: function() {
		var sprintId = this.model.get('id');
		var instance = this;

		// Cycles View
    	this.cyclesView = new ZEPHYR.Agile.TestBoard.SprintCyclesView({
			el: '#sprint-cycle-container-' + sprintId,
			model: this.model.cycles,
			sprintId: sprintId,
			sprintName: this.model.get('name')
		});
    	this.fetchCyclesByVersionsAndSprint();
    	AJS.$('#zephyr-tb-link-test-cycles_' + sprintId).unbind('click')
    		.bind('click', function(ev) {
    			ev.preventDefault();
    			instance.showLinkTestCyclesDialog(null, null, false, false, null);
    		});

		return this;
	},
	getFilteredProjects: function() {
		var projects = ZEPHYR.Agile.TestBoard.data.projects.toJSON();
		var projectCount = ZEPHYR.Agile.TestBoard.data.projectId.toString().split(',').length;

		if(projectCount == 1) {
			var projectList = [],
				project = ZEPHYR.Agile.TestBoard.data.projects.get(ZEPHYR.Agile.TestBoard.data.projectId);
			if(project)
				projectList.push(project.toJSON());
			return projectList;
		} else {
			return projects;
		}
	},
	showLinkTestCyclesDialog: function(projectId, versionId, isLinked, refreshOnCancel, folderId) {
		var label = "Enlazar este Sprint a Ciclo(s) de Prueba",
			dialogButtons = [
				{
					id : 'zephyr-je-dialog-save',
				    name : "Guardar"
				},
		        {
		        	id : 'zephyr-je-dialog-cancel',
		            name : "Cancelar",
		            type : 'link'
		        }
		     ],
		     dialogContentHTML = ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesHTML({
		    	 projects: this.getFilteredProjects(),
				 selectedProjectId: projectId
		     }),
		     dialogId = "zephyr-tb-link-to-test-cycles",
		     dialogRenderHTML = ZEPHYR.Templates.Dialog.renderDialog({
				"dialogId" : dialogId,
				"dialogSize" : "aui-dialog2-medium",
				"dialogHeader" : label,
				"dialogContent" : dialogContentHTML,
				"dialogButtons" : dialogButtons,
				isModal: true
		     }),
		     instance = this;

		AJS.$('body').append(dialogRenderHTML);
		var linkToTestCyclesDialog = AJS.dialog2('#' + dialogId); // Create Dialog2 component
		linkToTestCyclesDialog.show();
		ZEPHYR.About.evalMessage({selector:".zephyr-tb-eval-lic"}, null, function(){
			var contentHeight = linkToTestCyclesDialog.$el.find('.dialog2-content').height() + 40; // Content height + padding
			linkToTestCyclesDialog.$el.find('.aui-dialog2-content').css('height', contentHeight);
		});
		// Save button
		linkToTestCyclesDialog.$el.find('#zephyr-je-dialog-save').click(function(ev) {
	        ev.preventDefault();
			linkToTestCyclesDialog.$el.find('#dialog-icon-wait').show();
			linkToTestCyclesDialog.$el.find('#zephyr-je-dialog-save').attr('disabled', 'disabled');
			instance.saveLinkedTestCycleUI(function() {
				linkToTestCyclesDialog.hide();
			}, linkToTestCyclesDialog.$el.find('#zephyr-tb-add-more-cycle').is(':checked'), refreshOnCancel, folderId);
	    })
		.attr('disabled', 'disabled')
		.before(ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesCheckboxHTML({
			isLinked: isLinked
		}));
		// Cancel link
		linkToTestCyclesDialog.$el.find('#zephyr-je-dialog-cancel').click(function(ev) {
	        ev.preventDefault();
	        if(refreshOnCancel) {
	        	ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);
	        }
		    linkToTestCyclesDialog.hide();
	    });
		var selectedProjectId = projectId || linkToTestCyclesDialog.$el.find('#zephyr-tb-link-tests-project-select').val();
		this.attachProjectsSingleSelect(selectedProjectId, versionId);
	},
	attachProjectsSingleSelect: function(projectId, versionId) {
		var instance = this;

		AJS.$('#zephyr-tb-link-tests-project-select').auiSelect2({
				formatResult: ZEPHYR.Agile.TestBoard.auiSelect2.formatResult,
				formatSelection: ZEPHYR.Agile.TestBoard.auiSelect2.formatSelection
			}).on("change", function (ev) {
				var selectedProjectId = AJS.$(ev.target).val();
				AJS.$('#dialog-icon-wait').show();
				AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
				var versions = instance.getVersionsByProjectId(selectedProjectId);
				instance.attachVersionsSingleSelect(selectedProjectId, versions, null);
				AJS.$('.zephyr-tb-eval-lic').empty(); // Clear the previous aui messages
			});
		AJS.$('.select2-container').css({'width': '250px'});
		var versions = this.getVersionsByProjectId(projectId);
		this.attachVersionsSingleSelect(projectId, versions, versionId);
	},
	attachVersionsSingleSelect: function(projectId, versions, versionId) {
		var instance = this;
		var versionEl = AJS.$('#zephyr-tb-link-tests-version-select');
		versionEl.html('');
		_.each(versions, function(version, key) {
			var versionName = version.name;
			versionEl.append(AJS.$("<option />")
				.val(version.versionId)
				.attr('title', AJS.escapeHtml(versionName))
				.html(AJS.escapeHtml(versionName)));
		}, this);
		if(!versionId){
			versionId = versions && versions[0] && versions[0].versionId;
		}
		versionEl.val(versionId);
		versionEl.auiSelect2({
				formatResult: ZEPHYR.Agile.TestBoard.auiSelect2.formatResult,
				formatSelection: ZEPHYR.Agile.TestBoard.auiSelect2.formatSelection
			})
			.on("change", function (ev) {
				var versionId = AJS.$(ev.target).val();
				var cycleIds = instance.getCycleIds();
				var projectId = AJS.$('#zephyr-tb-link-tests-project-select').val();
				AJS.$('#dialog-icon-wait').show();
				AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
				instance.getCyclesByVersionId(projectId, versionId, cycleIds);
				instance.toggleSaveButton(versionId);
			});
		var selectedVersionId = versionId || AJS.$('#zephyr-tb-link-tests-version-select').val();
		var cycleIds = this.getCycleIds();
		this.getCyclesByVersionId(projectId, selectedVersionId, cycleIds);
		instance.toggleSaveButton(selectedVersionId);
		AJS.$('.select2-container').css({'width': '250px'});
	},
	getVersionsByProjectId: function(projectId) {
		var versionListPerProject = [];

		if(ZEPHYR.Agile.TestBoard.data.versionId && !isNaN(ZEPHYR.Agile.TestBoard.data.versionId)) {
			var versionId = ZEPHYR.Agile.TestBoard.data.versionId;
			versionListPerProject = _.filter(ZEPHYR.Agile.TestBoard.data.versions, function(version) {
					return (version.versionId == versionId)
				}).filter(function(version) {
					return (version.projectId == projectId && !version.released);
				});
		} else  {
			versionListPerProject = _.filter(ZEPHYR.Agile.TestBoard.data.versions, function(version) {
					return (version.projectId == projectId && !version.released)
				});
		}

		return versionListPerProject;
	},
	filterCyclesByLink: function(cycles, cycleIds) {
		var cyclesJSON = {
			linkedCycles: [],
			unlinkedCycles: []
		};

		AJS.$.each(cycles, function(key, cycle) {
			//if(_.contains(cycleIds, parseInt(key)))
			// 	return true;		//Skip the target cycle
			if(key != "recordsCount" && key != "offsetCount") {
				if (parseInt(key) != -1 ) {
					cycle['id'] = key;
					//var selectedSprint = ZEPHYR.Agile.TestBoard.data.sprints.get(cycle.sprintId);
					//if(cycle.sprintId){
					//	cyclesJSON.linkedCycles.push(cycle);
					//} else {
					cyclesJSON.unlinkedCycles.push(cycle);
					//}
				}
			}
		});

		return cyclesJSON;
	},
	filterFoldersByLink: function(folders, folderIds) {
		var foldersJSON = {
			linkedFolders: [],
			unlinkedFolders: []
		};
		var instance = this;
		folders.forEach(function(folder) {
			// if(_.contains(folderIds, folder.folderId))
			// 	return true;
			if(folder.sprintId == instance.model.get('id')){
				foldersJSON.linkedFolders.push(folder);
			} else {
		 		foldersJSON.unlinkedFolders.push(folder);
			}
		});

		return foldersJSON;
	},
	getCycleLabel: function(cycleName, sprintId, selectId, cyclefolderId) {
		if(sprintId) {
			var selectedSprint = ZEPHYR.Agile.TestBoard.data.sprints.get(sprintId);
			if(selectedSprint) {
				var sprintName = selectedSprint.get('name');
				return cycleName + ' (' + sprintName  + ')';
			} else {
				// Fix for ZFJ-1774
				ZEPHYR.Utility.getSprintDetailsFromId(sprintId, function(sprint) {
					var _cycleName = cycleName + ' (' + sprint.name  + ')';
					if(AJS.$('#' + selectId +' option:selected').data('sprint-id') == sprintId) {
						AJS.$('#s2id_' + selectId + ' .select2-chosen').html(_cycleName).attr('title', _cycleName);
					}
					AJS.$('#' + selectId).find('option[data-sprintcyclefolderid=' + sprintId + cyclefolderId + ']').html(_cycleName)
						.attr('data-sprint-name', sprint.name);
				});
				return cycleName + ' (' + sprintId  + ')';
			}
		}
		return cycleName;
	},
	validateSprintId: function(sprintId) {
		var isSprintValid = false;
		var selectedSprint = ZEPHYR.Agile.TestBoard.data.sprints.get(sprintId);
		if(selectedSprint)
			isSprintValid = true;

		return isSprintValid;
	},
	attachCycleOptionHTML: function(cycles, attachEl, isLinked) {
		_.each(cycles, function(cycle, key) {
			var optionClass =(isLinked && key == 0)? 'zephyr-tb-sprint-cycle-option zephyr-tb-sprint-cycle-seperator': 'zephyr-tb-sprint-cycle-option'
			var cycleName = this.getCycleLabel(cycle.name, cycle.sprintId, attachEl.attr('id'), cycle.id);
			var sprintId = cycle.sprintId ? cycle.sprintId : null;
			attachEl.append(AJS.$("<option data-sprintcyclefolderid='"+ sprintId + cycle.id +"' class='" + optionClass + "' data-sprint-id='" + sprintId + "' />")
				.val(cycle.id)
				.attr('title', AJS.escapeHtml(cycleName))
				.html(AJS.escapeHtml(cycleName)));
		}, this);
	},
	attachFolderOptionHTML: function(folders, attachEl, isLinked) {
		attachEl.append(AJS.$("<option class='" + "zephyr-tb-sprint-folder-option zephyr-tb-sprint-folder-option-default zephyr-tb-sprint-folder-seperator" + "' data-sprint-id='" + null + "' />")
				.val('')
				.attr('title', "--- Seleccionar carpeta ---")
				.html("--- Seleccionar carpeta ---"));
		_.each(folders, function(folder, key) {
			var optionClass =(isLinked && key == 0)? 'zephyr-tb-sprint-folder-option zephyr-tb-sprint-folder-seperator': 'zephyr-tb-sprint-folder-option'
			var folderName = this.getCycleLabel(folder.folderName, folder.sprintId, attachEl.attr('id'), folder.folderId);
			var sprintId = folder.sprintId ? folder.sprintId : null;
			attachEl.append(AJS.$("<option data-sprintcyclefolderid='"+ sprintId + folder.folderId +"' class='" + optionClass + "' data-sprint-id='" + sprintId + "' />")
				.val(folder.folderId)
				.attr('title', AJS.escapeHtml(folderName))
				.html(AJS.escapeHtml(folderName)));
		}, this);
	},
	attachCyclesDD: function(cycles, cycleIds) {
		var cyclesJSON = this.filterCyclesByLink(cycles, cycleIds);
		var instance = this;
		instance.cycles = cycles;
		AJS.$('#zephyr-tb-link-tests-cycle-select').empty();
		if(cyclesJSON.unlinkedCycles.length) {
			this.attachCycleOptionHTML(cyclesJSON.unlinkedCycles, AJS.$('#zephyr-tb-link-tests-cycle-select'), false);
		}
		// if(cyclesJSON.linkedCycles.length) {
		// 	this.attachCycleOptionHTML(cyclesJSON.linkedCycles, AJS.$('#zephyr-tb-link-tests-cycle-select'), true);
		// }
		AJS.$('#zephyr-tb-link-tests-cycle-select').auiSelect2({
			formatResult: ZEPHYR.Agile.TestBoard.auiSelect2.formatResult,
			formatSelection: ZEPHYR.Agile.TestBoard.auiSelect2.formatSelection
		}).on('change', function(ev) {
			var cycleId = AJS.$(ev.target).val();
			var cycleObj = null;
			Object.keys(instance.cycles).forEach(function (key) {
				if (key == cycleId) {
					cycleObj = instance.cycles[key];
				}
			});
			AJS.$('#dialog-icon-wait').show();
			AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
			instance.getFoldersByCycleId(cycleId,cycleObj);
			instance.toggleSaveButton(cycleId);
		});
		var cycleId = AJS.$('#zephyr-tb-link-tests-cycle-select').val();
		var cycleObj = null;
		Object.keys(cycles).forEach(function (key) {
			if (key == cycleId) {
				cycleObj = cycles[key];
			}
		})
		if(cycleId) {
			instance.getFoldersByCycleId(cycleId,cycleObj);
		} else {
			AJS.$('#zephyr-tb-link-tests-folder-select').empty();
		}
		this.toggleSaveButton(cycleId);
		AJS.$('#dialog-icon-wait').hide();
		AJS.$('.select2-container').css({'width': '250px'});
	},
	attachFoldersDD: function(folders, cycleId) {
		var folderIds = [];
		folders.forEach(function(folder) {
			if(folder.sprintId) {
				folderIds.push(folder.folderId);
			}
		});
		var foldersJSON = this.filterFoldersByLink(folders, folderIds);
		var instance = this;
		AJS.$('#zephyr-tb-link-tests-folder-select').empty();
		if(foldersJSON.unlinkedFolders.length > 0) {
			this.attachFolderOptionHTML(foldersJSON.unlinkedFolders, AJS.$('#zephyr-tb-link-tests-folder-select'), false);
			AJS.$('#zephyr-je-dialog-save').prop('disabled', false);
		} else {
			var sprintId = AJS.$('#zephyr-tb-link-tests-cycle-select option:selected').data('sprint-id');
			var isSprintLinked = false;
			var cycle = this.model.cycles.filter(function(cycle) {
					return (cycle.get('id') == cycleId);
				}).map(function(cycle) {
					return cycle.attributes;
				});

			if(cycle[0] && cycle[0].sprintId === sprintId)
				isSprintLinked = true;

			if(isSprintLinked) {
				AJS.$('#zephyr-je-dialog-save').prop('disabled', true);
			} else {
				this.attachFolderOptionHTML(foldersJSON.unlinkedFolders, AJS.$('#zephyr-tb-link-tests-folder-select'), false);
				AJS.$('#zephyr-je-dialog-save').prop('disabled', false);
			}

		}
		// if(foldersJSON.linkedFolders.length) {
		// 	this.attachFolderOptionHTML(foldersJSON.linkedFolders, AJS.$('#zephyr-tb-link-tests-folder-select'), true);
		// }
		AJS.$('#zephyr-tb-link-tests-folder-select').auiSelect2({
			formatResult: ZEPHYR.Agile.TestBoard.auiSelect2.formatResult,
			formatSelection: ZEPHYR.Agile.TestBoard.auiSelect2.formatSelection
		}).on('change', function(ev) {
			var cycleId = AJS.$(ev.target).val();
			//AJS.$('#dialog-icon-wait').show();
			//AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
			//instance.toggleSaveButton(cycleId);
		});
		var cycleId = AJS.$('#zephyr-tb-link-tests-folder-select').val();
		//this.toggleSaveButton(cycleId);
		AJS.$('#dialog-icon-wait').hide();
		AJS.$('.select2-container').css({'width': '250px'});
	},
	getFoldersByCycleId: function(cycleId,cycleObj) {
		var instance = this;
    	AJS.$.ajax({
    		url: getRestURL() + "/cycle/" + cycleId + "/folders?projectId=" +cycleObj.projectId + "&versionId="+ cycleObj.versionId +  "&limit=1000&offset=0",
			type : "GET",
			contentType :"application/json",
			success: function(fetchedData){
				fetchedData = fetchedData.map(function(folder) {
            folder.folderName = folder.folderName;
            return folder;
        });
				instance.attachFoldersDD(fetchedData, cycleId);
			},
			error: function(response) {
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
	    		if(response.status == 403 && responseText) { // This is for JIRA authorization error messages
	    			AJS.dialog2('#zephyr-tb-link-to-test-cycles').hide();
	    			ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText);
	    		} else {
	    			if(response.status == 403) { // Cycle permission error messages
	    				responseText = responseJSON.PERM_DENIED;
	    				AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
	    			}
					AJS.$('#dialog-icon-wait').hide();
		    		AJS.$('.zephyr-tb-eval-lic').html('');
		    		AJS.$('.zfjEvalLic').remove();
					AJS.messages.error(".zephyr-tb-eval-lic", {
					   title: "\u00a1Error!",
					   body: responseText
					});
				}
	    	}
		});
	},
	/**
     * Fetches cycles by project and version
     */
    getCyclesByVersionId: function(projectId, versionId, cycleIds){
    	var instance = this;
    	AJS.$.ajax({
    		url: getRestURL() + "/cycle?versionId="+ versionId+"&projectId=" + projectId,
			type : "GET",
			contentType :"application/json",
			dataType: "json",
			success: function(fetchedData){
				Object.keys(fetchedData).forEach(function(k){
					if(!fetchedData[k].name) { return;}
					fetchedData[k].name = fetchedData[k].name;
				})
				instance.attachCyclesDD(fetchedData, cycleIds);
			},
			error: function(response) {
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
	    		if(response.status == 403 && responseText) { // This is for JIRA authorization error messages
	    			AJS.dialog2('#zephyr-tb-link-to-test-cycles').hide();
	    			ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText);
	    		} else {
	    			if(response.status == 403) { // Cycle permission error messages
	    				responseText = responseJSON.PERM_DENIED;
	    				AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
	    			}
					AJS.$('#dialog-icon-wait').hide();
		    		AJS.$('.zephyr-tb-eval-lic').html('');
		    		AJS.$('.zfjEvalLic').remove();
					AJS.messages.error(".zephyr-tb-eval-lic", {
					   title: "\u00a1Error!",
					   body: responseText
					});
				}
	    	}
		});
    },
	toggleSaveButton: function(value) {
		if(!value) {
			AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
		} else
			AJS.$('#zephyr-je-dialog-save').removeAttr('disabled');
	},
    getCycleIds: function() {
    	var cycleIds = [],
    		cycles = this.model.cycles.toJSON();

    	_.each(cycles, function(cycle) {
    		if(cycle.id) {
    			cycleIds.push(cycle.id);
    		}
    	});
    	cycleIds.push(-1); // Adhoc cycle
		cycleIds = _.union(cycleIds, this.selectedCycleIds);
    	return cycleIds;
    },
	isSprintLinkedToThisCycle: function(cycleId, sprintId) {
		var isSprintLinked = false;
		var cycle = this.model.cycles.filter(function(cycle) {
				return (!cycle.attributes.folders && cycle.get('id') == cycleId);
			}).map(function(cycle) {
				return cycle.attributes;
			});

		if(cycle[0] && cycle[0].sprintId != sprintId)
			isSprintLinked = true;
		return isSprintLinked;
	},
	saveLinkedTestCycle: function(projectId, cycleId, folderId, versionId, completed, errorCallback) {
		var sprintId = this.model.get('id');
		if(!sprintId || !cycleId)
			return;
		jQuery.ajax({
    		url: getRestURL() + "/cycle",
    		type : "PUT",
    		accept: "PUT",
    		contentType :"application/json",
    		dataType: "json",
    		data: JSON.stringify( {
    			  'id' : cycleId,
    			  'folderId': folderId,
    	          'projectId': projectId,
    	          'versionId': versionId,
    	          'sprintId': sprintId
    		}),
    		timeout: 0,
    		success : function(response) {
    			ZEPHYR.Agile.TestBoard.data.selectedSprint = sprintId;
    			if(completed)
    				completed.call();
    		},
    		error : function(response) {
    			AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
    			if(response.status == 403 && !responseText) { // Cycle permission error messages
		    		showAUIError(response, AJS.$('.message-bar'));
    				AJS.$('#zephyr-je-dialog-save').attr('disabled', 'disabled');
    				AJS.$('#dialog-icon-wait').hide();
    				return;
    			} else {
    				if(errorCallback)
        				errorCallback.call();
    			}
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
    		}
    	});
	},
	showSaveLinkedCycleConfirmation: function(projectId, cycleId, folderId, versionId, cycleName, sprintName, selectedSprintName, isLinkMoreTestCycles, refreshOnCancel, folderName) {
		var name;

		if(folderId) {
			name = folderName;
		} else {
			name = cycleName;
		}

		var label = "Enlazar este Sprint a Ciclo(s) de Prueba",
			dialogButtons = [
				{
					id : 'zephyr-je-dialog-save',
				    name : "Guardar"
				},
		        {
		        	id : 'zephyr-je-dialog-cancel',
		            name : "Cancelar",
		            type : 'link'
		        }
		     ],
		     dialogContentHTML = ZEPHYR.Templates.TestBoard.Sprint.linkToTestCyclesConfirmationHTML({
				name: name,
				sprintName: sprintName,
				selectedSprintName: selectedSprintName,
				folderId : folderId
			 }),
		     dialogId = "zephyr-tb-link-to-test-cycles-confirmation",
		     dialogRenderHTML = ZEPHYR.Templates.Dialog.renderDialog({
				"dialogId" : dialogId,
				"dialogSize" : "aui-dialog2-medium",
				"dialogHeader" : label,
				"dialogContent" : dialogContentHTML,
				"dialogButtons" : dialogButtons,
				isModal: true
		     }),
		     instance = this;

		AJS.$('body').append(dialogRenderHTML);
		var linkToTestCyclesConfirmDialog = AJS.dialog2('#' + dialogId); // Create Dialog2 component
		linkToTestCyclesConfirmDialog.show();
		ZEPHYR.About.evalMessage({selector:".zephyr-tb-eval-lic-confirm"}, null, function(){
			var contentHeight = linkToTestCyclesConfirmDialog.$el.find('.dialog2-content').height() + 40; // Content height + padding
			linkToTestCyclesConfirmDialog.$el.find('.aui-dialog2-content').css('height', contentHeight);
		});
		// Save button
		linkToTestCyclesConfirmDialog.$el.find('#zephyr-je-dialog-save').click(function(ev) {
	        ev.preventDefault();
			linkToTestCyclesConfirmDialog.$el.find('#dialog-icon-wait').show();
			linkToTestCyclesConfirmDialog.$el.find('#zephyr-je-dialog-save').attr('disabled', 'disabled');
	        instance.saveLinkedTestCycle(projectId, cycleId, folderId, versionId, function() {
		        linkToTestCyclesConfirmDialog.hide();
				if(isLinkMoreTestCycles) {
					instance.selectedCycleIds.push(parseInt(cycleId));
					instance.showLinkTestCyclesDialog(projectId, versionId, isLinkMoreTestCycles, true, folderId);
				} else {
    				ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);
					instance.selectedCycleIds = [];
				}
	        },
			function() {
				linkToTestCyclesConfirmDialog.hide();
				instance.selectedCycleIds = [];
			});
	    });
		// Cancel link
		linkToTestCyclesConfirmDialog.$el.find('#zephyr-je-dialog-cancel').click(function(ev) {
	        ev.preventDefault();
			if(refreshOnCancel) {
				ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);
			}
	        linkToTestCyclesConfirmDialog.hide();
	    });
	},
    saveLinkedTestCycleUI: function(completed, isLinkMoreTestCycles, refreshOnCancel, folderId) {
		var cycleId = AJS.$('#zephyr-tb-link-tests-cycle-select').val(),
			folderId = AJS.$('#zephyr-tb-link-tests-folder-select').val(),
			versionId = AJS.$('#zephyr-tb-link-tests-version-select').val(),
			projectId = AJS.$('#zephyr-tb-link-tests-project-select').val(),
			selectedSprintId = AJS.$('#zephyr-tb-link-tests-cycle-select option:selected').data('sprint-id'),
			isSprintLinked = this.isSprintLinkedToThisCycle(cycleId, selectedSprintId),
			cycleName = AJS.$('#zephyr-tb-link-tests-cycle-select option:selected').text(),
			sprintName = this.model.get('name'),
			selectedSprintName = '',
			instance = this,
			folderName;
			if(folderId) {
				folderName = AJS.$('#zephyr-tb-link-tests-folder-select option:selected').text();
				selectedSprintId = AJS.$('#zephyr-tb-link-tests-folder-select option:selected').data('sprint-id');
			}

		if(!isSprintLinked && (selectedSprintId && selectedSprintId != 'undefined' && selectedSprintId != 'null')) {
			var selectedSprint = ZEPHYR.Agile.TestBoard.data.sprints.get(selectedSprintId);
			if(selectedSprint) {
				selectedSprintName = selectedSprint.get('name');
			} else {
				selectedSprintName = AJS.$('#zephyr-tb-link-tests-cycle-select option:selected').data('sprint-name');
				if(!selectedSprintName)
					selectedSprintName = selectedSprintId;
			}
			if(completed)
				completed();
			this.showSaveLinkedCycleConfirmation(projectId, cycleId, folderId, versionId, cycleName, selectedSprintName, sprintName, isLinkMoreTestCycles, refreshOnCancel, folderName);
		} else {
			/**
			 * On save if not linked to sprint,
			 * if user selects to link more than show the link to Test Cycle dialog
			 */
			this.saveLinkedTestCycle(projectId, cycleId, folderId, versionId, function() {
				if(completed)
					completed();
				if(isLinkMoreTestCycles) {
					instance.selectedCycleIds.push(parseInt(cycleId));
					instance.showLinkTestCyclesDialog(projectId, versionId, isLinkMoreTestCycles, true, folderId);
				} else {
					ZEPHYR.Agile.TestBoard.globalDispatcher.trigger(ZEPHYR.Agile.TestBoard.Events.VERSION_SELECT_SPRINTS_GET);
					instance.selectedCycleIds = [];
				}
				setTimeout(function() {
					var sprintSelector = AJS.$("#zephyr-tb-sprints-module-"+instance.sprintId);
					sprintSelector.find(".sprint-module-heading").trigger("click");
				}, 1500);
			}, function() {
				if(completed)
					completed();
				instance.selectedCycleIds = [];
				setTimeout(function() {
					var sprintSelector = AJS.$("#zephyr-tb-sprints-module-"+instance.sprintId);
					sprintSelector.find(".sprint-module-heading").trigger("click");
				}, 1000);
			});

		}
    },
	fetchCyclesByVersionsAndSprint: function() {
    	var projectId = ZEPHYR.Agile.TestBoard.data.projectId,
    		sprintId = this.model.get('id'),
    		instance = this;

    	this.model.cycles.fetch({
    		reset: true,
    		type : 'POST',
    		contentType: "application/json",
			data: JSON.stringify({
				projectId:projectId,
				versionId: ZEPHYR.Agile.TestBoard.data.versionId,
				sprintId: sprintId,
				offset:0,
				expand:"executionSummaries"
			}),
			success: function(cycles, response) {
				/**
				 * Considering only response[0] and not looping because the cycles are fetched per sprintId.
				 */
				instance.cycleCount = (response[0] && response[0].cycles) ? response[0].cycles.length : 0;
				instance.displayTestCycleCount(instance.cycleCount);
				instance.$el.find(".zephyr-tb-by-issues-sprint-wait").hide();
			},
			error: function(cycles, response) {
				instance.$el.find(".zephyr-tb-by-issues-sprint-wait").hide();
				AJS.$('.zephyr-tb-message-bar').html('');
				var responseJSON = JSON.parse(response.responseText);
				var responseText = responseJSON.message || responseJSON.errorDescHtml;
				ZEPHYR.Agile.TestBoard.showErrorMessage(response, responseText, 3000);
			}
    	});
	},
	updateCycleProgressBar: function() {
		this.cyclesView.triggerSelectedClick = false;
    	this.fetchCyclesByVersionsAndSprint();
	}
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/testboard/sprint/zephyr-sprints-view.js' */
/**
 * Zephyr Test Board View
 */
if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Agile == 'undefined') { ZEPHYR.Agile = {}; }
if (typeof ZEPHYR.Agile.TestBoard == 'undefined') { ZEPHYR.Agile.TestBoard = {}; }

// Sprints
ZEPHYR.Agile.TestBoard.Sprint = Backbone.Model.extend({
	initialize: function(options) {
		this.options = options;
		/**
		 * Nested collection
		 * Sprint view: Cycle collection
		 * Issues view: Issue collection
		 */
		if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.sprint) {
			this.cycles = new ZEPHYR.Agile.TestBoard.CycleCollection();
		} else if(ZEPHYR.Agile.TestBoard.data.page == ZEPHYR.Agile.TestBoard.page.issues) {
			this.issues = new ZEPHYR.Agile.TestBoard.IssueCollection();
		}
	},
	parse: function(resp) {
		return resp;
	}
});
ZEPHYR.Agile.TestBoard.SprintCollection = Backbone.Collection.extend({
    model: ZEPHYR.Agile.TestBoard.Sprint,
    url: function() {
    	return  contextPath + "/rest/agile/1.0/board/" + ZEPHYR.Agile.TestBoard.data.agileBoardId + "/sprint";
    },
    parse: function(resp, xhr) {
    	return resp.values;
    }
});

/**
 * - SprintView - show Sprint details with list of Cycles
 * - Ability to add cycle, link test cycles. 
 * - SprintCycleDetailView
 */
ZEPHYR.Agile.TestBoard.SprintsView = Backbone.View.extend({
	events: {
		'click .zephyr-tb-cycle-content': 'displayCycleDetails'
	},
	initialize: function(options) {
		this.options = options;
		this.model.bind('reset', this.render, this);
		this.sprintRows = [];
	},	
	attachSprintView: function() {
		var instance = this;
		// TODO: cleanup previous views
		// Attach Sprint View
		_.each(this.$el.find('.zephyr-tb-sprints-module'), function(sprintEl) {
			var sprintId = AJS.$(sprintEl).data('sprint-id');
			var sprintSelector = AJS.$("#zephyr-tb-sprints-module-"+sprintId);
			var sprintState = AJS.$(sprintEl).data('sprint-state');

			sprintSelector.find(".sprint-module-heading").off("click.issues").on("click.issues", function(e, data) {
				if(AJS.$(e.target).closest(".refresh-table").length) return;
				if(!AJS.$(e.target).closest(".zephyr-tb-controls").length || !sprintSelector.hasClass("dataLoaded")) {
					if(!sprintSelector.hasClass("dataLoaded")) {
						sprintSelector.find(".zephyr-tb-by-issues-sprint-wait").show();
						var sprint = instance.model.get(sprintId);
						if(sprint) {
							var sprintView = new ZEPHYR.Agile.TestBoard.SprintView({
								el: sprintEl,
								model: sprint
							});
							instance.sprintRows.push(sprintView);
						}
						sprintSelector.addClass("dataLoaded");
					}

					if(data && data.forcedTrigger) {
						return;
					}
					
					if(!AJS.$(e.target).hasClass("zephyr-tb-toggle-custom")) {
						if(sprintSelector.hasClass("expanded")) {
							sprintSelector.addClass("collapsed").removeClass("expanded");
							sprintSelector.find(".zephyr-tb-toggle-custom").addClass("aui-iconfont-collapsed").removeClass("aui-iconfont-expanded");
						} else {
							sprintSelector.removeClass("collapsed").addClass("expanded");
							sprintSelector.find(".zephyr-tb-toggle-custom").removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded");
						}
					} else {
						if(sprintSelector.hasClass("expanded")) {
							sprintSelector.find(".zephyr-tb-toggle-custom").addClass("aui-iconfont-collapsed").removeClass("aui-iconfont-expanded");
						} else {
							sprintSelector.find(".zephyr-tb-toggle-custom").removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded");
						}
					}
				}
			});

			AJS.$("#refreshId-"+sprintId).off("click.refresh").on("click.refresh", function(e) {
				sprintSelector.find(".zephyr-tb-by-issues-sprint-wait").show();
				var sprint = instance.model.get(sprintId);
				if(sprint) {
					var sprintView = new ZEPHYR.Agile.TestBoard.SprintView({
						el: sprintEl,
						model: sprint
					});
					instance.sprintRows.push(sprintView);
				}
				sprintSelector.addClass("dataLoaded");
			});
			
			if(sprintState == "ACTIVE") {
				sprintSelector.find(".sprint-module-heading").trigger("click");  // defaultopen active sprint
			}
		});
		this.executions = new ZEPHYR.Agile.TestBoard.ExecutionCollection();
		// Attach SprintCycleDetailView
		this.sprintCycleDetailView = new ZEPHYR.Agile.TestBoard.SprintCycleDetailView({
			el: '#zephyr-tb-detail-column',
			model: this.executions
		});
		// Fix for ZFJ-1743: Displaying the defects on left
		ZEPHYR.defectHover.INLINE_DIALOG_OPTIONS.gravity =  'w';
	},
	displayCycleDetails: function(ev) {
		ev.stopImmediatePropagation();
		var targetElement = AJS.$(ev.target).closest('.zephyr-tb-cycle-content') || AJS.$(ev.target);
			cycleId = targetElement.data('cycle-id'),
			cycleName = targetElement.attr('data-cycle-name'),
			versionName = targetElement.attr('data-version-name'),
			sprintId = targetElement.data('sprint-id'),
			projectKey = targetElement.attr('data-project-key'),
			folderId = targetElement.attr('data-folder-id'),
			folderName = targetElement.attr('data-folder-name');
			
		AJS.$('.zephyr-tb-cycle-content').removeClass('zephyr-tb-selected');
		targetElement.addClass('zephyr-tb-selected');
		this.sprintCycleDetailView.cycleId = cycleId;
		this.sprintCycleDetailView.cycleName = cycleName;
		this.sprintCycleDetailView.versionName = versionName;
		this.sprintCycleDetailView.sprintId = sprintId;
		this.sprintCycleDetailView.projectKey = projectKey;
		this.sprintCycleDetailView.folderId = folderId;
		this.sprintCycleDetailView.folderName = folderName;
		
		// On page refresh this is false, so that the selectedStatus value is not cleared
		if(this.sprintCycleDetailView.clearStatus)
			ZEPHYR.Agile.TestBoard.data.selectedStatus = null;
		this.sprintCycleDetailView.render();
		/** Update URL **/
    	ZEPHYR.Agile.TestBoard.data['selectedSprint'] = sprintId;
    	ZEPHYR.Agile.TestBoard.data['selectedCycle'] = cycleId;
    	ZEPHYR.Agile.TestBoard.data['view'] = ZEPHYR.Agile.TestBoard.viewDetail;
    	ZEPHYR.Agile.TestBoard.data['isDetailView'] = true;
		ZEPHYR.Agile.TestBoard.Router.URL.setParams();
		ZEPHYR.Agile.TestBoard.Router.tbRouter.navigate(ZEPHYR.Agile.TestBoard.Router.URL.getURL(), {trigger: false}); 
	},
	getCycleCounts: function(callback) {
		var sprintIds = (_.pluck(ZEPHYR.Agile.TestBoard.data.sprints.toJSON(), 'id') || []).join(",");
		var versionIds = ZEPHYR.Agile.TestBoard.data.versionId;
		var projectId = ZEPHYR.Agile.TestBoard.data.projectId;

		AJS.$.ajax({
			url: getRestURL() + "/cycle/cyclecountBySprint",
			type : 'POST',
    		contentType: "application/json",
			data: JSON.stringify({
				"projectId": projectId,
    			"versionId": versionIds,
    			"sprintIds": sprintIds
			}),
			success: function(response) {
				callback(response);
			},
			error: function(response) {
				callback();
			}
		});	
	},
	render: function() {
		var instance = this;
		instance.getCycleCounts(function(cycleCounts) {
			var sprints = instance.model.toJSON();
			_.each(sprints, function(sprint) {
				var cycleCount = cycleCounts[sprint.id] || 0;
				sprint['cycleCount'] = AJS.format("{0} Ciclos de Prueba", cycleCount);
			});
			var sprintsHTML = ZEPHYR.Templates.TestBoard.Sprint.sprintsHTML({
				sprints: sprints
			});
			instance.$el.html(sprintsHTML);
			instance.attachSprintView();
			ZEPHYR.Agile.TestBoard.Loading.hideLoadingIndicator();
		});
		return instance;
	}
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/execution/execution-field-view.js' */
/**
 * Handles the saving, editing and canceling of an execution fields.
 * This is the parent view handles top level events like click, focusout...
 */
var issueIdOrKey;
var oldStatusKey;
var newStatusKey;
var globalzqlSearch;

var addedUnassignedOption = false;

if(!ZEPHYR.Schedule)
	ZEPHYR.Schedule = {};
  ZEPHYR.Schedule.assigneeUI = Backbone.Model.extend({});
  ZEPHYR.Schedule.assigneeView = Backbone.View.extend({
    events: {
      'click .assignee-dropDown-Trigger': 'showAssigneeDropdown',
      'keyup .ajax-input': 'getUsersList',
      'keydown .input-wrapper .ajax-input': 'traverseList',
      'hover .dropdown-list li': 'selectDropdownLi',
      'click .dropdown-list li': 'updateAssigneeUI',
      'click .remove-assignee': 'updateAssigneeUI',
      'click .ajax-input':      '_stopImmediatePropagation',
    },
    model: ZEPHYR.Schedule.assigneeUI,
    initialize: function(options){
        this.options = options;
      if (this.model) {
          this.model.on('change:renderAssigneeUI', this.render, this);
      }
    },
    _stopImmediatePropagation: function(ev) {
      ev.stopImmediatePropagation();
    },
    showAssigneeDropdown: function(ev) {
		ev.stopPropagation();
		ev.preventDefault();
		ev.stopImmediatePropagation();
      	var scheduleId = ev.currentTarget.dataset.scheduleid;
	  	var field = ev.currentTarget.dataset.field;
	  	if (!addedUnassignedOption) {
			addedUnassignedOption = true;
			AJS.$('#execution-select-assignee-' + scheduleId).find('.dropdown-list').append('<li data-scheduleid="null" data-assignee="null" data-displayname="Unassigned"><span class="user-name-image">U</span><span class="user-name-container">Unassigned</span></li>');
		}
      	var dropDownContainer = AJS.$(this.$el).find('#execution-select-assignee-' + scheduleId);
      	if(dropDownContainer.hasClass('active')) {
        	dropDownContainer.removeClass('active');
      	} else {
        	dropDownContainer.addClass('active');
	    }
      	AJS.$('#execution-select-assignee-' + scheduleId).find('input').focus();
    },
    
    updateAssigneeUI: function(ev) {
	    ev.stopPropagation();
	    ev.preventDefault();
		ev.stopImmediatePropagation();
		
		
		var assigneeValue = ev.currentTarget.dataset.displayname;
		if (!!assigneeValue) {
			AJS.$('#bulk-assign-user-form-submit').prop('disabled', false);
		} else {
			AJS.$('#bulk-assign-user-form-submit').prop('disabled', true);
		}
		addedUnassignedOption = false;

      var scheduleId = ev.currentTarget.dataset.scheduleid;
      var data = !ev.currentTarget.dataset.assignee ? {changeAssignee: true} : {
        assignee: ev.currentTarget.dataset.assignee,
        assigneeType: 'assignee',
        changeAssignee: true
      }

      if(!scheduleId || scheduleId == 'null') {
        var _assignee = {
          "executionId": null,
          "assignee": data.assignee,
          "assigneeType": data.assigneeType,
          "assigneeDisplay": ev.currentTarget.dataset.displayname,
        };
        assigneeUI.set('assignee', _assignee);
        assigneeUI.set('contextPath', contextPath);
        assigneeUI.set('renderAssigneeUI' , !assigneeUI.get('renderAssigneeUI'));
        return;
      }
      jQuery.ajax({
        url: getRestURL() + '/execution/' + scheduleId + '/execute',
        type : "PUT",
        data: JSON.stringify(data),
        contentType :"application/json",
        dataType: 'json',
        success: function(response) {
          //debugger;
			var _assignee = {
			"executionId": response.id,
			"assignee": response.assignedTo,
			"assigneeDisplay": htmlDecode(response.assignedToDisplay),
			"assigneeUserName": response.assignedToUserName,
			"assigneeType": response.assigneeType
			};

			ZEPHYR.Schedule.Execute.updateExecutionHistory();
			assigneeUI.set('assignee', _assignee);
			assigneeUI.set('contextPath', contextPath);
			assigneeUI.set('renderAssigneeUI' , !assigneeUI.get('renderAssigneeUI'));


			// if (!window.standalone && AJS.$('#zqltext')[0] && AJS.$('#zqltext')[0].value.length != 0) {
			// 	setTimeout(function () {
			// 		ZEPHYR.ZQL.maintain = true;
			// 		if (AJS.$('#zephyr-transform-all') && AJS.$('#zephyr-transform-all')[0]) {
			// 			AJS.$('#zephyr-transform-all')[0].click();
			// 		}
			// 	}, 1000)
			// }

        }
      });
  },

  selectDropdownLi: function(ev) {
    var liOptions = AJS.$('.dropdown-list li');
    for (var i=0;i<liOptions.length;i++) {
          liOptions[i].classList.remove("active");
    }
    ev.target.classList.add("active");
    },

  traverseList: function(ev) {
    //ev.preventDefault();
    if(ev.keyCode == 38 || ev.keyCode == 40 || ev.keyCode == 13) {
       
      var currentIndex = -1;
      var newIndex = 0;
      var liOptions = AJS.$('.dropdown-list li');
      for (var i=0;i<liOptions.length;i++) {
        if (liOptions[i].className.indexOf('active') > -1) {
          currentIndex = i;
          liOptions[i].classList.remove("active");
          break;
        }
      }

      if (ev.keyCode == 38) {
        newIndex =  Math.max(currentIndex - 1,0);
        liOptions[newIndex].classList.add("active");
      } else if (ev.keyCode == 40) {
        newIndex = Math.min(currentIndex + 1,liOptions.length - 1);
        liOptions[newIndex].classList.add("active");
      } else if (ev.keyCode == 13 && currentIndex > -1) {
        liOptions[currentIndex].click();
      }

      ev.stopPropagation();
      ev.preventDefault();
      ev.stopImmediatePropagation();

    }

  },

  getUsersList: function(ev) {
	var searchQuery = ev.target.value;
    ev.preventDefault();
    ev.stopImmediatePropagation();
    //console.log('test', ev, ev.target.value);
    if (!([38,40,13].indexOf(ev.keyCode) > -1)) {
      var scheduleId = ev.currentTarget.dataset.scheduleid;
      var dropDownContainer = AJS.$(this.$el).find('#execution-select-assignee-' + scheduleId);
      var restPath = "/rest/api/1.0/users/picker";
      jQuery.ajax({
        url: contextPath + restPath,
        type : "GET",
        data: {
          query: ev.target.value,
          showAvatar: true
        },
        contentType :"application/json",
        dataType: 'json',
        success: function(response) {
			if (AJS.$('#userName')[0] && AJS.$('#userName')[0].dataset && AJS.$('#userName')[0].dataset.user) {
				var existingName = AJS.$('#userName')[0].dataset.user;
				if (response.users && response.users.length > 0) {
					for (var counter = 0; counter < response.users.length; counter += 1) {
						if (response.users[counter].name == existingName) {
							response.users.splice(counter, 1)
							var tempTotal = response.total;
							response.total -= 1;
							response.footer = response.footer.replace(new RegExp(tempTotal.toString(), 'g'), response.total.toString());
							break;
						}
					}
				}
			}

			AJS.$(dropDownContainer).find('.dropdown-list').html("");
			if (response.users) {
				for (var counter = 0; counter < response.users.length; counter += 1) {
					if (response.users[counter].avatarUrl.indexOf('avatarId') < 0) {
						var tempAvatarNameArray = response.users[counter].displayName.split(" ");
						response.users[counter].userNameAvatar = '';
						if (tempAvatarNameArray[0] && tempAvatarNameArray[0][0]) {
							response.users[counter].userNameAvatar += tempAvatarNameArray[0][0];
						}
						if (tempAvatarNameArray[1] && tempAvatarNameArray[1][0]) {
							response.users[counter].userNameAvatar += tempAvatarNameArray[1][0];
						}
					}

				}
				var template = ZEPHYR.Templates.Execution.Assignee.executionAssigneeViewAjaxUI({
					users: response.users && response.users.length ? response.users : [],
					footer: response.footer,
					scheduleId: scheduleId
				});
				AJS.$(dropDownContainer).find('.dropdown-list').html(template);
			}

			// ZFJ-3296 - Added Unassigned as an option in dropdown for bulk user selection
			if (searchQuery.length === 0 && !response.users) {
				addedUnassignedOption = true;
		  		AJS.$('#execution-select-assignee-' + scheduleId).find('.dropdown-list').append('<li data-scheduleid="null" data-assignee="null" data-displayname="Unassigned"><span class="user-name-image">U</span><span class="user-name-container">Unassigned</span></li>');
			}
  		}
      });
    }
  },
  render: function() {
    var html = ZEPHYR.Templates.Execution.executionAssigneeDetailView({
      assignee:   this.model.get('assignee'),
      contextPath: this.model.get('contextPath')
    });
    AJS.$(this.$el).html(html);
    }
  });

var assigneeUI = new ZEPHYR.Schedule.assigneeUI({
    contextPath: '',
    assignee: {}
});

AJS.$(document).on("appendAssigneeUI", function(event, _assignee, contextPath, selector) {
  var assigneeUIInstance = new ZEPHYR.Schedule.assigneeView({
    el: selector ? selector : '#exec-assignee-wrapper',
    model: assigneeUI
  });
  assigneeUI.set('assignee', _assignee);
  assigneeUI.set('contextPath', contextPath);
  assigneeUIInstance.render();

});

ZEPHYR.Schedule.executionFieldView = Backbone.View.extend({
	events: {
		'click .cancel': 						'cancelUpdate',
		'keyup':								'cancelOnKeyup',
		'click .zfj-editable-field':			'editField',
		'click .zfj-editable-field a.assignee-user-hover':			'_stopImmediatePropagation',
		'focusout select':						'saveFieldOnUpdate',
		'click .status-dropDown-Trigger':    'openStatusDropdown',
		'click .updateStatus':     'updateStatus',
		'mousedown': 							"saveSelectedText",
		'click .zfj-field-button-save': 		"saveFieldOnClick",
		'change select' :  "saveFieldOnClick",
		'click #execution-assignee-remove' : "removeAssignee",
    "keydown span[id^=executionStatus-trigger]"         : "traverseStatus",
    "hover [id^=execution-field-dropDown-schedule] li"          : "highlightStatusLi",
	},

	initialize: function() {
		this.decorate();
		this._editDelay = 0;
    this.currentStatusIndx = -1;
	},

	_stopImmediatePropagation: function(ev) {
		ev.stopImmediatePropagation();
	},

	/**
	 * Decorate the editable container
	 */
	decorate: function() {
		this.$el.addClass("inactive");
	},

    _handleEditingStarted: function (focus) {
        // Ensure the field being focused is not disabled (throws an error in IE8)
        this.$el.find(":input").prop("disabled", false);

        this.$el.find(":input:visible:first").focus();

        this.$el.find('.update_cancel-buttons').attr('tabindex', 1);
    },

    /**
     * The view is put into saving mode and any input is disabled to prevent changes whilst the save request is in flight.
     * Display the loading cursor
     */
    _handleSavingStarted: function () {
    	this.$el.find(":input").prop("disabled", true);
        // Attaching the loading icon
        ZEPHYR.Loading.showLoadingIndicator();
    },

    /**
     * Transitions the view into the view state.
     */
    _displayWriteMode: function () {
        this.$el.addClass("inactive").removeClass("active");
        this.$el.find('.update_cancel-buttons').removeAttr('tabindex');
    },

	/**
     * Transitions the view into the edit state.
     */
    _displayEditMode: function() {
    	this.options.elBeforeEdit.hide();
    	this.options.elOnEdit.show();
    	this.$el.removeClass("inactive").addClass("active");
    	this._handleEditingStarted();
       // this.focus();
        this.containerHasFocus = true;
        this.trigger('editField');
    },

    focus: function () {
        // Ensure the field being focused is not disabled (throws an error in IE8)
        this.$el.find(":input").removeAttr("disabled");

        var $element = this.$el.find(":input:visible:first");
        $element.focus();
    },

    highlightStatusLi : function(e) {
      var statusLi = AJS.$('[id^=execution-field-dropDown-schedule] li');
           for(var i=0;i<statusLi.length;i++) {
            statusLi[i].classList.remove('active');
           }
      e.currentTarget.classList.add('active');
      this.currentStatusIndx = parseInt(e.currentTarget.dataset.index) || -1;
    },

    traverseStatus : function(e) {
      if(e.keyCode == 38 || e.keyCode == 40 || e.keyCode == 13) {
        this.currentStatusIndx = parseInt(this.currentStatusIndx);
             var newIndex = this.currentStatusIndx;
             var statusLi = AJS.$('[id^=execution-field-dropDown-schedule] li');
             for(var i=0;i<statusLi.length;i++) {
              statusLi[i].classList.remove('active');
             }

             if (e.keyCode == 38) {
               newIndex =  Math.max(this.currentStatusIndx - 1,0);
               if (statusLi[newIndex].className.indexOf('selected') > -1) {
                newIndex =  Math.max(this.currentStatusIndx - 2,0);
               }
               statusLi[newIndex].classList.add('active');
               AJS.$('.execution-field-dropDown-container.active')[0].scrollTop -= 23; //Hieght of li element
             } else if (e.keyCode == 40) {
               newIndex = Math.min(this.currentStatusIndx + 1,statusLi.length - 1);
               if (statusLi[newIndex].className.indexOf('selected') > -1) {
                if (newIndex == statusLi.length - 1) {
                  newIndex =  newIndex - 1;
                } else {
                  newIndex =  Math.min(this.currentStatusIndx + 2,statusLi.length - 1);
                }
               }
              statusLi[newIndex].classList.add('active');

               if (newIndex != 0) {
                AJS.$('.execution-field-dropDown-container.active')[0].scrollTop += 23;  //Hieght of li element
               }
             } else if (e.keyCode == 13 && this.currentStatusIndx > -1) {
               //statusLi[this.currentStatusIndx].click();
               this.currentStatusIndx = -1;
             }
             this.currentStatusIndx = newIndex;
             e.preventDefault();
        }
    },


    /**
     * Cancels editing when an escape key is encountered
     * @param e {Event}
     */
    cancelOnKeyup: function (ev) {
        if(ev.keyCode === 27) {
            this.cancelUpdate(ev)
        }
    },

    /**
     * Cancels editing when cancel button is clicked.
     * @param e {Event}
     */
    cancelUpdate: function (ev) {
    	ev.preventDefault();
        ev.stopImmediatePropagation();

        this.containerHasFocus = false;
        this.trigger('cancelSaveField');
		AJS.$(this.options.elOnEdit).hide();
		AJS.$(this.options.elBeforeEdit).show();
		this._displayWriteMode();
    },

	/**
	 * If the field is updated, check if the element is focused or not
	 * If true trigger the save
	 */
 	openStatusDropdown: function(ev) {
		var scheduleId = ev.currentTarget.dataset.scheduleid;
		var dropDownContainer = AJS.$('#execution-field-dropDown-schedule-' + scheduleId);

    if(dropDownContainer.hasClass('active')) {
			AJS.$('.execution-field-dropDown-container').removeClass('active');
		} else {
			dropDownContainer.addClass('active');
		}
		ev.stopPropagation();
		ev.preventDefault();

 	},
	updateStatus: function(ev) {
		var scheduleId = (AJS.$(ev.currentTarget).parents('.dropDown-options-wrapper')[0].dataset.scheduleid);
		var newStatusId = ev.currentTarget.dataset.value;
		var color = ev.currentTarget.dataset.color;
		var content = ev.currentTarget.dataset.str;

		ZEPHYR.Schedule.performExecution(scheduleId, newStatusId, function() {
			var parentContainer = AJS.$('#executionStatus-value-schedule-' + scheduleId +' .execution_status_wrapper');
			parentContainer.find('.status-readMode').css("background",color).html(content);

			parentContainer.find('.execution-field-dropDown-container li').each(function(){
				if(this.dataset.value === newStatusId) {
					AJS.$(this).addClass('selected');
				} else {
					AJS.$(this).removeClass('selected');
				}
			});

			//For ZFJ-5004 : filter after status update if filter selected
			if(AJS.$('#zephyr-tb-status-dd').val()) {
				AJS.$('#zephyr-tb-status-dd').trigger("change");
			}

			// if (!window.standalone && AJS.$('#zqltext')[0] && AJS.$('#zqltext')[0].value.length != 0) {
			// 	setTimeout(function () {
			// 		ZEPHYR.ZQL.maintain = true;
			// 		if (AJS.$('#zephyr-transform-all') && AJS.$('#zephyr-transform-all')[0]) {
			// 			AJS.$('#zephyr-transform-all')[0].click();
			// 		}
			// 	}, 1000)
			// }
		}, function() {});

		AJS.$('.execution-field-dropDown-container.active').removeClass('active');
		ev.stopPropagation();
		ev.preventDefault();
	},

	saveFieldOnUpdate: function(ev) {
		var timeout;
		var BLUR_FOCUS_TIMEOUT = 150;
		var instance = this;
		if(ev.target.getAttribute('data-issueId')) {
				issueIdOrKey = ev.target.getAttribute('data-issueId');
		}

		if(this.containerHasFocus) {
			if (timeout) clearTimeout(timeout);
            timeout = setTimeout(function(ev) {
            	if(instance.containerHasFocus && instance.$el.hasClass("active")) {
            		instance.trigger('saveField', ev);
            		instance._displayWriteMode();
            	}
            }, BLUR_FOCUS_TIMEOUT, ev);
		}

	},

	removeAssignee : function(ev) {
		ev.preventDefault();
		ev.stopPropagation();
		this.trigger('removeAssigneeOnClick', ev);
	},

	saveFieldOnClick: function(ev) {
		ev.preventDefault();
		this.trigger('saveFieldOnClick', ev);
	},

	editField: function(ev) {
	   ev.preventDefault();
       var iconWasClicked = AJS.$(ev.target).is(".zfj-overlay-icon");
       var isEditable = this.$el.hasClass("inactive");
       var noTextSelected = this._getCurrentlySelectedText() === "" && !this._previouslySelectedText;
       var shouldEnterEditMode = isEditable && (iconWasClicked || noTextSelected);

       if (this._editDelay !== 0) {
           // A click event was received while a pending inline edit request was
           // in progress. Cancel this request, since the user is double-clicking
           // or triple-clicking instead.
           clearTimeout(this._editDelay);
           this._editDelay = 0;

       } else if (shouldEnterEditMode) {
           var self = this;

           // Wait briefly to allow the user the opportunity to double-click.
           // Double-clicks will abort the pending transition to inline edit mode.
           this._editDelay = setTimeout(function() {
               if (self.$el.hasClass("inactive") && self._getCurrentlySelectedText() === "") {
                   self._displayEditMode();
               }
               self._editDelay = 0;
           }, 250);
       }
   },

   _getCurrentlySelectedText: function() {
       if (jQuery(document.activeElement).is(":input")) {
           // Text selections inside form elements are not considered.
           return "";
       }
       if (document.selection && document.selection.createRange) {
           return document.selection.createRange().text || "";
       }
       if (window.getSelection) {
           return window.getSelection().toString();
       }
       return "";
   },

	// Remove the loading icon, hide the dropdown and display the updated status
	updateUIOnAction: function() {
		ZEPHYR.Loading.hideLoadingIndicator();
		AJS.$(this.options.elOnEdit).hide();
		AJS.$(this.options.elBeforeEdit).show();
		// Removing the active class on the cycle component's
		this.$el.closest('#zfjissuetable').siblings('.zfj-notifications').removeClass('active');
	},

	/**
     * Text selection is cleared after mousedown; this method stores it in an
     * instance variable so we can determine in onEdit if selection was cleared.
     */
    saveSelectedText: function() {
        this._previouslySelectedText = this._getCurrentlySelectedText();
    }
});

/*
 * ---------------------------------------------------
 * Functions and view related to execution Status
 * ---------------------------------------------------
 */
ZEPHYR.Schedule.performExecution = function(scheduleId, newStatusId, successCallback, errorCallback) {
	var req = jQuery.ajax({
		url: getRestURL() + "/execution/"+ scheduleId + "/execute",
		type : "PUT",
		contentType :"application/json",
		dataType: "json",
		data:JSON.stringify( {
			'status': newStatusId,
			'changeAssignee': false
		}),
		success : function(response) {
			var execution = response;
			var statusMap = {};
      if (execution.executionSummaries) {
  			JSON.parse(execution.executionSummaries).executionSummary.map(function(status) {
  				statusMap[status.statusKey] = {
  					name: status.statusName ,
  					id: status.statusKey,
  					color: status.statusColor,
  					description: status.statusDescription || '',
  				}
  			});
  			ZEPHYR.Execution.currentSchedule = {
  				'statusObj': {
  					currentExecutionStatus: {
  						color: statusMap[execution.executionStatus].color,
  						description: statusMap[execution.executionStatus].description || '',
  						id: statusMap[execution.executionStatus].id,
  						name: statusMap[execution.executionStatus].name,
  					},
  					executionStatuses: statusMap,
  				}
  			}
      }
			if(AJS.$('.zephyr-tb-issue-compact .zephyr-tb-versions-table-progress').length > 0) {
				var progressBar = AJS.$('#issueBoard-progressBar-' + issueIdOrKey);
				var totalExecutions =  AJS.$('#issueBoard-progressBar-' + issueIdOrKey).find('.zephyr-tb-version-progress-percentage').attr('totalExecutions');
				var totalExecuted = 0;
				var summaryList = {};
				if(response.executionSummaries) {
					var executionSummaries = JSON.parse(response.executionSummaries);
					executionSummaries.executionSummary.forEach(function(status){
						summaryList[status.statusKey] = 0;
					});

					if(newStatusKey >= -1) {
						summaryList[newStatusKey]++;
					}

					AJS.$('#issueBoard-progressBar-' + issueIdOrKey + ' .zephyr-tb-progressbar-entry').each(function(){
						summaryList[AJS.$(this).attr('statuskey')] = summaryList[AJS.$(this).attr('statuskey')] + Number(AJS.$(this).attr('statusCount'));
					});

					if(oldStatusKey >= -1) {
						summaryList[oldStatusKey]--;
					}

					executionSummaries.executionSummary.forEach(function(status){
						status.count = summaryList[status.statusKey];
						if(status.statusKey !== -1) {
							totalExecuted = totalExecuted + summaryList[status.statusKey];
						}
					});

					progressBar.html(ZEPHYR.Templates.TestBoard.versionProgressHTML({
						summaryList: executionSummaries,
						totalExecutions: totalExecutions
					}));
					progressBar.append('<span totalExecuted='+ totalExecuted +' totalExecutions='+ totalExecutions + ' class="zephyr-tb-version-progress-percentage">' + ((totalExecuted*100/totalExecutions).toFixed(2)) + '%</span>')
				}
			}

			//We need to update status only for Schedules. In case of step execution, we dont show it right now. Hence those elements will not be present.
			if(AJS.$("#executed-by-schedule-" + scheduleId).length > 0){
				var _executedBy = AJS.$("#executed-by-schedule-" + scheduleId)
				var _executedOn = AJS.$("#executed-on-schedule-" + scheduleId)
				if(execution.executedBy != null) {
					AJS.$("#executed-by-schedule-"+ scheduleId).parent().show();
          AJS.$("#executed-on-schedule-"+ scheduleId).parent().show();
            
					var executedByString = "<a href='"+ contextPath +"/secure/ViewProfile.jspa?name="+ execution.executedBy +"' rel='"+ execution.executedBy +"' class='zephyr-user-hover'>" + AJS.escapeHtml(htmlDecode(execution.executedByDisplay)) + "</a>";
					_executedBy.html("<strong>" + executedByString + "</strong>");
					_executedOn.html("<strong>" + execution.executedOn + "</strong>");
					_executedBy.fadeTo(1000, 0.5, function() {AJS.$(this).css('opacity', ''); AJS.$(this).html(executedByString)});
					_executedOn.fadeTo(1000, 0.5, function() {AJS.$(this).css('opacity', ''); AJS.$(this).html(execution.executedOn)});
				}
				else{
					//AJS.$("#executed-by-"+ source.sourceType + "-" + source.sourceId).parent().hide();
					_executedBy.html("");
					_executedOn.html("");
				}
        if(globalzqlSearch){
          if(globalzqlSearch.get('status')[response.executionStatus]){
            AJS.$("#exe-status-"+ scheduleId).css("border-color", globalzqlSearch.get('status')[response.executionStatus].color);
            AJS.$("#exe-status-"+ scheduleId).text(globalzqlSearch.get('status')[response.executionStatus].name);
            for (var i = 0; i < cycleObj.length; i++) {
              if(cycleObj[i].id == response.id){
                cycleObj[i].status = globalzqlSearch.get('status')[response.executionStatus];
                break;
              }
            }
          }
        }
			}
			/*Update the model - only applicable for ExecuteTest*/
			if(ZEPHYR.Schedule && ZEPHYR.Schedule.Execute && ZEPHYR.Schedule.Execute.currentSchedule){
				ZEPHYR.Schedule.Execute.currentSchedule.set(execution)
			}

			if(successCallback){
				successCallback();
			}

      AJS.$(document).trigger( "updateExecutionModel", [response] );
			showExecStatusSuccessMessage();
      AJS.$(document).trigger( "updateGridAndTree");
			for (var counter = 0; counter < AJS.$('#exec_status-schedule-' + scheduleId + ' li').length; counter += 1) {
				AJS.$('#exec_status-schedule-' + scheduleId + ' li')[counter].classList.remove('selected');
				if (parseInt(AJS.$('#exec_status-schedule-' + scheduleId + ' li')[counter].dataset.value) == newStatusId) {
					AJS.$('#exec_status-schedule-' + scheduleId + ' li')[counter].classList.add('selected');
				}
			}
		},
		error: function(response) {
			// Hide the loading indicator on error
      // Callback to handle status 403's error condition
			if(response.status == 403 && errorCallback && typeof errorCallback === 'function') {
				errorCallback();
			}
			ZEPHYR.Loading.hideLoadingIndicator();
			if(response && response.status == 403) {
				var _responseJSON = {};
				try {
					_responseJSON = jQuery.parseJSON(response.responseText);
				} catch(e) {
					console.log(e);
				}
				if(_responseJSON.PERM_DENIED) {
					showPermissionError(response);
					return;
				}
			}
			if(response && typeof buildExecutionError == 'function')
				buildExecutionError(response);
			else if(response.status == 401){
				var dialog = new AJS.Dialog({
		 		    width:540,
		 		    height: 200,
		 		    id:	"dialog-error"
		 		});
			 	dialog.addHeader("\u00a1Error!");

			 	dialog.addPanel("panel-1", "<p></p>", "dialog-error-panel-body");
			 	AJS.messages.error(AJS.$('.dialog-error-panel-body'), {
				    body: "No tiene permiso para realizar esta solicitud. Inicio de sesi\u00f3n requerido.",
				    closeable: false
				});

			 	dialog.addLink("Close", function (dialog) {
			 	    dialog.hide();
			 	}, "#");
		 		dialog.show();
			}
			if(errorCallback && typeof errorCallback === 'function') {
				errorCallback();
			}
		}
	});
	// // Callback to handle status 403's error condition
	// req.error(function(jHR) {
	// 	if(jHR.status == 403 && errorCallback)
	// 		errorCallback();
	// });
}

ZEPHYR.Schedule.stripTextIfMoreThanAllowed = function(selector, selectedText, maxlength, title) {
	AJS.$(selector).css("text-overflow", "ellipsis");
	// AJS.$(selector).css("overflow", "hidden");
	AJS.$(selector).css("white-space", "nowrap");
	if(title)
		AJS.$(selector).attr("title", title);
}

ZEPHYR.Schedule.getSourceInfoForStatusExecution = function(eventSourceId){
	//Execution Status element DIV ids are created in following manner
	//execution-field-current-status-<sourceType>-<sourceId>, exec_status-<sourceType>-<sourceId>
	//execution-field-select-<sourceType>-<sourceId>
	//current-execution-status-dd-<sourceType>-<sourceId>
	//executionStatus-labels-<sourceType>-<sourceId>
	//where sourceType -> "schedule" OR "step" and sourceId -> scheduleId OR teststepId

	//when user clicks on pencil icon, executionStatus-labels-<sourceType>-<sourceId> get's available in event source ID
	//so we will return the last two tokens from this.
	if(eventSourceId) {
        var sourceElementArray = eventSourceId.split("-");
        var sourceTag = sourceElementArray[sourceElementArray.length - 2] + "-" + sourceElementArray[sourceElementArray.length - 1];
        var sourceId = sourceElementArray[sourceElementArray.length - 1];
        var sourceType = sourceElementArray[sourceElementArray.length - 2];
        return {sourceTag: sourceTag, sourceId: sourceId, sourceType: sourceType}
    }
}

ZEPHYR.Schedule.executionStatusView = ZEPHYR.Schedule.executionFieldView.extend({
	initialize: function(options) {
	    this.options = options;
		_.bindAll(this, 'removeDOMListeners');
		this.bind('saveField', this.saveExecutionStatus, this);
		this.bind('cancelSaveField', this.cancelStatusUpdate, this);
		ZEPHYR.Schedule.executionFieldView.prototype.initialize.call(this);
		this.source = ZEPHYR.Schedule.getSourceInfoForStatusExecution(options.elOnEdit.attr('id'));
		// Remove event handlers associated to the view when element is removed from the DOM.
		this.$el.on("remove", this.removeDOMListeners);
	},

	removeDOMListeners: function() {
	    this.unbind();
	    // Check for older Backbone versions which does not have this.stopListening()
	    if (typeof this.stopListening == 'function')
	    	this.stopListening();
	},

	cancelStatusUpdate: function(ev) {
		var readOnlyStatusDiv = AJS.$("#execution-field-current-status-" + this.source.sourceTag);
		AJS.$("#exec_status-" + this.source.sourceTag).val(readOnlyStatusDiv.find("a span").attr('rel'));
	},

	saveExecutionStatus: function() {
		var source						= this.source;
		var EXEC_STATUS_TEXT_MAX_LENGTH	= 12;
		var instance = this;

		this._handleSavingStarted();

		var readOnlyStatusDiv = AJS.$("#execution-field-current-status-" + source.sourceTag);
		if(!readOnlyStatusDiv.length)
			readOnlyStatusDiv = AJS.$('a#executionStatus-labels-' + source.sourceTag)
		var dropdown = AJS.$("#exec_status-"+ source.sourceTag);
		var oldStatusId = readOnlyStatusDiv.find("a span").attr('rel') || AJS.$('a#executionStatus-labels-' + source.sourceTag).find("span").attr('rel');
		var newStatus = AJS.$("#exec_status-" + source.sourceTag +" :selected").text();
		var newStatusId = AJS.$("#exec_status-" + source.sourceTag +" :selected").val();
		if(newStatus.indexOf('<') > -1) {
			newStatus = newStatus.replace(/</gi, '&lt;');
		}
		if(newStatus.indexOf('>') > -1) {
			newStatus = newStatus.replace(/>/gi, '&gt;');
		}
		if(oldStatusId == newStatusId){
			this.updateUIOnAction();
			console.log('Nothing saved, hence skipping save');
			return;
		}
		oldStatusKey = oldStatusId;
		newStatusKey = newStatusId;
		var statusDescription = AJS.$("#exec_status-" + source.sourceTag +" :selected").attr("title");

		var color = AJS.$("#exec_status-" + source.sourceTag +" option:selected").attr("rel");
		var currentExecutionStatusDD = AJS.$("#current-execution-status-dd-" + source.sourceTag )
		currentExecutionStatusDD.css("background-color", color);
		currentExecutionStatusDD.html(newStatus);
		readOnlyStatusDiv.find("a span").attr('rel', newStatusId);
		AJS.$('a#executionStatus-labels-' + source.sourceTag).find("span").attr('rel', newStatusId);

		//alert Text if greater than allowed
		var title = newStatus + (statusDescription ? ": " + statusDescription : '');
		ZEPHYR.Schedule.stripTextIfMoreThanAllowed("#current-execution-status-dd-" + source.sourceTag, newStatus, EXEC_STATUS_TEXT_MAX_LENGTH, title);

		this.$el.closest('#zfjissuetable').siblings('.zfj-notifications').addClass('active');
		//Execute given test step or schedule to change the status for the same.
		ZEPHYR.Schedule.performExecution(source.sourceId, newStatusId, function(){
			var cycleListElement = currentExecutionStatusDD.parents("li[id^='cycle']");
			if(cycleListElement.length > 0){
				//jQuery(document).trigger("ScheduleUpdated", response);
				AJS.$(cycleListElement).trigger('refresh');
			}
			instance.updateUIOnAction();

			/* ExecNavigator listen to this event for quick execution
			 * Need to remove this once we internalize statusUpdate inside the backbone views
			 */
			if(typeof globalDispatcher != 'undefined'){
				globalDispatcher.trigger('scheduleUpdated');
			} else {
				jQuery(document).trigger("ScheduleUpdated", source.sourceId);
			}

			//For ZFJ-5004 : filter after status update if filter selected
			if(AJS.$('#zephyr-tb-status-dd').val()) {
				AJS.$('#zephyr-tb-status-dd').trigger("change");
			}
		}, function() {
			var oldStatusEl = dropdown.find('option[value=' + oldStatusId+ ']');
			dropdown.val(oldStatusId);
			currentExecutionStatusDD.css("background-color", oldStatusEl.attr('rel'));
			currentExecutionStatusDD.html(oldStatusEl.text());
			readOnlyStatusDiv.find("a span").attr('rel', oldStatusId);
			instance.updateUIOnAction();
		});
	}
});

ZEPHYR.Schedule.executionAssigneeView = ZEPHYR.Schedule.executionFieldView.extend({
	initialize: function(options) {
	    this.options = options;
		_.bindAll(this, 'removeDOMListeners');
		this.bind('editField', this.attachExecutionAssignee, this);
		this.bind('saveFieldOnClick', this.saveExecutionAssignee, this);
		this.bind('removeAssigneeOnClick', this.removeExecutionAssignee, this);
		this.bind('cancelSaveField', this.cancelStatusUpdate, this);
		ZEPHYR.Schedule.executionFieldView.prototype.initialize.call(this);
		this.source = ZEPHYR.Schedule.getSourceInfoForStatusExecution(options.elOnEdit.attr('id'));
		// Remove event handlers associated to the view when element is removed from the DOM.
		this.$el.on("remove", this.removeDOMListeners);
	},

	removeDOMListeners: function() {
	    this.unbind();
	    // Check for older Backbone versions which does not have this.stopListening()
	    if (typeof this.stopListening == 'function')
	    	this.stopListening();
	},

	cancelStatusUpdate: function(ev) {
		var readOnlyStatusDiv = AJS.$("#execution-field-current-assignee-" + this.source.sourceTag);
		AJS.$('input[name=zephyr-je-execution-assignee-quick-' + this.source.sourceId + '-type]').removeAttr('checked');
		AJS.$("#exec_assignee-" + this.source.sourceTag).val(readOnlyStatusDiv.find("a span").attr('rel'));
		this.options.elOnEdit.find('#assignee-error').html('');
	},

	updateAssigneeUIOnSave: function(response) {
		var _executionAssignee = '&nbsp;';

		if(response.assignedToUserName) {
			_executionAssignee = '<a href="{$contextPath}/secure/ViewProfile.jspa?name=' + response.assignedToUserName +'" rel="' + response.assignedToUserName +'" class="assignee-user-hover zephyr-user-hover">' + response.assignedToDisplay +'</a>';
		} else {
			if(response.assignedToDisplay)
				_executionAssignee = response.assignedToDisplay;
			else if(response.assignedTo)
				_executionAssignee = response.assignedTo;
		}
		if(!response.assignedToUserName && !response.assignedToDisplay && !response.assignedTo) {
			this.options.elBeforeEdit.find('#execution-assignee-label')
				.html('')
				.attr('data-assigneeUserName', (response.assignedToUserName || null))
				.attr('data-assigneeType', (response.assigneeType || null));
		} else {
			this.options.elBeforeEdit.find('#execution-assignee-label')
				.html('<div class="execution-assignee-wrapper"><strong>' + _executionAssignee + '</strong><span id="execution-assignee-remove" class="aui-icon aui-icon-small aui-iconfont-remove-label"></span></div>')
				.attr('data-assigneeUserName', (response.assignedToUserName || null))
				.attr('data-assigneeType', (response.assigneeType || null));
		}


		AJS.$('#executiondetails-refresh').trigger('click');
		this._displayWriteMode();
		this.updateUIOnAction();
	},

	saveExecutionAssignee: function() {
		var assigneeParams = ZEPHYR.Execution.AssigneeNewUI.getSelectedParams('zephyr-je-execution-assignee-quick-' + this.source.sourceId),
			instance = this;

		if(!assigneeParams)
    		return;

		assigneeParams['changeAssignee'] = true; // Set flag changeAssignee
		var req = jQuery.ajax({
			url: getRestURL() + "/execution/"+ instance.source.sourceId + "/execute",
			type : "PUT",
			contentType :"application/json",
			dataType: "json",
			data: JSON.stringify(assigneeParams),
			success : function(response) {
				instance.updateAssigneeUIOnSave(response);
				AJS.$(document).trigger( "updateExecutionModel", [response] );
			},
			error: function(response) {
				AJS.$('#exec_assignee_cancel-schedule-' + instance.source.sourceId).click();
				if(response && typeof buildExecutionError == 'function')
					buildExecutionError(response);
				else if(response.status == 401){
					var dialog = new AJS.Dialog({
			 		    width:540,
			 		    height: 200,
			 		    id:	"dialog-error"
			 		});
				 	dialog.addHeader("\u00a1Error!");

				 	dialog.addPanel("panel-1", "<p></p>", "dialog-error-panel-body");
				 	AJS.messages.error(AJS.$('.dialog-error-panel-body'), {
					    body: "No tiene permiso para realizar esta solicitud. Inicio de sesi\u00f3n requerido.",
					    closeable: false
					});

				 	dialog.addLink("Close", function (dialog) {
				 	    dialog.hide();
				 	}, "#");
			 		dialog.show();
				}
			}
		});
		// Callback to handle status 403's error condition
		// req.error(function(jHR) {
		// 	if(jHR.status == 403)
		// 		AJS.$('#exec_assignee_cancel-schedule-' + instance.source.sourceId).click();
		// });
	},

	removeExecutionAssignee : function() {
		var assigneeParams = {},
			instance = this;

		if(!assigneeParams)
    		return;

		assigneeParams['changeAssignee'] = true; // Set flag changeAssignee
		var req = jQuery.ajax({
			url: getRestURL() + "/execution/"+ instance.source.sourceId + "/execute",
			type : "PUT",
			contentType :"application/json",
			dataType: "json",
			data: JSON.stringify(assigneeParams),
			success : function(response) {
				instance.updateAssigneeUIOnSave(response);
				AJS.$(document).trigger( "updateExecutionModel", [response] );
			},
			error: function(response) {
				AJS.$('#exec_assignee_cancel-schedule-' + instance.source.sourceId).click();
				if(response && typeof buildExecutionError == 'function')
					buildExecutionError(response);
				else if(response.status == 401){
					var dialog = new AJS.Dialog({
			 		    width:540,
			 		    height: 200,
			 		    id:	"dialog-error"
			 		});
				 	dialog.addHeader("\u00a1Error!");

				 	dialog.addPanel("panel-1", "<p></p>", "dialog-error-panel-body");
				 	AJS.messages.error(AJS.$('.dialog-error-panel-body'), {
					    body: "No tiene permiso para realizar esta solicitud. Inicio de sesi\u00f3n requerido.",
					    closeable: false
					});

				 	dialog.addLink("Close", function (dialog) {
				 	    dialog.hide();
				 	}, "#");
			 		dialog.show();
				}
			}
		});
	},

	attachExecutionAssignee: function() {
		this.options.elOnEdit.css('display', 'inline-block').find('#assignee-error').html('');
		var assigneeType = this.options.elBeforeEdit.find('#execution-assignee-label').attr('data-assigneeType'),
			assigneeeJSON = null;

		if(assigneeType) {
			var assignee = this.options.elBeforeEdit.find('#execution-assignee-label').attr('data-assigneeUserName');
			assigneeeJSON = {
				assigneeType: assigneeType,
				assignee: assignee
			}
		}
    	// Attach Assignee user picker
		ZEPHYR.Execution.AssigneeNewUI.init({
			id: 'zephyr-je-execution-assignee-quick-' + this.source.sourceId,
			clear: true,
			assigneeeJSON: assigneeeJSON
		});
		this.initFirstAttempt = true;
	}
});

AJS.$('body').live('click',function(ev) {
	if(AJS.$('.dropDown-container.active').length > 0 || AJS.$('.droplist.active').length > 0 ) {
		AJS.$('.dropDown-container.active, .droplist.active').each(function(){
			AJS.$(this).removeClass('active');
		})
	}
})

AJS.$('#bulk-assign-user-form-cancel').live('click',function() {
	addedUnassignedOption = false;
});

AJS.$('#bulk-assign-user-form-submit').live('click',function() {
	addedUnassignedOption = false;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-je-test-board', location = 'includes/js/zephyr/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ZEPHYR.Templates.Dialog.
 */

if (typeof ZEPHYR == 'undefined') { var ZEPHYR = {}; }
if (typeof ZEPHYR.Templates == 'undefined') { ZEPHYR.Templates = {}; }
if (typeof ZEPHYR.Templates.Dialog == 'undefined') { ZEPHYR.Templates.Dialog = {}; }


ZEPHYR.Templates.Dialog.renderDialog = function(opt_data, opt_ignored) {
  var output = '<!-- Render the dialog --><section role="dialog" id="' + opt_data.dialogId + '" class="zephyr-dialog2 aui-layer aui-dialog2 ' + opt_data.dialogSize + '" aria-hidden="true" data-aui-remove-on-hide="true"' + ((opt_data.isModal) ? ' data-aui-modal="true"' : '') + '><!-- Dialog header --><header class="aui-dialog2-header"><!-- The dialog\'s title --><h2 class="aui-dialog2-header-main">' + opt_data.dialogHeader + '</h2></header>';
  if (opt_data.menuItems) {
    output += '<div class="dialog-page-menu">';
    var itemList17 = opt_data.menuItems;
    var itemListLen17 = itemList17.length;
    for (var itemIndex17 = 0; itemIndex17 < itemListLen17; itemIndex17++) {
      var itemData17 = itemList17[itemIndex17];
      output += '<span class="page-menu-item"><button class="item-button" id="' + itemData17.id + '">' + itemData17.name + '</button></span>';
    }
    output += '</div>';
  }
  output += '<!-- Main dialog content --><div class="aui-dialog2-content"><span class="message-bar"></span><span class="dialog2-content">' + opt_data.dialogContent + '</span></div><!-- Dialog footer --><footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><div class="aui-dialog2-footer-actions"><span id="dialog-icon-wait" class="aui-icon aui-icon-wait zfj-icon-wait" style="display:none">Loading...</span>';
  var buttonList28 = opt_data.dialogButtons;
  var buttonListLen28 = buttonList28.length;
  for (var buttonIndex28 = 0; buttonIndex28 < buttonListLen28; buttonIndex28++) {
    var buttonData28 = buttonList28[buttonIndex28];
    output += '<button id="' + buttonData28.id + '" class="aui-button ' + ((buttonData28.type == 'link') ? 'aui-button-link' : '') + '">' + buttonData28.name + '</button>';
  }
  output += '</div></footer></section>';
  return output;
};
if (goog.DEBUG) {
  ZEPHYR.Templates.Dialog.renderDialog.soyTemplateName = 'ZEPHYR.Templates.Dialog.renderDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.thed.zephyr.je:zephyr-project-sidebar-test', location = 'includes/js/zephyr/project/panel/project-sidebar.js' */
/**
 * @namespace ZEPHYR.PROJECT.SIDEBAR
 */
if (typeof ZEPHYR == 'undefined') {
    var ZEPHYR = {};
}

if (typeof ZEPHYR.PROJECT == 'undefined') {
    ZEPHYR.PROJECT = {};
}

if (typeof ZEPHYR.PROJECT.SIDEBAR == 'undefined') {
    ZEPHYR.PROJECT.SIDEBAR = {};
}

ZEPHYR.PROJECT.SIDEBAR = (function () {
    var _showTabByURLParam = function (tabType, callback) {
        AJS.params.zdateformat = AJS.$("#zdateformat").val(); // Added for ZFJ-2899
    	if(tabType.indexOf('traceability-tab') > -1) {
    		tabType = 'traceability-tab'; // Fix for traceability report page with '&type=report' in the location
        }
        tabType = tabType.indexOf('&') ? tabType.split('&')[0] : tabType;
        if(tabType.indexOf("/") == -1 && AJS.$("a[href=#" + tabType + "]").length) {
            AJS.tabs.change(AJS.$("a[href=#" + tabType + "]"));
        }

        if(callback) {
            callback();
        }
    };

    return {
        showTabByURLParam: _showTabByURLParam
    }
});

var isLoadedInIframe = function() {
    try {
        return (window !== window.parent);
    } catch(e) {
        return false;
    }
}

var InitPageContent = function(initCallback) {
    if(isLoadedInIframe()) {
        AJS.$(window).load(function(){
            initCallback();
        });
    } else {
        AJS.$(document).ready(function(){
            initCallback();
        });
    }
}

InitPageContent(function() {
    unbindTestSummaryTabsEvents();
    var tabName = window.location.hash.substr(1);
    var projectSideBar = new ZEPHYR.PROJECT.SIDEBAR();
    if (tabName && tabName.length > 0) {
        projectSideBar.showTabByURLParam(tabName, function() {
            bindTestSummaryTabsEvents();
        });
    } else {
      if(window.location.href.indexOf('zephyr-tests-page') > -1) {
        projectSideBar.showTabByURLParam("test-summary-tab", function() {
            bindTestSummaryTabsEvents();
        });
      }
    }    
});

function unbindTestSummaryTabsEvents() {
    AJS.$("#zephyr-project-view-tabs > ul > li > a").unbind("tabSelect");
}

function bindTestSummaryTabsEvents() {
    window.addEventListener("hashchange", function(e){
        var tabType = window.location.hash;
        var selector, tab;

        if(tabType.indexOf('traceability-tab') > -1){
            selector = "#aui-traceability-tab";
            tab = "traceability";
        } else if(tabType.indexOf('test-summary-tab') > -1){
            selector = "#aui-test-summary-tab";
            tab = "test-summary";
        } else if(tabType.indexOf('test-cycles-tab') > -1){
            selector = "#aui-test-cycles-tab";
            tab = "test-cycles";
        }

        if (window.sessionStorage && window.sessionStorage.getItem("oldURL")) {
            if (window.sessionStorage.getItem("oldURL").indexOf(tab)>-1) {
                return;
            }
        }
        
        
        if (selector) {
            AJS.$(selector).trigger("click");
        }
        if (window.sessionStorage) {
            sessionStorage.setItem("oldURL", tabType);
        }
    }, false);


    AJS.$("#zephyr-project-view-tabs > ul > li > a").bind("tabSelect", function (e, o) {
        var newHref,
            hashIndex = window.location.href.indexOf('#');

        var tabType = o.pane.selector.slice(1);
        if (hashIndex && hashIndex > 0)
            newHref = window.location.href.slice(0, hashIndex);

        if(!o.pane.selector) {
            var _selector = o.pane && o.pane[0].getAttribute('id');
            tabType = _selector;
            _selector = '#' + _selector;
            window.location.href = newHref ? (newHref + _selector) : (window.location.href + _selector);
        }else {
            window.location.href = newHref ? (newHref + o.pane.selector) : (window.location.href + o.pane.selector);
        }


        if(tabType.indexOf('traceability-tab') > -1) {
          // Fix for traceability report page with '&type=report' in the location
          if(!AJS.$('#traceability-container').find('#report-section').length && !AJS.$('#traceability-container').find('#requirement-section').length) {
            ZEPHYR.Traceability.init();
          }
          AJS.$("#selected-tab").text('Traceability');
          AJS.$("#project-key").hide();
          AJS.$("#walk-through-initializer").hide();
          // AJS.$("#selected-tab").text(AJS.I18n.getText('zephyr-je.pdb.traceability.label'));
        }

        if(tabType.indexOf('test-summary-tab') > -1) {

            if(!o.pane.selector) {
                var _selector = o.pane && o.pane[0].getAttribute('id');
                _selector = '#' + _selector;
                AJS.$(_selector+'-content').hide();
            }else {
                AJS.$(o.pane.selector+'-content').hide();
            }

          ZEPHYR.Loading.showLoadingIndicator();
          AJS.$('#zfj-aui-blanket').css('visibility', 'visible');
          AJS.$('#zfj-aui-blanket').css('opacity', '0.2');
          window.location.reload();
        }

        if(tabType.indexOf('test-cycles-tab') > -1) {
            if(!ZEPHYR.Cycle.versionList || ZEPHYR.Cycle.versionList.length == 0) {
                ZEPHYR.Cycle.fetchVersions();
            }
            // ZEPHYR.Cycle.versionList = [];
            // AJS.$("#select-version2 > optgroup > option").each(function() {
            //     ZEPHYR.Cycle.versionList.push({id:this.value, name:this.text});
            // });
            AJS.$("#selected-tab").text('Cycle Summary');
            AJS.$("#walk-through-initializer").show();
        }

        setTimeout(function() {
            AJS.$(document).scrollTop(0);
        }, 0);
        if (e.currentTarget.id == "aui-test-cycles-tab") {
            if (testCycleTabReady()) {
                testCycleTabReady();
            }
        }
    });
}
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.mouse', location = 'aui.chunk.d6bfa91e183495d54595--b2c44b055f5b0242894f.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.mouse"],{mz4i:function(u,i,n){"use strict";n.r(i);n("XPYc");i.default="jquery"}},[["mz4i","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-logger', location = 'includes/js/rapid/Logger.js' */
"use strict";define("jira-agile/rapid/logger",["underscore","jira/util/logger"],function(a,i){var e={ajax:"ajax",event:"event",state:"state",ui:"ui",callback:"callback",refresh:"refresh"};return{Contexts:e,enabledContexts:[e.ajax,e.event,e.state,e.ui,e.callback,e.refresh],log:function(e,t){if(!t||a.contains(this.enabledContexts,t)){e=t?this.pad(t,6)+": "+e:e;i.log(e)}},pad:function(e,t){return e.length<t?e+"                               ".substr(0,t-e.length):e},timeMap:{},timeStart:function(e){if(!e)throw"start: If starting a timer manually a name must be set";this.timeMap[e]=(new Date).getTime()},timeStop:function(e){if(!(e in this.timeMap))throw"stop:"+e+" not found";var t=(new Date).getTime()-this.timeMap[e];delete this.timeMap[e];this.log(t+"ms on "+e,this.Contexts.ui)}}});var Logger=require("jira-agile/rapid/logger");AJS.namespace("GH.Logger",null,Logger);AJS.namespace("GH.log",null,Logger.log.bind(Logger));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:events', location = 'includes/js/rapid/Events.js' */
"use strict";define("jira-agile/rapid/events",["require"],function(t){var r=t("underscore");function n(t){t?r.extend(t,n.prototype):t=this;t._bindings=[];return t}n.prototype={on:function(t,n,e){e&&this._off({type:t,context:e});this._bindings.push({type:t,handler:n,context:e});return this},off:function(t){r.isString(t)?this._off({type:t}):r.isFunction(t)?this._off({handler:t}):r.isObject(t)&&this._off({context:t});return this},_off:function(i){this._bindings=r.reject(this._bindings,function(t){var n=!i.type||i.type===t.type,e=!i.context||i.context===t.context,t=!i.handler||i.handler===t.handler;return n&&e&&t})},trigger:function(n){var e=Array.prototype.slice.call(arguments,1);r.each(this._bindings,function(t){t.type===n&&t.handler.apply(t.context,e)});return this}};return n});AJS.namespace("GH.Events",null,require("jira-agile/rapid/events"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:global-events', location = 'includes/js/rapid/GlobalEvents.js' */
"use strict";define("jira-agile/rapid/global-events",["require"],function(e){return new(e("jira-agile/rapid/events"))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-config', location = 'includes/js/gh-config.js' */
"use strict";define("jira-agile/config",[],function(){var i={isSampleDataAvailable:!1};return i});AJS.namespace("GH.Config",null,require("jira-agile/config"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:storage', location = 'includes/js/rapid/state/storage.js' */
"use strict";define("jira-agile/rapid/state/storage",[],function(){var e={get:function(r,t){r=(t?sessionStorage:localStorage).getItem(r);if("string"!=typeof r)return r;try{return JSON.parse(r)}catch(e){GH.log("GH.storage: Caught error: "+e);GH.log("GH.storage: Cannot parse json string retrieved from "+(t?"session":"local")+" storage. Ignoring value "+r);return}},put:function(e,r,t){if(null==r)(t?sessionStorage:localStorage).removeItem(e);else try{(t?sessionStorage:localStorage).setItem(e,JSON.stringify(r))}catch(e){return!1}return!0}};if(!window.localStorage||!window.sessionStorage){e.get=function(){return null};e.put=function(){return!1}}return e});AJS.namespace("GH.storage",null,require("jira-agile/rapid/state/storage"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:validation', location = 'includes/js/rapid/Validation.js' */
"use strict";define("jira-agile/rapid/validation",["jira/util/formatter","jquery"],function(a,i){var o={notBlank:function(r,t,e){return o.applyRules(r,t,e,function(){return 0<i.trim(i(r).val()).length})},maxLength:function(r,t,e,n){return o.applyRules(r,e,n,function(){return i.trim(i(r).val()).length<=t})},isPositiveInteger:function(r,t,e){return o.applyRules(r,t,e,function(){return/^\d*$/.test(i.trim(i(r).val()))})},applyRules:function(r,t,e,n){r=i(r);r=e?i(e):r;if(n.call(this))return!0;o.showContextualErrors(r,t);return!1},showContextualErrors:function(r,t,e,n,i){o.clearContextualErrors(r);r.after(GH.tpl.rapid.notification.renderContextualErrors({errors:[{message:a.I18n.getText(t,e,n,i)}]}))},clearContextualErrors:function(r){(r=i(r)).find(".ghx-error").remove();r.siblings(".ghx-error").remove()}};return o});AJS.namespace("GH.Validation",null,require("jira-agile/rapid/validation"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:help-paths', location = 'includes/js/gh-helppaths.js' */
"use strict";AJS.namespace("GH.HelpPaths");GH.HelpPaths.getHelpPath=function(e){return null};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:message', location = 'includes/js/gh-message.js' */
"use strict";define("jira-agile/message",["jira/util/logger"],function(e){var a={showIssueMessage:function(){e.warn("[deprecated] GH.Message.showIssueMessage has no effect, @see module:jira-agile/rapid/ui/notification")},showSuccess:function(){e.warn("[deprecated] GH.Message.showSuccess has no effect, @see module:jira-agile/rapid/ui/notification")},showWarning:function(){e.warn("[deprecated] GH.Message.showWarning has no effect, @see module:jira-agile/rapid/ui/notification")},showPersistentWarning:function(){e.warn("[deprecated] GH.Message.showPersistentWarning has no effect, @see module:jira-agile/rapid/ui/notification")}};return a});AJS.namespace("GH.Message",null,require("jira-agile/message"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:util', location = 'includes/js/rapid/Util.js' */
"use strict";define("jira-agile/rapid/util",["underscore","jquery"],function(u,r){var t={getPluginKey:function(){return r('meta[name="ghx-plugin-key"]').attr("content")},wrapPreventDefault:function(r,n){return function(e){e.preventDefault();return r.apply(n||this,arguments)}},andThenSplice:function(){return{_needsSplice:Array.prototype.slice.call(arguments)}},andThen:function(a){var e=[{trigger:"resolveWith",on:"done",filter:arguments[1]},{trigger:"rejectWith",on:"fail",filter:arguments[2]},{trigger:"notifyWith",on:"progress",filter:arguments[3]}];return r.Deferred(function(i){u.each(e,function(e){var r=e.on,n=e.trigger,t=u.isFunction(e.filter)&&e.filter;a[r](function(){var e=t&&t.apply(this,arguments);if(e&&u.isFunction(e.promise))e.promise().done(i.resolve).fail(i.reject).progress(i.notify);else{e=e&&u.isArray(e._needsSplice)?e._needsSplice:t?[e]:arguments;i[n](u.isFunction(this.promise)?i.promise():this,e)}})})}).promise()}};r._OriginalDeferred=r.Deferred;r.Deferred=function(n){return r._OriginalDeferred(function(r){r.andThen=function(){var e=Array.prototype.slice.call(arguments);e.unshift(r);return t.andThen.apply(this,e)};var e=r.promise;r.promise=function(){var r=e.apply(this,arguments);r.andThen=function(){var e=Array.prototype.slice.call(arguments);e.unshift(r);return t.andThen.apply(this,e)};return r};n&&n.call(r,r)})};t.indexOf=function(n,t,i){var a=-1;i&&(n=n.slice().reverse());u.some(n,function(e,r){if(t(e,r)){a=i?n.length-1-r:r;return!0}return!1});return a};t.swapArrayItems=function(e,r,n){var t;if(e&&r!==n&&0<=Math.min(r,n)&&Math.max(r,n)<e.length){t=e[n];e[n]=e[r];e[r]=t;return!0}return!1};t.roundToDecimalPlaces=function(e,r){if("number"!=typeof e||e===Math.round(e))return e;if(0===r)return Math.round(e);var n=e.toString();if(0<=n.indexOf("e"))return e;var t=e<0,e=n.split("."),n=+e[1].charAt(r);e[1]=e[1].substr(0,r);if(5<n||!t&&5==n){n=/^0*/.exec(e[1])[0];e[1]=n+(+e[1]+1);if(e[1].length>r)if(n)e[1]=e[1].substr(e[1].length-r);else{e[0]=+e[0]+1;e[1]=0}}return parseFloat(e.join("."))};return t});AJS.namespace("GH.Util",null,require("jira-agile/rapid/util"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:user-data', location = 'includes/js/rapid/UserData.js' */
"use strict";define("jira-agile/rapid/user-data",["jira/util/data/meta"],function(e){var r={};r.remoteUser=e.get("remote-user");r.loggedIn=!!r.remoteUser;r.hasUser=function(){return r.loggedIn};r.getUserName=function(){return r.remoteUser};r.canCreateProject=function(){return r.userConfig.canCreateProject};r.setGlobalConfig=function(e){r.quickCreateDefaultIssueTypeId=e.quickCreateDefaultIssueTypeId;r.userConfig=e.userConfig;r.userConfig&&r.userConfig.canCreateProject&&(r.userConfig.canCreateProject=!GH.Features.DISABLE_CREATE_PROJECT.isEnabled())};return r});AJS.namespace("GH.UserData",null,require("jira-agile/rapid/user-data"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:features', location = 'includes/js/gh-features.js' */
"use strict";define("jira-agile/gh-features",["jira/ajs/dark-features"],function(e){function a(e){this.featureKey=e;this.featureEmergencyDisabledKey=e+".emergencyDisabled"}a.prototype.isEnabled=function(){return e.isEnabled(this.featureKey)&&!e.isEnabled(this.featureEmergencyDisabledKey)};return Object.freeze({DISABLE_CREATE_PROJECT:new a("jag.DISABLE_CREATE_PROJECT"),EDITABLE_DETAIL_VIEW_ENABLED:new a("com.atlassian.jira.agile.darkfeature.editable.detailsview"),SPLIT_ISSUE:new a("com.atlassian.jira.agile.darkfeature.splitissue")})});AJS.namespace("GH.Features",null,require("jira-agile/gh-features"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:navigation', location = 'includes/js/gh/navigation/Navigation.js' */
"use strict";define("jira-agile/rapid/navigation",["wrm/context-path"],function(a){var i={gotoDefaultRapidBoardPage:function(n,a){window.location.href=i.getDefaultRapidBoardPageUrl(n,a)},getDefaultRapidBoardPageUrl:function(n,a){a=_.isUndefined(a)?"":"&view="+a;return i.getCanonicRapidBoardPageUrl(n)+a},getCanonicRapidBoardPageUrl:function(n){return a()+"/secure/RapidBoard.jspa?rapidView="+n},getLoginUrl:function(){return a()+"/login.jsp?os_destination="+encodeURIComponent(window.location.href)},updateWindowLocation:function(n){return window.location.assign(n)}};return i});AJS.namespace("GH.Navigation",null,require("jira-agile/rapid/navigation"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:callback-manager', location = 'includes/js/rapid/ops/CallbackManager.js' */
"use strict";define("jira-agile/rapid/ops/callback-manager",["jira-agile/rapid/logger","underscore"],function(e,n){var s={callbacks:{},executeCallbacks:function(a,l){e.log("Executing callbacks for "+a,e.Contexts.callback);var c=s.callbacks[a];if(c&&!n.isEmpty(c)){n.each(c,function(a){e.log("Executing callback "+a.name,e.Contexts.callback);a.fn(l)});delete s.callbacks[a]}e.log("Finished callbacks for "+a,e.Contexts.callback)},registerCallback:function(a,l,c){e.log("Registering callback "+l+" with namespace "+a);(s.callbacks[a]||(s.callbacks[a]=[])).push({name:l,fn:c})},deleteCallbacks:function(l){n.each(n.keys(s.callbacks),function(a){a.substr(0,l.length)===l&&delete s.callbacks[a]})},getCallbacks:function(a){return s.callbacks[a]||[]},clear:function(){s.callbacks={}}};return s});AJS.namespace("GH.CallbackManager",null,require("jira-agile/rapid/ops/callback-manager"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:page-mode', location = 'includes/js/rapid/const/PageMode.js' */
"use strict";define("jira-agile/rapid/const/page-mode",function(){return Object.freeze({PLAN:"plan",WORK:"work",REPORT:"report",TEAM:"team"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:rapid-board-state', location = 'includes/js/rapid/state/RapidBoardState.js' */
"use strict";define("jira-agile/rapid/state/rapid-board-state",["underscore","jira/util/logger","jira-agile/rapid/const/page-mode","jira-agile/rapid/global-events"],function(i,n,e,t){var a;t.on("pre-initialization",function(){a=require("jira-agile/rapid/ui/plan/plan-url-state")});var r={};r.VIEW_MODE=e;r.data={};r.setDataValue=function(e,t){i.isUndefined(t)||i.isNull(t)?delete r.data[e]:r.data[e]=t};r.getDataValue=function(e){return r.data[e]};r.getMode=function(){return r.getDataValue("mode")||r.VIEW_MODE.WORK};r.getStoredMode=function(){return GH.storage.get("gh.mode")||r.VIEW_MODE.WORK};r.isPlanMode=function(){return r.getMode()===r.VIEW_MODE.PLAN};r.isWorkMode=function(){return r.getMode()===r.VIEW_MODE.WORK};r.isTeamMode=function(){return r.getMode()===r.VIEW_MODE.TEAM};r.setMode=function(e){r.setDataValue("mode",e);GH.storage.put("gh.mode",e)};r.getLastCardPrintingSize=function(){return GH.storage.get("gh.card.printing.size")||"small"};r.setLastCardPrintingSize=function(e){GH.storage.put("gh.card.printing.size",e)};r.getProjectKey=function(){return r.getDataValue("projectKey")||void 0};r.setProjectKey=function(e){r.setDataValue("projectKey",e)};r.isDetailsViewOpened=function(){return r.getDataValue("detailViewWork")||!1};r.isDetailsViewPlanOpened=function(){return r.getBoardSetting(null,"detailViewPlan",!0)||!1};r.isKeepDetailViewOpen=function(){return r.getBoardSetting(null,"keepDetailViewOpen",!0)||!1};r.isKeepDetailViewPlanOpen=function(){return r.getBoardSetting(null,"keepDetailViewOpenPlan",!0)||!1};r.getStoredDetailViewOpened=function(){return GH.storage.get("gh.detailViewWork")||!1};r.setWorkViewDetailsViewOpened=function(e){r.setDataValue("detailViewWork",e||!1);GH.storage.put("gh.detailViewWork",e||!1)};r.setPlanViewDetailsViewOpened=function(e){r.setBoardSetting("detailViewPlan",e||!1)};r.setKeepDetailViewOpen=function(e){r.setBoardSetting("keepDetailViewOpen",e||!1)};r.setKeepDetailViewPlanOpen=function(e){r.setBoardSetting("keepDetailViewOpenPlan",e||!1)};r.setEpicShownOnRapidBoard=function(e){GH.storage.put("gh.epicShownOnRapidBoard."+r.getRapidViewId(),e)};r.getEpicShownOnRapidBoard=function(){var e=GH.storage.get("gh.epicShownOnRapidBoard."+r.getRapidViewId());return!!i.isNull(e)||e};r.setNonWorkingDaysShown=function(e,t){GH.storage.put("gh.nonWorkingDaysShown."+e,t)};r.getNonWorkingDaysShown=function(e){e=GH.storage.get("gh.nonWorkingDaysShown."+e);return!!i.isNull(e)||e};r.setQuickFiltersExpanded=function(e){GH.storage.put("gh.quickFiltersExpanded",e)};r.getQuickFiltersExpanded=function(){var e=GH.storage.get("gh.quickFiltersExpanded");return!i.isNull(e)&&e};r.setDetailViewWidth=function(e){GH.storage.put("gh.detailViewWidth",e)};r.getDetailViewWidth=function(){var e=GH.storage.get("gh.detailViewWidth");return i.isNull(e)?0:e};r.getCycleTimeCalculationType=function(){var e=r.getDataValue("cycleTimeCalculationType");if(i.isUndefined(e)){e=GH.storage.get("gh.cycleTimeCalculationType");if(i.isNull(e)){r.setCycleTimeCalculationType(GH.ControlChart.CYCLE_TIME_CALCULATION_TOTAL);return GH.ControlChart.CYCLE_TIME_CALCULATION_TOTAL}}return e};r.setCycleTimeCalculationType=function(e){r.setDataValue("cycleTimeCalculationType",e);GH.storage.put("gh.cycleTimeCalculationType",e)};r.getStoredChartIntroState=function(){return!1!==GH.storage.get("gh.charts.intro")};r.setChartIntroState=function(e){GH.storage.put("gh.charts.intro",e)};r.isChartViewOpened=function(){return r.getMode()===r.VIEW_MODE.REPORT};r.getRapidViewId=function(){var e=r.getDataValue("rapidViewId");return e=i.isUndefined(e)?r.getMostRecentRapidViewId():e};r.getRapidViewIdWithInfo=function(){var e={};e.viewId=r.getDataValue("rapidViewId");e.fromLocalStorage=!1;if(i.isUndefined(e.viewId)){e.viewId=r.getMostRecentRapidViewId();e.fromLocalStorage=!0}return e};r.getMostRecentRapidViewId=function(){return GH.storage.get("gh.latestRapidViewId")};r.setRapidViewId=function(e){r.setDataValue("rapidViewId",e);GH.storage.put("gh.latestRapidViewId",e)};r.getSelectedIssueKey=function(){return r.getDataValue("selectedIssueKey")||null};r.getStoredSelectedIssueKey=function(){return GH.storage.get("gh.selectedIssueKey")||null};r.setSelectedIssueKey=function(e){r.setDataValue("selectedIssueKey",e);GH.storage.put("gh.selectedIssueKey",e)};r.setChartType=function(e){var t=r.getBoardSettings();i.isUndefined(e)||i.isNull(e)?delete t.chartType:t.chartType=e;r.setBoardSettings(t)};r.getChartType=function(){return r.getBoardSettings().chartType||""};r.getRetrospectiveSprintId=function(){return r.getBoardSettings().retrospectiveSprintId||!1};r.setRetrospectiveSprintId=function(e){return r.setBoardSetting("retrospectiveSprintId",e)};r.setTimeFrame=function(e){var t=r.getBoardSettings();i.isUndefined(e)||i.isNull(e)?delete t.timeFrame:t.timeFrame=e;r.setBoardSettings(t)};r.getTimeFrame=function(){var e=r.getBoardSettings().timeFrame;return i.isUndefined(e)||i.isNull(e)?7:e};r.getBoardSettings=function(e){var t=(e=i.isUndefined(e)||i.isNull(e)?r.getRapidViewId():e)||"00000",e=r.getDataValue("boardSettings."+t)||GH.storage.get("gh.boardSettings."+t);e||r.setDataValue("boardSettings."+t,e={});return e||{}};r.setBoardSettings=function(e){var t=r.getRapidViewId();if(t){r.setDataValue("boardSettings."+t,e);GH.storage.put("gh.boardSettings."+t,e)}};r.isSwimlaneCollapsed=function(e){return-1<(r.getBoardSettings().collapsedSwimlanes||[]).indexOf(e)};r.setSwimlaneCollapsed=function(e,t){var a=r.getBoardSettings(),i=a.collapsedSwimlanes||[];if(t){if(i.indexOf(e)<0){i.push(e);a.collapsedSwimlanes=i}}else{e=i.indexOf(e);if(e<0)return;i.splice(e,1);0<i.length?a.collapsedSwimlanes=i:delete a.collapsedSwimlanes}r.setBoardSettings(a)};r.getBoardSetting=function(e,t,a){t=r.getBoardSettings(e)[t];return void 0!==t?t:a};r.setBoardSetting=function(e,t){var a=r.getBoardSettings();void 0!==t?a[e]=t:delete a[e];r.setBoardSettings(a)};r.getNumberArrayBoardSetting=function(e,t,a){a=r.getBoardSettings(e)[t]||a;if(!i.isArray(a)){n.log("Property is not of type array, returning an empty array: "+t);return[]}i.each(a,function(e){i.isNumber(e)||n.log("Warning: Property value is not of type number: "+e)});return a};r.setNumberArrayBoardSetting=function(e,t){var a=r.getBoardSettings();if(void 0!==t){if(!i.isArray(t)){n.log("Property is not of type array, returning an empty array: "+e);return}i.each(t,function(e){i.isNumber(e)||n.log("Warning: Property value is not of type number: "+e)});a[e]=t}else delete a[e];r.setBoardSettings(a)};r.pushState=function(){GH.log("State.pushState",GH.Logger.Contexts.state);GH.RapidBoard.UrlState.pushState()};r.replaceState=function(){GH.log("State.replaceState",GH.Logger.Contexts.state);GH.RapidBoard.UrlState.replaceState()};r.initializeState=function(){r.setSelectedIssueKey(r.getStoredSelectedIssueKey());r.setWorkViewDetailsViewOpened(r.getStoredDetailViewOpened());var e=r.getStoredMode();e!==r.VIEW_MODE.PLAN||r.isPlanModeAvailable()||(e=r.VIEW_MODE.WORK);r.setMode(e);r.setChartIntroState(r.getStoredChartIntroState());GH.RapidBoard.UrlState.setHandlers([GH.RapidBoardUrlState,a,GH.WorkUrlState,GH.ReportUrlState]);GH.RapidBoard.UrlState.hasUrlState()&&GH.RapidBoard.UrlState.loadState();e=r.isLoadingKanPlanWhileItDisabled();GH.RapidBoard.UrlState.replaceState(e);e?require("jira-agile/rapid/ui/kanplan/kan-plan-feature-service").showKanPlanDisabledFlag():n.trace("gh.rapid.kanplan.not.enabled.message.not.shown");GH.RapidBoard.UrlState.init()};r.isPlanModeAvailable=function(){var e=require("jira-agile/rapid/ui/kanplan/kan-plan-feature-service");return r.isScrumBoard()||e.shouldShowKanbanBacklog()};r.isLoadingKanPlanWhileItDisabled=function(e){var t=GH.RapidBoard.UrlState.getCurrentUrlState();e=e||GH.RapidBoard.UrlState.normalizeStringParam(t.view,"");return!!i.isString(e)&&(-1<e.indexOf("planning")&&!r.isPlanModeAvailable())};r.isScrumBoard=function(){return GH.RapidViewConfig.currentData.data&&GH.RapidViewConfig.currentData.data.sprintSupportEnabled};r.isKanbanBoard=function(){return GH.RapidViewConfig.currentData.data&&!GH.RapidViewConfig.currentData.data.sprintSupportEnabled};r.getBoardType=function(){return r.isScrumBoard()?"scrum":"kanban"};r.getShowEpicAsPanel=function(){return GH.RapidViewConfig.currentData.data.showEpicAsPanel};return r});AJS.namespace("GH.RapidBoard.State",null,require("jira-agile/rapid/state/rapid-board-state"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:issue-list-model', location = 'includes/js/rapid/ui/plan/IssueListModel.js' */
"use strict";define("jira-agile/rapid/ui/plan/issue-list-model",["require"],function(e){var s,o=e("underscore");e("jira-agile/rapid/global-events").on("pre-initialization",function(){s=e("jira-agile/rapid/ui/plan/subtasks-expanding-controller")});function n(e,t,s){this.fixVersions=s;(s=this.data={}).id=e;s.issueByKey={};s.order=[];s.visibleIssueKeys=new GH.Collection.OrderedSet;s.hiddenIssueKeys={};s.parentSubtaskKeys={};this.addIssues(t)}n.prototype.addIssues=function(e){var s=this.data.issueByKey,i=this.data.order;o.each(e,function(e){this.fixVersions&&this.processFixVersion(e);var t=e.key;s[t]=e;i.push(t)},this);this.buildCache()};n.prototype.prependIssues=function(e){var s=this.data.issueByKey,t=this.data.order;o.each(e,function(e){this.fixVersions&&this.processFixVersion(e);var t=e.key;s[t]=e},this);e=o.map(e,function(e){return e.key});this.data.order=o.flatten([e,t],!0);this.buildCache()};n.getOrderKeyForMarkerId=function(e){return"%%-"+e};n.prototype.getIssuesInOrder=function(){var s=[],e=this.data.order,i=this.data.issueByKey;o.forEach(e,function(e,t){s.push(i[e])},this);return s};n.prototype.getId=function(){return this.data.id};n.prototype.buildCache=function(){var s=this.data.visibleIssueKeys.clear(),i=this.data.orderByKey={};o.forEach(this.data.order,function(e,t){if(this._isMarkerId(e))i[n.getOrderKeyForMarkerId(e)]=t;else{i[e]=t;t=this.data.issueByKey[e];t&&!t.hidden&&s.push(e)}},this);this.data.parentSubtaskKeys={};o.forEach(this.data.issueByKey,function(e,t){e=e.parentKey;if(e){this.data.parentSubtaskKeys[e]||(this.data.parentSubtaskKeys[e]=[]);this.data.parentSubtaskKeys[e].push(t)}}.bind(this))};n.prototype._isMarkerId=function(e){return o.isNumber(e)};n.prototype.indexOfRankable=function(e){this._isMarkerId(e)&&(e=n.getOrderKeyForMarkerId(e));e=this.data.orderByKey[e];return o.isUndefined(e)?-1:e};n.prototype.containsRankable=function(e){return-1!==this.indexOfRankable(e)};n.prototype.insertMarker=function(e,t){var s=0,i=this.data.order;this.containsRankable(e)&&(i=o.without(i,e));t&&((s=o.indexOf(i,t))<0?s=0:s++);0===s?i.unshift(e):i=o.flatten([i.slice(0,s),e,i.slice(s)]);var r={};o.forEach(i,function(e,t){this._isMarkerId(e)&&(e=n.getOrderKeyForMarkerId(e));r[e]=t},this);this.data.order=i;this.data.orderByKey=r};n.prototype.removeMarker=function(e){if(this.containsRankable(e)){var e=o.without(this.data.order,e),s={};o.forEach(e,function(e,t){this._isMarkerId(e)&&(e=n.getOrderKeyForMarkerId(e));s[e]=t},this);this.data.order=e;this.data.orderByKey=s}};n.prototype.isSubtask=function(e){e=this.getIssueData(e);return!(!e||!e.parentKey)};n.prototype.reorderIssues=function(e,t,s){var i=this.data.order,r=t||s;if(t)var n=this.getRealAfterKey(t),n=i.indexOf(n)+1;else{s=this.getRealBeforeKey(s);n=i.indexOf(s)}if(this.isSubtask(r)){var a=this.getIssueData(r).parentKey;e=e.filter(function(e){e=this.getIssueData(e);return e&&e.parentKey===a}.bind(this))}else{var u=[];e.forEach(function(e){if(this.isIssueValid(e)&&!this.isSubtask(e)){var t=this.getSubtasks(e).map(function(e){return e.key});u.push(e);t.forEach(function(e){u.push(e)})}}.bind(this));e=u}r=i.slice(0,n),n=i.slice(n),r=this.withoutArray(r,e),n=this.withoutArray(n,e),n=o.flatten([r,e,n]);this.setOrder(n)};n.prototype.getRealAfterKey=function(e){if(this.isSubtask(e))return e;var t=o.clone(this.data.order).reverse(),t=this.findFirstSubtaskOfParentInList(t,e);return t||e};n.prototype.getRealBeforeKey=function(e){return this.isSubtask(e)||o.contains(this.data.order,e)?e:this.findFirstSubtaskOfParentInList(this.data.order,e)};n.prototype.findFirstSubtaskOfParentInList=function(e,t){return o.find(e,function(e){e=this.getIssueData(e);return e&&e.parentKey===t}.bind(this))};n.prototype.getRankableBeforeId=function(e){e=this.indexOfRankable(e);return 0<e&&this.data.order[e-1]};n.prototype.isIssueHiddenBySearchByKey=function(e){return this.data.hiddenIssueKeys[e]||!1};n.prototype.isIssueHidden=function(e){if(this.isSubtask(e)){var t=this.getIssueData(e).parentKey;if(this.isIssueValid(t)&&s.isIssueCollapsed(t))return!0}return this.isIssueHiddenBySearchByKey(e)};n.prototype.updateIssue=function(e){GH.ExtraFieldsHelper.prepareExtraFields(e.extraFields);this.processFixVersion(e);if(o.isUndefined(this.data.issueByKey[e.key]))return!1;this.data.issueByKey[e.key]=e;this.buildCache();return!0};n.prototype.processFixVersion=function(e){this.fixVersions&&(e.fixVersionsUI=this.fixVersions.getVersionsForIds(e.fixVersions))};n.prototype.getNumVisibleIssues=function(){return this.getNumVisibleIssuesBeforeRankable(!1)};n.prototype.getVisibleIssuesBeforeRankable=function(e){if(!1!==e){var t=this.indexOfRankable(e);if(t<0)return!1;t=this._first(this.data.order,t)}else t=this.data.order;return o.filter(t,function(e){return this.isIssueVisible(e)}.bind(this))};n.prototype.getNumVisibleIssuesBeforeRankable=function(e){return this.getVisibleIssuesBeforeRankable(e).length};n.prototype.getAllIssues=function(){return this.data.issueByKey};n.prototype.getVisibleIssues=function(){var s={};o.each(this.data.issueByKey,function(e,t){this.isIssueVisible(t)&&(s[t]=e)},this);return s};n.prototype.getVisibleRankables=function(){var t=this;return o.filter(t.data.order,function(e){return!!t.isIssueValid(e)&&(!!t._isMarkerId(e)||-1!==t.getIssueIndex(e))})};n.prototype.getVisibleIssueKeys=function(){return this.data.visibleIssueKeys};n.prototype.getHiddenBySearchIssues=function(){return this.data.hiddenIssueKeys};n.prototype.setHiddenBySearchIssues=function(e){this.data.hiddenIssueKeys=e};n.prototype.getIssueKeyAtIndex=function(e){var t=this.data.visibleIssueKeys;return t.length>e?t.get(e):t.last()};n.prototype.getFirstVisibleIssueKey=function(){for(var e=this.data.visibleIssueKeys,t=0;t<e.length;t++){var s=e.get(t);if(!this.isIssueHidden(s))return s}return!1};n.prototype.getLastVisibleIssueKey=function(){for(var e=this.data.visibleIssueKeys,t=e.length-1;0<=t;t--){var s=e.get(t);if(!this.isIssueHidden(s))return s}return!1};n.prototype.getIssueIndex=function(e){return this.data.visibleIssueKeys.indexOf(e)};n.prototype.getIssueData=function(e){return this.data.issueByKey[e]};n.prototype.getIssueDataById=function(t){return o.find(this.data.issueByKey,function(e){return e.id===t})||void 0};n.prototype.getIssueKeyById=function(e){e=this.getIssueDataById(e);return e?e.key:void 0};n.prototype.getIssueIdForKey=function(e){e=this.getIssueData(e);if(e)return e.id};n.prototype.isIssueVisible=function(e){return-1!==this.getIssueIndex(e)&&!this.isIssueHiddenBySearchByKey(e)};n.prototype.isIssueValid=function(t){return o.isString(t)?!o.isUndefined(this.data.issueByKey[t]):o.any(this.data.issueByKey,function(e){return t===e.id})};n.prototype.areIssuesValid=function(e){if(0===e.length)return!1;var t=this;return o.all(e,function(e){return t.isIssueValid(e)})};n.prototype.getFirstRankableIssueKeyInColumn=function(e,t){return this._getFirstOrLastRankableIssueKeyInColumn(e,t,!0)};n.prototype.getLastRankableIssueKeyInColumn=function(e,t){return this._getFirstOrLastRankableIssueKeyInColumn(e,t,!1)};n.prototype._getFirstOrLastRankableIssueKeyInColumn=function(e,t,s){var i=o.isArray(e)?e:o.isString(e)?[e]:[],r=this.data.visibleIssueKeys,n=o.range(0,r.length);s||n.reverse();for(var a=0;a<n.length;a++){var u=r.get(n[a]);if(!o.contains(i,u))return t&&this.isSubtask(u)?this.getIssueData(u).parentKey:u}return!1};n.prototype.getBestFitSelectionAfterRank=function(e){return this.getNextIssueKeyAfterRank(e)||this.getPreviousIssueKeyAfterRank(e)};n.prototype.getNextIssueKeyAfterRank=function(e){e=o.last(e);return this.getNextIssueKey(e)};n.prototype.getNextIssueKey=function(e){for(var t=this.getIssueIndex(e),s=this.data.visibleIssueKeys;++t<s.length;){var i=s.get(t);if(!this.isIssueHidden(i))return i}return!1};n.prototype.getPreviousIssueKeyAfterRank=function(e){e=o.first(e);return this.getPreviousIssueKey(e)};n.prototype.getPreviousIssueKey=function(e){for(var t=this.getIssueIndex(e),s=this.data.visibleIssueKeys;0<=--t;){var i=s.get(t);if(!this.isIssueHidden(i))return i}return!1};n.prototype.getIssueRange=function(e,t){var s,i,r=[],n=this.data.visibleIssueKeys,e=this.getIssueIndex(e),a=this.getIssueIndex(t);if(o.isUndefined(e)||o.isUndefined(a))return r;if(e<a)for(s=e;s<=a;s++){i=n.get(s);this.isIssueHiddenBySearchByKey(i)||r.push(i)}else for(s=e;a<=s;s--){i=n.get(s);this.isIssueHiddenBySearchByKey(i)||r.push(i)}return r};n.prototype.canAddToSelection=function(e,t){var s=o.filter(e,function(e){return-1!==this.getIssueIndex(e)},this);return!(0<e.length&&s.length!==e.length)&&this.isIssueVisible(t)};n.prototype.removeIssues=function(e){var s=this,i=[];o.each(e="object"==typeof e?e:[e],function(e){var t=s.data.issueByKey[e];if(t){i.push(t);delete s.data.issueByKey[e];s.data.order=o.without(s.data.order,e);delete s.data.hiddenIssueKeys[e]}});this.buildCache();return i};n.prototype.getLastVisibleKeyBefore=function(e){if(void 0!==e){for(var t,s=0;s<this.data.order.length;s++){var i=this.data.order[s];!this._isMarkerId(i)&&this.isIssueVisible(i)&&(t=i);if(i===e)break}return t}};n.prototype.getOrder=function(){return this.data.order};n.prototype.setOrder=function(e){this.data.order=e;this.buildCache()};n.prototype.applySearchFilter=function(i){var r=this,n=!1;r.data.visibleIssueKeys.forEach(function(e){var t=r.data.issueByKey[e],s=r.data.hiddenIssueKeys[e]||!1,t=!i(t,r.data.issueByKey);n=n||s!==t;t?r.data.hiddenIssueKeys[e]=!0:delete r.data.hiddenIssueKeys[e]});return n};n.prototype.areIssuesBetweenMarkers=function(e,t,s){var i=this.getIssuesBetweenMarkers(t,s),r=!0;o.forEach(e,function(e){o.contains(i,e)||(r=!1)});return r};n.prototype.getIssuesBetweenMarkers=function(e,t){var s=this.indexOfRankable(e),e=this.indexOfRankable(t);e<s&&(t=e,e=s,s=t);return this.getOrder().slice(s+1,e)};n.prototype.getMarkerIdBeforeId=function(e){this._isMarkerId(e)&&(e=n.getOrderKeyForMarkerId(e));e=this.data.orderByKey[e];if(o.isUndefined(e))return!1;for(var t=e-1;0<=t;t--)if(this._isMarkerId(this.data.order[t]))return this.data.order[t];return!1};n.prototype.getLastMarkerId=function(){for(var e=!1,t=this.data.order,s=t.length-1;0<=s;s--){var i=t[s];if(this._isMarkerId(i)){e=i;break}}return e};n.prototype.getMarkerIds=function(){var t=[];o.each(this.data.order,function(e){this._isMarkerId(e)&&t.push(e)},this);return t};n.prototype.withoutArray=function(e,t){var s=e;o.each(t,function(e){s=o.without(s,e)});return s};n.prototype._first=function(e,t){return 0===(t=parseInt(t,10))?[]:o.first(e,t)};n.prototype.getIssueCount=function(){var t=0;o.each(this.data.issueByKey,function(e){t++});return t};n.prototype.getAllInvisibleIssuesData=function(){var e=this.data.order;return this._getInvisibleIssuesDataForKeys(e)};n.prototype.getAllVisibleIssuesData=function(){var e=this.data.order;return this._getVisibleIssuesDataForKeys(e)};n.prototype.getVisibleIssuesDataBeforeIncludingKey=function(e){e=this.indexOfRankable(e);if(e<0)return[];e=this.data.order.slice(0,e+1);return this._getVisibleIssuesDataForKeys(e)};n.prototype.getVisibleIssuesDataAfterKey=function(e){e=this.indexOfRankable(e);if(e<0)return[];e=this.data.order.slice(e+1);return this._getVisibleIssuesDataForKeys(e)};n.prototype.getSubtasks=function(e){return this.getSubtasksKeys(e).map(function(e){return this.getIssueData(e)}.bind(this))};n.prototype.getSubtasksKeys=function(e){return this.data.parentSubtaskKeys[e]||[]};n.prototype.isParent=function(e){return!!this.data.parentSubtaskKeys[e]};n.prototype.getParentKey=function(e){return this.isSubtask(e)?this.getIssueData(e).parentKey:e};n.prototype._getVisibleIssuesDataForKeys=function(e){var t=[];o.each(e,function(e){if(this.isIssueVisible(e)){e=this.getIssueData(e);t.push(e)}},this);return t};n.prototype._getInvisibleIssuesDataForKeys=function(e){var s=[];o.each(e,function(e){var t=this.getIssueData(e);(t.hidden||this.isIssueHiddenBySearchByKey(e))&&s.push(t)},this);return s};n.prototype.getIssuesExcludingSubtasks=function(){return o.filter(this.data.issueByKey,function(e){return o.isUndefined(e.parentId)})};return n});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:sprint-model', location = 'includes/js/rapid/ui/plan/SprintModel.js' */
"use strict";define("jira-agile/rapid/ui/plan/sprint-model",["jira-agile/rapid/ui/plan/issue-list-model"],function(n){function t(t,i){this.sprintData=t;this.issueList=new n("sprint-"+t.id,i,GH.VersionController.getVersionModel())}t.isSprintModel=function(t){return"sprint"===t.getType()};t.prototype.getSprintData=function(){return this.sprintData};t.prototype.setSprintData=function(t){this.sprintData=t};t.prototype.getIssueList=function(){return this.issueList};t.prototype.getId=function(){return this.sprintData.id};t.prototype.getType=function(){return"sprint"};t.prototype.getName=function(){return this.sprintData.name};t.prototype.getSprintId=function(){return this.sprintData.id};t.prototype.isFutureSprint=function(){return"FUTURE"===this.sprintData.state};t.prototype.isActiveSprint=function(){return"ACTIVE"===this.sprintData.state};t.prototype.isSprintScheduled=function(){return this.sprintData.autoStartStop};return t});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:plan-issuelist-filtering', location = 'includes/js/rapid/ui/plan/PlanIssueListFiltering.js' */
"use strict";define("jira-agile/rapid/ui/plan/plan-issue-list-filtering",["require"],function(e){var i=e("underscore"),r={EPIC_FILTER_KEY_NONE:"none",VERSION_FILTER_ID_NONE:"none",allFilters:{},isNoneEpicFilterKey:function(e){return e===r.EPIC_FILTER_KEY_NONE},isNoneVersionFilterId:function(e){return e===r.VERSION_FILTER_ID_NONE},setFilter:function(e,n){n?r.allFilters[e]=n:delete r.allFilters[e]},clearAllFilters:function(){var e=!i.isEmpty(i.keys(r.allFilters));r.allFilters={};return e},_getCompoundFilter:function(){return function(n,t){return!i.any(r.allFilters,function(e){return!e(n,t)})}},setEpicFilter:function(n){var e=null;r.isNoneEpicFilterKey(n)?e=function(e){var n="object"==typeof e.parent&&e.parent.epic;return i.isEmpty(e.epic)&&!n}:n&&(e=function(e){return e.epic===n||e.parent&&e.parent.epic===n});return r.setFilter("epics",e)},setVersionFilter:function(n){var e=null;r.isNoneVersionFilterId(n)?e=function(e){return i.isEmpty(e.fixVersions)}:r.isVersionSelectable(n)&&(e=function(e){return i.some(e.fixVersions,function(e){return e===parseInt(n,10)})});return r.setFilter("versions",e)},isVersionSelectable:function(e){return null!=e},setInstantFilter:function(e){r.setFilter("instant",e)},applyToIssueLists:function(e){var n=r._getCompoundFilter(),t=!1;i.each(e,function(e){e=e.applySearchFilter(n);t=t||e});return t},applyToIssueList:function(e){r.applyToIssueLists([e])}};return r});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:backlog-model', location = 'includes/js/rapid/ui/plan/BacklogModel.js' */
"use strict";define("jira-agile/rapid/ui/plan/backlog-model2",["require"],function(e){var s=e("jira-agile/rapid/ui/plan/issue-list-model"),e=function(e,t){this.column=t;this.issueList=new s("backlog",e,GH.VersionController.getVersionModel())};e.isBacklogModel=function(e){return"backlog"===e.getType()};e.prototype.getIssueList=function(){return this.issueList};e.prototype.isAnyIssueInBacklog=function(e){var t=this.getIssueList().getAllIssues(),s=Object.keys(t);return e.some(function(e){return s.includes(e)})};e.prototype.getId=function(){return"backlog"};e.prototype.getType=function(){return"backlog"};e.prototype.getColumn=function(){return this.column};return e});define("jira-agile/rapid/ui/plan/backlog-model",["require"],function(e){var o,l=e("underscore"),t=e("jira-agile/rapid/global-events"),d=e("jira-agile/rapid/ui/plan/sprint-model"),u=e("jira-agile/rapid/ui/plan/plan-issue-list-filtering"),r=e("jira-agile/rapid/ui/plan/issue-list-model");t.on("pre-initialization",function(){o=e("jira-agile/rapid/ui/plan/sprint-controller")});var c={rankCustomFieldId:void 0,estimationStatistic:{},trackingStatistic:{},sprintModels:[],backlogModel2:null,missingParentsByKey:{},setData:function(e){c.calculateIssueLists(e);c.hasBulkChangePermission=e.hasBulkChangePermission;c.issueArchivingEnabled=e.issueArchivingEnabled;c.cardColorStrategy=e.cardColorStrategy;e.missingParents&&(c.missingParentsByKey=l.indexBy(e.missingParents,"key"))}};function s(e){var t,s,n,i,t=(t=e.issues,s=[].concat(l.toArray(e.issues)).concat(l.toArray(e.missingParents)),n=l.indexBy(s,"key"),t.map(function(e){return"string"==typeof e.parentKey&&0<e.parentKey.length?l.defaults({parent:n[e.parentKey]},e):e})),r=e.backlogColumn.statusIds;e.selectedForDevelopmentColumn&&(i=e.selectedForDevelopmentColumn.statusIds);var u=[],a=[];l.each(t,function(e){GH.ExtraFieldsHelper.prepareExtraFields(e.extraFields);-1!==r.indexOf(e.statusId)?u.push(e):i&&-1!==i.indexOf(e.statusId)&&a.push(e)});c.backlogModel2=new GH.BacklogModel2(u,e.backlogColumn);e.selectedForDevelopmentColumn?c.sprintModels=[new d({id:-1,name:e.selectedForDevelopmentColumn.name,state:"FUTURE",column:e.selectedForDevelopmentColumn},a)]:c.sprintModels=[]}c.calculateIssueLists=function(e){(GH.RapidBoard.State.isScrumBoard()?function(e){var t=e.issues,s=e.sprints,n={};l.each(s,function(t){l.each(t.issuesIds,function(e){n[e]=t.id})});var i={};l.each(s,function(e){i[e.id]=[]});var r=[];l.each(t,function(e){GH.ExtraFieldsHelper.prepareExtraFields(e.extraFields);var t=n[e.id];(t?i[t]:r).push(e)});var u=[];l.each(s,function(e){e=new d(e,i[e.id]);u.push(e)});e=new GH.BacklogModel2(r,e.backlogColumn);c.sprintModels=u;c.backlogModel2=e}:s)(e)};c.addNewSprint=function(e){e=new d(e,[]);c.sprintModels.push(e)};c.removeSprintAndMoveIssues=function(t){for(var e,s,n=c.getAllModels(),i=0;i<n.length;i++){var r=n[i];if(d.isSprintModel(r)&&r.getSprintId()===t){e=r;s=n[i+1];break}}var u=!1;if(e){var a=e.getIssueList().getIssuesInOrder();if(!l.isEmpty(a)){s.getIssueList().prependIssues(a);u=GH.BacklogModel2.isBacklogModel(s)}c.sprintModels=l.reject(c.sprintModels,function(e){return e.getSprintId()===t})}return u};c.updateDataForSprint=function(e,t){e=c.getSprintModel(e);e&&e.setSprintData(t);return e};c.moveSprintUp=function(e){return c._swapSprint(e,-1)};c.moveSprintDown=function(e){return c._swapSprint(e,1)};c._swapSprint=function(t,e){var s=GH.Util.indexOf(c.sprintModels,function(e){if(e.getSprintId()===t)return e});if(GH.Util.swapArrayItems(c.sprintModels,s,s+e))return c.sprintModels[s].getSprintId();return null};c.getSprintModels=function(){return c.sprintModels};c.getActiveSprintModels=function(){return l.filter(c.sprintModels,function(e){return"ACTIVE"===e.getSprintData().state})};c.getFutureSprintModels=function(){return l.filter(c.sprintModels,function(e){return"FUTURE"===e.getSprintData().state})};c.getSprintModel=function(t){return l.find(c.sprintModels,function(e){return t===e.getSprintId()})};c.findTargetModel=function(e){var t=e||"backlog";return l.find(c.getAllModels(),function(e){return t===e.getId()})};c.getBacklogModel2=function(){return c.backlogModel2};c.getAllModels=function(){var e=c.getSprintModels(),t=c.getBacklogModel2();return l.flatten([e,t],!0)};c.getAllIssueListsNew=function(){var e=l.reject(c.getAllModels(),l.isEmpty);return l.map(e,function(e){return e.getIssueList()})};c.getAllIssuesWithMissingParents=function(){var e=c.getAllModels().reduce(function(e,t){return l.extend({},e,t.issueList.getAllIssues())},{});return l.extend({},e,c.missingParentsByKey)};c.findModelWithIssue=function(t){var s=null;l.any(c.getAllModels(),function(e){if(e.getIssueList().isIssueValid(t)){s=e;return!0}return!1});return s};c.findModelsWithFakeParent=function(t){return l.filter(c.getAllModels(),function(e){return!e.issueList.isIssueValid(t)&&l.any(e.issueList.data.issueByKey,function(e){return e.parentKey===t})})};c.getNextModel=function(e){for(var t=c.getAllModels(),s=0;s<t.length;s++)if(e.getId()===t[s].getId()){if(s+1<t.length)return t[s+1];break}return null};c.calculateRankingDataForSprintMarkerMove=function(e,t,s){var n=c._calculateIncludedModelsData(e,t);if(e===t){var i=[],i=s?n.draggedSprintModel.getIssueList().getVisibleIssuesDataAfterKey(s):n.draggedSprintModel.getIssueList().getAllVisibleIssuesData();if(!l.isEmpty(i)){var r=c.getNextModel(n.draggedSprintModel);if(r){var u=d.isSprintModel(r)?r.getSprintId():null,a=l.first(r.getIssueList().getIssuesInOrder()),r=a?a.key:null,a=l.map(i,function(e){return e.key});if(!l.isEmpty(a))return{sprintId:u,nextRankableId:r,issueKeys:a}}}}else{s=c.getIssueDataForVisisbleIssuesInModelsUpToIssueKey(n.otherAffectedModels,t,s),u=e,n=l.last(n.draggedSprintModel.getIssueList().getIssuesInOrder()),n=n?n.key:null,a=l.map(s,function(e){return e.key});if(!l.isEmpty(a))return{sprintId:u,prevRankableId:n,issueKeys:a}}return null};c.calculateTemporaryDataForSprintWithMarker=function(e,t,s){var n=c._calculateIncludedModelsData(e,t),i=n.draggedSprintModel.getIssueList().getAllInvisibleIssuesData(),s=c.getIssueDataForVisisbleIssuesInModelsUpToIssueKey(n.models,t,s),s=l.flatten([i,s],!0),i=l.map(i,function(e){return e.key}),s=new r("fakesprint-"+e,s,GH.VersionController.getVersionModel());s.setHiddenBySearchIssues(i);return{issueList:s,modelsData:n}};c._calculateIncludedModelsData=function(e,t){for(var s=c.getSprintModels(),n=!1,i={draggedSprintModel:null,otherAffectedModels:[],models:[]},r=0;r<s.length;r++){var u=s[r],a=u.getSprintId();if(a===e){i.draggedSprintModel=u;i.models.push(u);n=!0}else if(n&&o.isTwixieOpen(a)){i.otherAffectedModels.push(u);i.models.push(u)}if(a===t)break}if(!t){i.otherAffectedModels.push(c.getBacklogModel2());i.models.push(c.getBacklogModel2())}return i};c.getIssueDataForVisisbleIssuesInModelsUpToIssueKey=function(e,t,s){for(var n=[],i=0;i<e.length;i++){var r=e[i],u=r.getIssueList(),a=d.isSprintModel(r);a&&r.getSprintId()===t||!a&&!t?s&&n.push(u.getVisibleIssuesDataBeforeIncludingKey(s)):n.push(u.getAllVisibleIssuesData())}return n=l.flatten(n,!0)};c.reorderIssuesInModel=function(e,t){var s=c.findTargetModel(t);if(s){var t=s.getIssueList(),n=t.getAllIssues();t.setOrder(e.filter(function(e){return n[e]}));return[s]}return[]};c.moveIssuesNew=function(s,e,t,n){if(0!==s.length){var i=[],r=[],u=e||"backlog",a=null;l.each(c.getAllModels(),function(e){if(e.getId()===u)a=e;else{var t=e.getIssueList().removeIssues(s);if(!l.isEmpty(t)){r.push(e);i.push(t)}}});i=l.flatten(i,!0);if(a){e=a.getIssueList();e.addIssues(i);e.reorderIssues(s,t,n);r.push(a)}return r}};c.hasAnySubtasks=function(e){if(!e)throw"Selection of issueKeys as an {array} must be provided.";return e.some(function(e){return this.isSubtask(e)}.bind(this))};c.afterIssueUpdate=function(t){var s=this;if(this.isSubtask(t.key)){if("string"==typeof t.parentKey){var e=this.findModelWithIssue(t.key).getIssueList(),n=e.getIssueData(t.key),i="string"==typeof n.parentKey&&this.getAllIssuesWithMissingParents()[n.parentKey];l.isObject(i)&&e.updateIssue(l.extend({},n,{parent:i}))}}else l.chain(this.getAllIssuesWithMissingParents()).filter(function(e){return s.isSubtask(e.key)}).filter(function(e){return e.parentKey===t.key}).value().forEach(function(e){e.parent=t})};c.filterOnlySubtasks=function(e){return e?e.filter(function(e){return this.isSubtask(e)}.bind(this)):[]};c.isSubtask=function(e){e=this.getIssueData(e);return!(!e||!e.parentKey)};c.isIssueSelectable=function(t){var e=c.getAllIssueListsNew();return l.any(e,function(e){return e.isIssueValid(t)&&e.isIssueVisible(t)})};c.getIssueIndex=function(t){var s=-1,e=c.getAllIssueListsNew();l.any(e,function(e){if(!e.isIssueValid(t))return!1;s=e.getIssueIndex(t);return!0});return s};c.canAddToSelection=function(t,s){var e=c.getAllIssueListsNew();return l.any(e,function(e){return e.isIssueValid(s)&&e.canAddToSelection(t,s)})};c.getIssueRange=function(t,s){var n=[],e=c.getAllIssueListsNew();l.any(e,function(e){if(!e.isIssueValid(t)||!e.isIssueValid(s))return!1;n=e.getIssueRange(t,s);return!0});return n};c.getNextIssueKey=function(e){for(var t=c.getAllModels(),s=0;s<t.length;s++){var n=t[s];if(n.getIssueList().isIssueValid(e)){var i=!1,r=d.isSprintModel(n),u=o.isTwixieOpen(n.getId());if((r&&u||!r)&&(i=n.getIssueList().getNextIssueKey(e)))return i;for(var a=s+1;a<t.length;a++){var l=t[a],r=d.isSprintModel(l),u=o.isTwixieOpen(l.getId());if((!r||u)&&(i=l.getIssueList().getFirstVisibleIssueKey()))break}return i}}};c.getPreviousIssueKey=function(e){for(var t=c.getAllModels(),s=0;s<t.length;s++){var n=t[s];if(n.getIssueList().isIssueValid(e)){var i=!1,r=d.isSprintModel(n),u=o.isTwixieOpen(n.getId());if((r&&u||!r)&&(i=n.getIssueList().getPreviousIssueKey(e)))return i;for(var a=s-1;0<=a;a--){var l=t[a],r=d.isSprintModel(l),u=o.isTwixieOpen(l.getId());if((!r||u)&&(i=l.getIssueList().getLastVisibleIssueKey()))break}return i}}};c.getFirstRankableIssueKeyInColumn=function(t,s){var n=null!=t,i=n?[t]:[],r=!1,e=c.getAllIssueListsNew();l.any(e,function(e){if(n&&!e.isIssueValid(t))return!1;r=e.getFirstRankableIssueKeyInColumn(i,s);return!0});return r};c.getLastRankableIssueKeyInColumn=function(t,s){var n=null!=t,i=n?[t]:[],r=!1,e=c.getAllIssueListsNew();l.any(e,function(e){if(n&&!e.isIssueValid(t))return!1;r=e.getLastRankableIssueKeyInColumn(i,s);return!0});return r};c.getBestFitSelectionAfterRank=function(e){var t=c.findModelWithIssue(l.first(e));return t?t.getIssueList().getBestFitSelectionAfterRank(e):null};c.setRankCustomFieldId=function(e){c.rankCustomFieldId=e};c.setEstimationStatistic=function(e){c.estimationStatistic={isEnabled:e.isEnabled,typeId:e.typeId,name:e.name,renderer:e.renderer}};c.setTrackingStatistic=function(e){c.trackingStatistic={isEnabled:e.isEnabled,typeId:e.typeId,name:e.name,renderer:e.renderer}};c.isRankable=function(){return!l.isUndefined(c.rankCustomFieldId)};c.getRankCustomFieldId=function(){return c.rankCustomFieldId};c.getHiddenBySearchIssues=function(){var t={};l.each(c.getAllIssueListsNew(),function(e){e=e.getHiddenBySearchIssues();t=l.extend(t,e)});return t};c.getIssueData=function(t){return c._anyIssueList(t,function(e){return e.getIssueData(t)})};c.getIssueDataById=function(t){return c._anyIssueList(t,function(e){return e.getIssueDataById(t)})};c.getIssueIdForKey=function(t){return c._anyIssueList(t,function(e){return e.getIssueIdForKey(t)})};c._anyIssueList=function(t,s){var n=null;l.any(c.getAllIssueListsNew(),function(e){if(!e.isIssueValid(t))return!1;n=s(e);return!0});return n};c.isIssueVisible=function(e){var t=c.findModelWithIssue(e);if(t){t=t.getIssueList();return t.isIssueValid(e)&&t.isIssueVisible(e)}return!1};c.hasAnyIssueInvisible=function(e){return e.some(function(e){return!c.isIssueVisible(e)})};c.canManageSprints=function(){return c._canManageSprints};c.setCanManageSprints=function(e){c._canManageSprints=e};c.canCreateIssue=function(){return c._canCreateIssue};c.setCanCreateIssue=function(e){c._canCreateIssue=e};c.supportsPages=function(){return c._supportsPages};c.setSupportsPages=function(e){c._supportsPages=e};c.updateFiltering=function(){var e=c.getAllIssueListsNew();return u.applyToIssueLists(e)};c.getEpicsFilteredForVersion=function(s){var n=!1;l.isString(s)&&(u.isNoneVersionFilterId(s)?n=!0:s=parseInt(s,10));var e=GH.EpicController.getEpicModel().getEpicList();if(!e||0===e.getIssueCount())return[];var i=e.getOrder(),r=[];l.each(c.getAllIssueListsNew(),function(e){if(0<i.length){e=e.getAllIssues();l.each(e,function(e){if(e.epic&&l.contains(i,e.epic)){var t=!1;if(t=n&&l.isEmpty(e.fixVersions)||!n&&l.contains(e.fixVersions,s)?!0:t){r.push(e.epic);if(0===(i=l.without(i,e.epic)).length)return!1}}})}});return{filtered:i,unfiltered:r}};c.removeEpicFromIssues=function(e){var t=[];l.each(e,function(e){e=c.getIssueData(e);if(e&&e.epic){delete e.epic;t.push(e)}});return t};c.getCardColorStrategy=function(){return c.cardColorStrategy};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/component/extra-fields/ExtraFieldsHelper.js' */
"use strict";define("jira-agile/rapid/ui/component/extra-fields/ExtraFieldsHelper",["require"],function(e){function t(e){return e.html||e.text}var r=e("underscore"),n={epiclink:function(e){return GH.EpicConfig.getEpicNameString(e.text,e.epicKey)},html:function(e){if(e.html&&"&nbsp;"!==e.html){e.useSoyNoAutoescape=!0;return e.html}return""}};return{prepareExtraFields:function(e){r.each(e,function(e){var r=n[e.renderer]||t;e.renderedContent=r(e)})}}});AJS.namespace("GH.ExtraFieldsHelper",null,require("jira-agile/rapid/ui/component/extra-fields/ExtraFieldsHelper"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/GridSwimlanesData.js' */
"use strict";define("jira-agile/rapid/ui/work/grid-swimlanes-data",["underscore"],function(o){var r={calculateSwimlanesData:function(e,a,s){var i=[];switch(a.swimlaneStrategy){case"parentChild":i=r.calculateParentChildSwimlanes(e,a.parentSwimlanesData,s);break;case"assignee":i=r.calculateAssigneeSwimlanes(e,!1);break;case"assigneeUnassignedFirst":i=r.calculateAssigneeSwimlanes(e,!0);break;case"custom":i=r.calculateCustomSwimlanes(e,a.customSwimlanesData);break;case"epic":i=r.calculateEpicSwimlanes(e,a.epicSwimlanesData);break;case"project":i=r.calculateProjectSwimlanes(e);break;case"none":default:i=r.calculateNoneSwimlanes(e)}return{type:a.swimlaneStrategy,swimlanes:i,rapidViewId:a.rapidViewId}},calculateCustomSwimlanes:function(e,a){e=e.issues,a=a.swimlanes;r.calculateSwimlaneIssueKeys(e,a);return a},calculateSwimlaneIssueKeys:function(e,a){var s;o.each(a,function(a){a.issueKeys=[];if(!o.isEmpty(a.issueIds)){if(!s){s={};o.each(e,function(e){s[e.id]=e.key})}o.each(a.issueIds,function(e){a.issueKeys.push(s[e])})}})},calculateParentChildSwimlanes:function(e,i,n){var t={};o.each(e.missingParents,function(e){t[e.id]=e});var a=i.parentIssueIds,s=[],r={};o.each(e.issues,function(e){if(e.parentId){s.push(e.parentId);r[e.parentId]||(r[e.parentId]=[]);r[e.parentId].push(e.key)}else{s.push(e.id);t[e.id]=e}});var s=o.uniq(s,!0),e=o.intersection(s,a),u=1,c=[];o.each(e,function(e){var a=r[e]||[],s=t[e],e=o.contains(i.doneCandidates,e),s={id:u++,name:s.key,description:s.summary,defaultSwimlane:!1,parentKey:s.key,query:"",issueKeys:a,avatarUrl:(n.types[s.typeId]||s).typeUrl,parentOutOfSync:e};e&&GH.WorkController.analytics.trigger("movetodonebutton.shown");c.push(s)});var e=o.filter(s,function(e){return!o.include(a,e)}),l=[];o.each(e,function(e){e=t[e];l.push(e.key)});e={id:u++,name:"Otras incidencias",description:"",defaultSwimlane:!0,query:"",issueKeys:l};c.push(e);return c},calculateAssigneeSwimlanes:function(e,a){var s={},i=[];o.each(e.issues,function(e){if(e.assignee){s[e.assignee]=s[e.assignee]||[];s[e.assignee].push(e)}else i.push(e.key)});var n=1,t=[];o.each(s,function(e){var a=e[0].assigneeName,e={id:n++,name:a,lowercaseName:a.toLowerCase(),description:a,defaultSwimlane:!1,query:"",issueKeys:o.map(e,function(e){return e.key})};t.push(e)});t.sort(r.swimlaneNameComparator);if(!o.isEmpty(i)){e={id:n++,name:"Sin asignar",description:"",defaultSwimlane:!1,query:"",issueKeys:i};a?t.splice(0,0,e):t.push(e)}return t},calculateEpicSwimlanes:function(e,s){var i={},n=[],t={},a=[];o.each(e.issues,function(e){if(e.epic){i[e.epic]=i[e.epic]||[];i[e.epic].push(e.key);t[e.key]=e.epic}else e.parentKey?a.push(e):e.typeId!==GH.EpicConfig.getEpicIssueTypeId()&&n.push(e.key)});o.each(a,function(e){var a=t[e.parentKey];(a?i[a]:n).push(e.key)});var r=[],u=1;o.each(s.epics,function(e){var a=GH.EpicConfig.getEpicNameString(s.epicNames[e],e),e={id:u++,name:a,lowercaseName:a.toLowerCase(),description:a,defaultSwimlane:!1,query:"",issueKeys:i[e]||[]};r.push(e)});if(!o.isEmpty(n)){e={id:u++,name:"Incidencias sin epics",description:"",defaultSwimlane:!0,query:"",issueKeys:n};r.push(e)}return r},calculateProjectSwimlanes:function(e){var a=[];o.each(e.issues,function(e){a[e.projectId]=a[e.projectId]||[];a[e.projectId].push(e.key)});var s=[],i=1;o.each(e.projects,function(e){e={id:i++,name:e.key,lowercaseName:e.key,description:e.name,defaultSwimlane:!1,query:"",avatarUrl:e.avatarUrl,issueKeys:a[e.id]||[]};0<e.issueKeys.length&&s.push(e)});s.sort(r.swimlaneNameComparator);return s},calculateNoneSwimlanes:function(e){return[{id:1,name:"None",description:"None",defaultSwimlane:!0,query:"",issueKeys:o.map(e.issues,function(e){return e.key})}]},swimlaneNameComparator:function(e,a){return e.lowercaseName.localeCompare(a.lowercaseName)}};return r});AJS.namespace("GH.GridSwimlanesData",null,require("jira-agile/rapid/ui/work/grid-swimlanes-data"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/WorkIssueListUtil.js' */
"use strict";define("jira-agile/rapid/ui/work/issue-list-util",["underscore"],function(u){var e={calculateGroupData:function(e){var i={fakeParents:{},beginGroups:{},endGroups:{}};u.each(e,function(e){GH.IssueListUtil._calculateGroupData(i,e)});return i},_calculateGroupData:function(i,e){var r=null,a=null;u.each(e,function(e){if(e.parentId){if(r){if(r.parentId!==e.parentId){i.endGroups[r.id]=!0;i.beginGroups[e.id]=!0;i.fakeParents[e.id]=!0}}else{a&&a.id===e.parentId?i.beginGroups[a.id]=!0:i.fakeParents[e.id]=!0;i.beginGroups[e.id]=!0}r=e}else if(r){i.endGroups[r.id]=!0;r=null}a=e});r&&(i.endGroups[r.id]=!0)},buildDisplayIssueKey:function(e,i){if(null==i.availableWidth||!i.approxCharacterWidth)return e;var r=e.split("-"),a=r[0],r=r[1],i=Math.floor(i.availableWidth/i.approxCharacterWidth);if(i<e.length){i=i-r.length-2;return i<0?"":(a=a.substr(0,i))+"-"+r}return e},buildDisplayIssueKeyObj:function(e){var i=e.lastIndexOf("-");return{projectKey:e.substring(0,i),issueNumber:e.substring(i)}}};return e});AJS.namespace("GH.IssueListUtil",null,require("jira-agile/rapid/ui/work/issue-list-util"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/RankingModel.js' */
"use strict";define("jira-agile/rapid/ui/work/ranking-model",["underscore","require","jira-agile/rapid/global-events"],function(o,e,t){var d,l={};t.on("pre-initialization",function(){d=e("jira-agile/rapid/ui/work/grid-data-controller")});l.orderData={rankable:!1,rankCustomFieldId:void 0};l.setOrderData=function(e){l.orderData=e};l.isRankable=function(){return l.orderData.rankable};l.canUserRank=function(){if(!l.orderData.rankable)return!1;var t=!1;o.each(l.orderData.canRankPerProject,function(e){t=t||e.canRank});return t};l.canUserRankIssue=function(e){if(!l.isRankable())return!1;var t=e.substr(0,e.indexOf("-")),n=!1;o.each(l.orderData.canRankPerProject,function(e){e.projectKey===t&&(n=e.canRank)});return n};l.getRankCustomFieldId=function(){return l.isRankable()?l.orderData.rankCustomFieldId:null};l.isRankable=function(){return l.orderData.rankable};l.getFirstRankableIssueKeyInColumn=function(t){var e=d.getModel(),n=e._getIssuePositionAndDataByKey(t);if(n.isSwimlane)return!1;var e=e.getIssuesDataForCell(n.swimlaneId,n.columnId),r=!!n.issue.parentKey,e=o.find(e,function(e){return!r||l.canIssuesBeRankedTogether(e.key,t)});return!!e&&(!r&&e.parentKey||e.key)};l.getLastRankableIssueKeyInColumn=function(t){var e=d.getModel(),n=e._getIssuePositionAndDataByKey(t);if(n.isSwimlane)return!1;var e=e.getIssuesDataForCell(n.swimlaneId,n.columnId),r=!!n.issue.parentKey,a=!1;o.each(e,function(e){r?l.canIssuesBeRankedTogether(e.key,t)&&(a=e.key):a=e.parentKey||e.key});return a};l.canIssuesBeRankedTogether=function(e,t){var n=d.getModel(),e=n._getIssuePositionAndDataByKey(e),t=n._getIssuePositionAndDataByKey(t);return!(!e||!t)&&(!e.isSwimlane&&!t.isSwimlane&&(e.swimlaneId===t.swimlaneId&&(e.columnId===t.columnId&&(!e.issue.parentKey&&!t.issue.parentKey||e.issue.parentKey===t.issue.parentKey))))};l.getRankableIssuesRange=function(e,t){if(!l.canIssuesBeRankedTogether(e,t))return[];var n=d.getModel();if(e===t)return[e];var r=n._getIssuePositionAndDataByKey(e),t=n._getIssuePositionAndDataByKey(t);if(r.isSwimlane||t.isSwimlane)return[];var a=[];a.push(e);var s,i,u=n.getIssuesDataForCell(r.swimlaneId,r.columnId),r=r.issueIndex,o=t.issueIndex;if(r<o)for(s=r+1;s<=o;s++){i=u[s];l.canIssuesBeRankedTogether(e,i.key)&&a.push(i.key)}else for(s=r-1;o<=s;s--){i=u[s];l.canIssuesBeRankedTogether(e,i.key)&&a.push(i.key)}return a};l.getBestFitSelectionAfterRank=function(e){return l.getNextIssueAfterSendToBottom(e)||l.getPreviousIssueAfterSendToBottom(e)};l.getNextIssueAfterSendToBottom=function(e){var t=o.last(e),n=d.getModel(),r=n.getNextIssueKey(t);if(!r)return!1;var e=n.getIssueDataByKey(t),a=n.getIssueDataByKey(r);if(e.parentKey)return r;for(;a.parentKey&&a.parentKey===t;){if(!(r=n.getNextIssueKey(r)))return!1;a=n.getIssueDataByKey(r)}return r};l.getPreviousIssueAfterSendToBottom=function(e){var e=o.first(e),t=d.getModel(),n=t.getPreviousIssueKey(e);if(!n)return!1;var e=t.getIssueDataByKey(e),r=t.getIssueDataByKey(n);if(e.parentKey)return n;for(;r.parentKey;){if(!(n=t.getPreviousIssueKey(n)))return!1;r=t.getIssueDataByKey(n)}return n};l.reorderIssues=function(e,t,n){var r,a=d.getModel();e=l.getParentAndChildrenKeys(e);var s=a.getOrder();if(n)r=o.indexOf(s,n);else{r=o.indexOf(s,t);r++;if(l.isRankable())for(;r<s.length;){var i=a.getIssueDataByKey(s[r]);if(!i||i.parentKey!==t)break;r++}}var u=s.slice(0,r),n=s.slice(r),u=l.withoutArray(u,e),n=l.withoutArray(n,e),n=o.flatten([u,e,n]);a.updateOrder(n)};l.getParentAndChildrenKeys=function(e){var a=d.getModel(),s=a.getOrder(),i=[];o.each(e,function(e){i.push(e);var t=a.getIssueDataByKey(e);if(t&&!t.parentKey){e=o.indexOf(s,e);if(!(e<0))for(var n=e+1;n<s.length;n++){var r=a.getIssueDataByKey(s[n]);if(r.parentKey!==t.key)break;i.push(r.key)}}});return i};l.withoutArray=function(e,t){var n=e;o.each(t,function(e){n=o.without(n,e)});return n};return l});AJS.namespace("GH.RankingModel",null,require("jira-agile/rapid/ui/work/ranking-model"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/GridDataModel.js' */
"use strict";define("jira-agile/rapid/ui/work/grid-data-model",["jira-agile/rapid/logger","underscore","jira-agile/rapid/ui/component/extra-fields/ExtraFieldsHelper","jira-agile/rapid/ui/work/issue-list-util"],function(t,o,n,s){function e(e,t,n,i,s,r,a,o,u){var l=this.data={};l.columns=e;l.columnIssueMapping=t;l.swimlanes=n;l.swimlaneIssueMapping=i;l.issues=s;l.order=r;l.variables=a;l.swimlaneStrategy=o;l.cardColorStrategy=u;this.buildCache();this.preprocessIssues()}e.prototype.isModelDifferent=function(e){if(!o.isEqual(this.data.order,e.data.order)){t.log("GridDataModel comparison: The order differs");return!0}if(!o.isEqual(this.data.issues,e.data.issues)){t.log("GridDataModel comparison: The issues details differ");return!0}if(!o.isEqual(this.data.swimlaneIssueMapping,e.data.swimlaneIssueMapping)){t.log("GridDataModel comparison: The swimlanes differ");return!0}if(!o.isEqual(this.data.columnIssueMapping,e.data.columnIssueMapping)){t.log("GridDataModel comparison: The columns differ");return!0}t.log("GridDataModel comparison: Everything is equal");return!1};e.prototype.buildCache=function(){var s=this,r=this.data,a=this.cache={};a.bySwimlaneThenColumn={};var o=this.createRankMap(r.order);r.swimlanes.forEach(function(n){a.bySwimlaneThenColumn[n.id]={};var i=s.toSet(r.swimlaneIssueMapping[n.id]);r.columns.forEach(function(e){var t=r.columnIssueMapping[e.id],t=s.filterBySwimlane(t,i),t=s.sortByRank(t,o);a.bySwimlaneThenColumn[n.id][e.id]=t})})};e.prototype.toSet=function(e){var t=new Set;e.forEach(function(e){return t.add(e)});return t};e.prototype.createRankMap=function(e){var n={};e.forEach(function(e,t){return n[e]=t});return n};e.prototype.filterBySwimlane=function(e,t){return e.filter(function(e){return t.has(e)})};e.prototype.sortByRank=function(e,n){return e.sort(function(e,t){return n[e]-n[t]})};e.prototype.preprocessIssues=function(){var t=this;o.each(this.data.issues,function(e){t.preprocessIssue(e)})};e.prototype.preprocessIssue=function(e){this.computeTimeInColumnForIssue(e);n.prepareExtraFields(e.extraFields)};e.prototype.computeTimeInColumnForIssue=function(e){e.timeInColumn&&(e.timeInColumn.days=Math.floor((e.timeInColumn.durationPreviously+(new Date).getTime()-e.timeInColumn.enteredStatus)/864e5))};e.prototype.updateIssueData=function(e){this.preprocessIssue(e);this.data.issues[e.key]=e};e.prototype.updateOrder=function(e){this.data.order=e;this.buildCache()};e.prototype.getGroupData=function(){var n=[],i=this;o.each(i.data.swimlanes,function(t){o.each(i.data.columns,function(e){n.push(i.getIssuesDataForCell(t.id,e.id))})});var e=s.calculateGroupData(n);e.drawFakeParents=!this.isParentChildStrategy();return e};e.prototype.getIssuesDataForCell=function(e,t){e=this.cache.bySwimlaneThenColumn[e];if(!e)return!1;t=e[t];return!!t&&this.getIssueDataByKeys(t)};e.prototype.getIssueDataByKeys=function(e){var t=[],n=this.data.issues;o.each(e,function(e){e=n[e];e&&t.push(e)});return t};e.prototype.getCells=function(){return this.cache.bySwimlaneThenColumn};e.prototype.getIssues=function(){return this.data.issues};e.prototype.getColumns=function(){return this.data.columns};e.prototype.getSwimlanes=function(){return this.data.swimlanes};e.prototype.getOrder=function(){return this.data.order};e.prototype.getSwimlaneById=function(t){return o.find(this.data.swimlanes,function(e){return e.id===t})};e.prototype.getColumnById=function(t){return o.find(this.data.columns,function(e){return e.id===t})};e.prototype.getFirstColumn=function(){return o.first(this.data.columns)};e.prototype.getSwimlaneIdByIssueKey=function(n){var i=!1;o.each(this.data.swimlaneIssueMapping,function(e,t){-1<o.indexOf(e,n)&&(i=parseInt(t,10))});return i};e.prototype.getColumnIdByIssueKey=function(n){var i=!1;o.each(this.data.columnIssueMapping,function(e,t){-1<o.indexOf(e,n)&&(i=parseInt(t,10))});return i};e.prototype.getIssueData=e.prototype.getIssueDataByKey=function(e){return this.data.issues[e]};e.prototype.getIssueDataById=function(e){return o.findWhere(this.data.issues,{id:e})};e.prototype.getIssueIdForKey=function(e){e=this.getIssueDataByKey(e);return!!e&&e.id};e.prototype.isIssueValid=function(e){return!!this.data.issues[e]};e.prototype.hasSwimlanes=function(){var t=this,n=t.isParentChildStrategy();return o.any(t.getSwimlanes(),function(e){return(n||0<t.getSwimlaneIssueCount(e.id))&&!e.defaultSwimlane})};e.prototype.getSwimlaneIssueCount=function(e){return this.data.swimlaneIssueMapping[e].length};e.prototype.getColumnIssueCount=function(e){return this.data.columnIssueMapping[e].length};e.prototype.isParentChildStrategy=function(){return"parentChild"===this.data.variables.swimlanesType};e.prototype.getParentSwimlaneByIssueKey=function(t){return this.isParentChildStrategy()&&o.find(this.data.swimlanes,function(e){if(e.parentKey===t)return!0})||!1};e.prototype._getIssuePositionAndDataByKey=function(t){var e=this.data.issues[t];if(!e)return!1;var n=!1;this.isParentChildStrategy()&&o.each(this.data.swimlanes,function(e){e.parentKey===t&&(n=e)});if(n)return{isSwimlane:!0,swimlaneId:n.id,columnId:o.first(this.getColumns()).id,issueIndex:-1,issue:e};var i=this.getSwimlaneIdByIssueKey(t);if(!i)return!1;var s=this.getColumnIdByIssueKey(t);if(!s)return!1;var r,a=-1;i&&s&&(r=this.cache.bySwimlaneThenColumn[i][s],a=o.indexOf(r,t));return{swimlaneId:i,columnId:s,issueIndex:a,issue:e}};e.prototype.getIssueIndexByKey=function(e){e=this._getIssuePositionAndDataByKey(e);return!!e&&e.issueIndex};e.prototype.getNextIssueKey=function(e,t){var n=this._getIssuePositionAndDataByKey(e);if(!n)return!1;t&&(n.columnId=t);var i=this,s=i.getCells(),r=!1,a=!1;o.find(i.getSwimlanes(),function(e){var t;if(e.id===n.swimlaneId){r=!0;t=n.issueIndex+1}else{if(!r)return!1;if(e.parentKey){a=e.parentKey;return!0}t=0}return(!i.hasSwimlanes()||!GH.RapidBoard.State.isSwimlaneCollapsed(e.id))&&!!(a=s[e.id][n.columnId][t])});return a||!1};e.prototype.getPreviousIssueKey=function(t,e){var n=this._getIssuePositionAndDataByKey(t);if(!n)return!1;e&&(n.columnId=e);var i=this,s=i.getCells(),r=!1,a=!1,e=i.getSwimlanes().slice(0).reverse();o.find(e,function(e){if(e.id!==n.swimlaneId&&!r)return!1;r=!0;if(e.id===n.swimlaneId){if(e.parentKey===t)return!1;if(0===n.issueIndex&&e.parentKey){a=e.parentKey;return!0}return!!(a=s[e.id][n.columnId][n.issueIndex-1])}if(!(i.hasSwimlanes()&&GH.RapidBoard.State.isSwimlaneCollapsed(e.id))&&0<s[e.id][n.columnId].length)return!!(a=o.last(s[e.id][n.columnId]));if(e.parentKey){a=e.parentKey;return!0}return!1});return a||!1};e.prototype.getIssueKeyForColumnAtIndex=function(e,t,n){t=this.cache.bySwimlaneThenColumn[e][t];return!o.isEmpty(t)&&(n<0?t[0]:n>=t.length?o.last(t):t[n])};e.prototype.getFirstIssueKey=function(){var e=this.getSwimlanes(),t=this.getColumns(),n=this.getCells(),i=this.hasSwimlanes(),s=!1;o.find(t,function(t){o.find(e,function(e){if(i&&GH.RapidBoard.State.isSwimlaneCollapsed(e.id))return!1;e=n[e.id][t.id];if(o.isEmpty(e))return!1;s=o.first(e);return!0});return s});return s};e.prototype.getLastIssueKey=function(){var e=this.getSwimlanes().slice().reverse(),t=this.getColumns(),n=this.getCells(),i=this.hasSwimlanes(),s=!1;o.find(t,function(t){o.find(e,function(e){if(i&&GH.RapidBoard.State.isSwimlaneCollapsed(e.id))return!1;e=n[e.id][t.id];if(o.isEmpty(e))return!1;s=o.last(e);return!0});return s});return s};e.prototype.getIssueKeyInPreviousColumn=function(e,t){var n=this._getIssuePositionAndDataByKey(e);if(!n)return!1;if(n.isSwimlane)return!1;for(var i=this._getPreviousColumn(n.columnId);i;){var s=this.getIssueKeyForColumnAtIndex(n.swimlaneId,i.id,t);if(s)return s;i=this._getPreviousColumn(i.id)}return!1};e.prototype._getPreviousColumn=function(e){for(var t=this.getColumns(),n=t.length-1;0<n;n--)if(t[n].id===e)return t[n-1];return!1};e.prototype.getIssueKeyInNextColumn=function(e,t){var n=this._getIssuePositionAndDataByKey(e);if(!n)return!1;if(n.isSwimlane)return!1;for(var i=this._getNextColumn(n.columnId);i;){var s=this.getIssueKeyForColumnAtIndex(n.swimlaneId,i.id,t);if(s)return s;i=this._getNextColumn(i.id)}return!1};e.prototype._getNextColumn=function(e){for(var t=this.getColumns(),n=0;n<t.length-1;n++)if(t[n].id===e)return t[n+1];return!1};e.prototype.getIssuePositionByKey=function(e){e=this._getIssuePositionAndDataByKey(e);if(e)return{swimlaneId:e.swimlaneId,columnId:e.columnId,position:e.issueIndex}};e.prototype.getIssueKeyAtPosition=function(e){if(e&&void 0!==e.swimlaneId&&void 0!==e.columnId&&void 0!==e.position){for(var t,n,i=this.getSwimlanes(),s=0,r=i.length;s<r;s++)if(i[s].id===e.swimlaneId){t=i[s];s+1<r&&(n=i[s+1]);break}if(t&&this.getColumnById(e.columnId)){var a=this.cache.bySwimlaneThenColumn[e.swimlaneId][e.columnId];return a[e.position]||(n?this.getIssueKeyAtPosition({swimlaneId:n.id,columnId:e.columnId,position:0}):o.last(a))}}};e.prototype.moveIssueToColumn=function(e,t,n){this.moveIssuesToColumn([e],t,n)};e.prototype.moveIssuesToColumn=function(e,t,n){var i=this.data.columnIssueMapping;if(!i[t]||!i[n])return!1;e.forEach(function(e){i[t]=o.without(i[t],e);i[n].push(e)});this.buildCache()};e.prototype.removeEpicFromIssues=function(e){var t=[],e=this.getIssueDataByKeys(e);o.each(e,function(e){if(e.epic){delete e.epic;t.push(e)}});return t};e.prototype.getSwimlaneStrategy=function(){return this.data.swimlaneStrategy};e.prototype.getCardColorStrategy=function(){return this.data.cardColorStrategy};return e});AJS.namespace("GH.GridDataModel",null,require("jira-agile/rapid/ui/work/grid-data-model"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/GridColumnsData.js' */
"use strict";define("jira-agile/rapid/ui/work/grid-columns-data",["underscore"],function(a){var n={calculateColumnsData:function(t,i,u){i=i.columns,u=n.computeBusted(i,u);return{columns:i,columnIssueMapping:n.getColumnIssueMapping(t,i),anyColumnBusted:u}},getColumnIssueMapping:function(t,i){var u={},n={},e={};a.each(i,function(i){u[i.id]=[];e[i.id]={visible:0,total:i.statisticsFieldValue||0};a.each(i.statusIds,function(t){n[t]=i.id})});a.each(t.issues,function(t){var i=n[t.statusId];if(u[i]){u[i].push(t.key);t.columnStatistic&&t.columnStatistic.statFieldValue&&(e[i].visible+=t.columnStatistic.statFieldValue.value)}});a.each(i,function(t){t.stats=e[t.id]});return u},computeBusted:function(t,i){if(!i.fieldConfigured)return!1;var u=!1;a.each(t,function(t){t.minBusted=void 0!==t.min&&t.min>t.statisticsFieldValue;t.maxBusted=void 0!==t.max&&t.max<t.statisticsFieldValue;u=u||t.minBusted||t.maxBusted});return u},getColumnIdForStatus:function(t,i){t=a.find(t,function(t){return a.find(t.statusIds,function(t){if(parseInt(t,10)===i)return!0})});return!!t&&t.id}};return n});AJS.namespace("GH.GridColumnsData",null,require("jira-agile/rapid/ui/work/grid-columns-data"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-grid-data-controller', location = 'includes/js/rapid/ui/work/GridDataController.js' */
"use strict";define("jira-agile/rapid/ui/work/grid-data-controller",["underscore","jira-agile/rapid/ui/work/grid-data-model","jira-agile/rapid/ui/work/grid-columns-data","jira-agile/rapid/ui/work/grid-swimlanes-data","jira-agile/rapid/ui/work/ranking-model"],function(c,d,m,g,e){var i={model:void 0,swimlaneStrategy:"custom",statistics:{},canRelease:!1,hasDataChanged:function(a){a=i.calculateGridDataModel(a);return!i.model||i.model.isModelDifferent(a)},setData:function(a){i.statistics=a.statistics;i.epics=a.epicData;i.canRelease=a.issuesData.canRelease;e.setOrderData(a.orderData);i.hasBulkChangePermission=a.issuesData.hasBulkChangePermission;i.issueArchivingEnabled=a.issuesData.issueArchivingEnabled;a=i.calculateGridDataModel(a);i.model=a},calculateGridDataModel:function(e){var a=g.calculateSwimlanesData(e.issuesData,e.swimlanesData,e.entityData),t=[],s={};c.each(e.issuesData.issues,function(a){t.push(a.key);s[a.key]=a});c.each(e.issuesData.missingParents,function(a){s[a.key]=a;!s[a.key].status&&e.entityData.statuses[a.statusId]&&(s[a.key].status=e.entityData.statuses[a.statusId].status)});var i=m.calculateColumnsData(e.issuesData,e.columnsData,e.statistics),n=i.columns,u=i.columnIssueMapping,r={};r.anyColumnBusted=i.anyColumnBusted;var l=[],o={};c.each(a.swimlanes,function(a){o[a.id]=a.issueKeys;delete a.issueKeys;l.push(a)});r.swimlanesType=a.type;return new d(n,u,l,o,s,t,r,e.swimlanesData.swimlaneStrategy,e.cardColorStrategy)},getStatistics:function(){return i.statistics},getEpicsCount:function(){return i.epics.epicsCount},getModel:function(){return i.model},hasBustedColumns:function(){return i.model.data.variables.anyColumnBusted},getSwimlanesType:function(){return i.model.data.variables.swimlanesType},collectPrintableIssues:function(){var t=i.getModel(),s=[];c.each(t.getSwimlanes(),function(e){c.each(t.getColumns(),function(a){a=t.getCells()[e.id][a.id];a&&s.push.apply(s,a)})});return c.map(s,function(a){return t.getIssues()[a]})}};return i});AJS.namespace("GH.GridDataController",null,require("jira-agile/rapid/ui/work/grid-data-controller"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-dialog', location = 'includes/js/dialog/dialog.js' */
"use strict";define("jira-agile/dialog/base-extension",["jira/dialog/dialog","jquery"],function(i,e){return{_getDefaultOptions:function(){return e.extend(this._super(),{onDialogFinished:function(){this.handleSuccess()}})},_performRedirect:function(){this.redirected=!0;this.handleSuccess()},hide:function(e,n){if(i.current!==this)return!1;this._super(e);!0===n||!n||n.reason!==i.HIDE_REASON.escape&&n.reason!==i.HIDE_REASON.cancel||this.doCancelCleanup()},doCancelCleanup:function(){},handleSuccess:function(){}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-dialog', location = 'includes/js/rapid/ops/DialogExtension.js' */
"use strict";define("jira-agile/rapid/ops/dialog-extension",["jira-agile/rapid/ops/callback-manager","jira-agile/rapid/state/rapid-board-state","jira-agile/rapid/ui/notification","jira-agile/rapid/ui/plan/backlog-model","jira-agile/rapid/ui/plan/sprint-model","jira-agile/rapid/ui/work/grid-columns-data","jira-agile/rapid/ui/work/grid-data-controller","jquery","underscore"],function(u,r,s,i,o,c,g,n,l){var p={getActionInfo:function(e){var t="workflow-transition-",e=e.options.id;return e.substring(0,t.length)===t?{formId:e,isTransition:!0,transitionId:e.substring(t.length)}:{formId:e,isTransition:!1}},handleSuccess:function(){GH.IssueOperationShortcuts.clearOverrideSelectedIssue();this.hide(!0,!0);this._hideloadingIndicator();var e=p.getActionInfo(this),t=GH.IssueOperationShortcuts.getSelectedIssueId(),a=GH.IssueOperationShortcuts.getSelectedIssueKey();GH.WorkController.isActive()?p.handleWorkModeUpdate(t,a,e):GH.PlanController.isActive()&&p.handlePlanModeUpdate(t,a);n(GH).trigger("issueTransitioned",{issueId:t});s.showIssueMessage(t);GH.WorkDragAndDrop.transitionTargetStatus=void 0},handlePlanModeUpdate:function(e,t){if(!GH.IssueOperationShortcuts.isOverrideSelectedIssueActive()){var a=0,r=null,s=i.findModelWithIssue(t);if(s){o.isSprintModel(s)&&(r=s.getSprintId());a=s.getIssueList().getIssueIndex(t)}GH.PlanController.reload(function(){if(!GH.BacklogSelectionController.getSelectedIssueKey()){var e=null,e=(e=r?i.getSprintModel(r):e)||i.getBacklogModel2();GH.BacklogSelectionController.selectIssue(e.getIssueList().getIssueKeyAtIndex(a))}})}},handleWorkModeUpdate:function(e,t,a){var r=p.createParentCompletedCheckCallback(t),s=p.createSelectMostAppropriateIssueCallback(t);if(a.isTransition)if(GH.WorkDragAndDrop.transitionTargetStatus){var i=GH.WorkDragAndDrop.transitionTargetStatus,o=g.getModel(),n=o.getIssueDataByKey(t),l=o.getIssuePositionByKey(t),d=o.getColumns(),a=l.columnId,d=c.getColumnIdForStatus(d,i);o.moveIssueToColumn(t,a,d);n.status=i;o.updateIssueData(n);GH.SwimlaneView.rerenderCell(l.swimlaneId,a);GH.SwimlaneView.rerenderCell(l.swimlaneId,d);r()}else u.registerCallback(GH.WorkController.CALLBACK_POOL_LOADED,"ParentWithAllSubsCompletedCheck",r);u.registerCallback(GH.WorkController.CALLBACK_POOL_LOADED,"SelectMostAppropriateIssueCallback",s);GH.WorkController.reload()},doCancelCleanup:function(){GH.IssueOperationShortcuts.clearOverrideSelectedIssue();GH.WorkDragAndDrop.transitionTargetStatus=void 0},createParentCompletedCheckCallback:function(s){return function(){var t=g.getModel();if(!l.isUndefined(t.data.issues[s])&&!l.isUndefined(t.data.issues[s].parentKey)){var a=t.data.issues[s].parentKey;if(l.contains(t.data.columnIssueMapping[l.last(t.data.columns).id],s)){var r=t.data.columnIssueMapping[l.last(t.data.columns).id],e=l.toArray(t.data.issues).reduce(function(e,t){return-1<r.indexOf(t.key)?e:e.concat(t.key)},[]);l.find(e,function(e){return t.data.issues[e].parentKey===a})||GH.WorkController.resolveParentTask(t.data.issues[a])}}}},createSelectMostAppropriateIssueCallback:function(t){var a=g.getModel().getIssuePositionByKey(t);return function(){if(!g.getModel().getIssueDataByKey(t)){var e=g.getModel().getIssueKeyAtPosition(a);if(e){GH.WorkSelectionController.selectIssue(e,{pushState:!1,dontUpdateUI:!0});r.replaceState()}else{GH.WorkSelectionController.selectIssue(void 0,{pushState:!1,dontUpdateUI:!0});r.replaceState()}}}}};return p});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-dialog', location = 'includes/js/dialog/form-dialog.js' */
"use strict";define("jira-agile/dialog/form-dialog",["jira-agile/dialog/base-extension","jira-agile/rapid/ops/dialog-extension","jira/dialog/form-dialog"],function(i,a,e){return e.extend(i).extend(a)});AJS.namespace("GH.FormDialog",null,require("jira-agile/dialog/form-dialog"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-dialog', location = 'includes/js/dialog/labels-dialog.js' */
"use strict";define("jira-agile/dialog/labels-dialog",["jira-agile/dialog/base-extension","jira-agile/rapid/ops/dialog-extension","jira/dialog/labels-dialog"],function(i,e,t){i=t.extend(i);return i=(i=i.extend(e)).extend({_handleSubmitResponse:function(i,e,t){if(this.serverIsDone){this.options.onSuccessfulSubmit&&this.options.onSuccessfulSubmit.call(this,i,e,t);this.options.autoClose&&this.hide();this.options.onDialogFinished&&this.options.onDialogFinished.call(this,i,e,t)}},decorateContent:function(){this._super();var i=this.get$popupContent();1===i.find("input[name=customFieldId]").length&&i.find("#hint").hide()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-dialog', location = 'includes/js/rapid/ui/dialog/DialogUtil.js' */
"use strict";define("jira-agile/rapid/dialog-util",["aui/dialog","jira/dialog/dialog","jira/util/events","jira/util/formatter","jquery","underscore"],function(e,o,i,t,r,d){return{create:function(i){r("#"+i.id).remove();i=d.defaults(i,{bindEscape:!0});var t=new e(i),a=t.show,n=function(){this.preShow();a.call(t);var n=r("#"+i.id),e=n.find(".dialog-button-panel .aui-button");e.is(":enabled")&&e.trigger("focus");n.addClass("ghx-dialog")}.bind(this);d.extend(t,{dispose:this.generateCloseHandler(t),cancel:this.generateCloseHandler(t,i.onCancelFn),submit:this.generateCloseHandler(t,i.onConfirmFn),show:n,disableControls:this.generateDisableControlsFn(t),enableControls:this.generateEnableControlsFn(t),showSpinner:this.generateShowSpinnerFn(t),hideSpinner:this.generateHideSpinnerFn(t)});this.bindEscapeHandler(t,!i.bindEscape);return t},addCancelButton:function(n){n.addCancel("Cancelar",function(){n.cancel(n)})},bindEscapeHandler:function(a,n){n?i.bind("Dialog.beforeHide",function(n,e,i,t){t===a.id&&i===o.HIDE_REASON.escape&&n.preventDefault()}):r(document).on("keyup."+a.id,function(n){27===n.keyCode&&a.cancel(a)})},generateCloseHandler:function(n,e){var i=this;return function(){n.remove();i.undim();r(document).off("keyup."+n.id);AJS.unbind("remove.dialog");e&&e(n);return!1}},generateDisableControlsFn:function(n){return function(){r("#"+n.id+" button").attr("disabled","disabled")}},generateEnableControlsFn:function(n){return function(){r("#"+n.id+" button").removeAttr("disabled")}},generateShowSpinnerFn:function(n){return function(){r("#"+n.id).find(".button-panel-cancel-link").css("visibility","hidden").before('<span class="ghx-spinner"/>')}},generateHideSpinnerFn:function(n){return function(){r("#"+n.id).find(".ghx-spinner").remove().end().find(".button-panel-cancel-link").css("visibility","visible")}},sanitizeAJSDim:function(){var n=AJS.dim;AJS.dim=function(){try{n.apply(this,arguments)}catch(n){}}},registerDialog:function(n,e,i){r(document).off("click",n).on("click",n,function(n){if(!r(this).hasClass("disabled")){n.preventDefault();e(n,i)}})},dim:function(){AJS.dim();r(".aui-blanket").html('<div class="jira-spinner-container"><aui-spinner size="medium" class="jira-page-loading-indicator"></aui-spinner></div>')},undim:function(){AJS.undim();r(".aui-blanket").empty()},preShow:function(){r(".aui-blanket").empty()}}});!function(){var n=window.GH&&window.GH.Dialog,e=require("jira-agile/rapid/dialog-util");n?Object.assign(GH.Dialog,e):AJS.namespace("GH.Dialog",null,e)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-persistent-messages', location = 'includes/js/rapid/ui/persistent-messages/CreateViewMessage.js' */
"use strict";define("jira-agile/rapid/ui/persistent-messages/create-view-message",["jira-agile/rapid/logger","jira-agile/rapid/state/storage","jira-agile/rapid/ui/notification","jira/libs/parse-uri","jira/util/formatter","jira/util/strings"],function(i,r,t,n,g,l){var u={setView:function(e,a,s,i){r.put("gh.createViewMessage",{id:e,name:a,type:s,subType:i},!0)},clear:function(){r.put("gh.createViewMessage",null,!0)},renderMessage:function(e){e&&i.log(e.type+" handled","GH.PersistentMessages.CreateViewMessage.renderMessage");var a=r.get("gh.createViewMessage",!0);if(a){var s,e=null;a.name=l.escapeHtml(String(a.name));"advanced"===a.type?s=GH.tpl.board.x.renderCreateViewMessage:"kanban"===a.subType?s=GH.tpl.board.x.renderWelcomeViewMessageKanban:"scrum"===a.subType&&(s=GH.tpl.board.x.renderWelcomeViewMessageScrum);e=s({rapidView:a,url:n(window.location.href)});t.showSuccess(e,{title:"\u00c9xito",timeout:1e4});u.clear()}}};return u});AJS.namespace("GH.PersistentMessages.CreateViewMessage",null,require("jira-agile/rapid/ui/persistent-messages/create-view-message"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-persistent-messages', location = 'includes/js/rapid/ui/persistent-messages/WelcomeMessage.js' */
"use strict";define("jira-agile/rapid/ui/persistent-messages/welcome-message",["jira-agile/rapid/state/storage","jira-agile/rapid/ui/notification","jira/libs/parse-uri","jira/util/formatter","jira/util/strings"],function(s,t,i,l,n){var e={show:function(e){s.put("gh.welcomeMessage",e,!0)},renderMessage:function(){var e=s.get("gh.welcomeMessage",!0);if(e){var a;e.rapidView.name=n.escapeHtml(String(e.rapidView.name));e.project.name=n.escapeHtml(String(e.project.name));var r=null;/kanban/.test(e.preset)?r=e.sample?GH.tpl.board.x.renderWelcomeProjectSampleMessageKanban:GH.tpl.board.x.renderWelcomeProjectMessageKanban:/scrum/.test(e.preset)&&(r=e.sample?GH.tpl.board.x.renderWelcomeProjectSampleMessageScrum:GH.tpl.board.x.renderWelcomeProjectMessageScrum);a=r({project:e.project,rapidView:e.rapidView,url:i(window.location.href)});t.showSuccess(a,{title:"\u00c9xito",timeout:1e4});s.put("gh.welcomeMessage",null,!0)}}};return e});AJS.namespace("GH.PersistentMessages.WelcomeMessage",null,require("jira-agile/rapid/ui/persistent-messages/welcome-message"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-project-picker', location = 'includes/js/projects/project-picker.js' */
"use strict";define("jira-agile/projects/project-picker",[],function(){function t(t){if(!t||!t.selector)throw new Error("Project picker requires a selector");this.$select=AJS.$(t.selector);if(t.currentProjectId){this.currentProjectId=t.currentProjectId;this.currentProject=null}this.multiselect=new AJS.MultiSelect({element:this.$select,width:300,itemAttrDisplayed:"label",ajaxOptions:{url:GH.Ajax.buildRestUrl("/project.json"),formatResponse:this._processAjax.bind(this)}});if("function"==typeof t.change){this.$select.bind("unselect",t.change);this.$select.bind("change",t.change)}this.currentProjectId&&this.multiselect.requestSuggestions(!0).done(function(){this.currentProject&&this.multiselect.addItem(this._getProjectDescriptor(this.currentProject))}.bind(this))}t.prototype.show=function(){AJS.warn("ProjectPicker.show is deprecated. It is no longer needed as all initialisation occurs in the constructor")};t.prototype.hasValue=function(){return!!this.$select.val()};t.prototype.hasErrors=function(){return 0<this.multiselect.$container.parent().find(".error").length};t.prototype.getValue=function(){return this.$select.val()};t.prototype.getElement=function(){return this.$select};t.prototype._findProject=function(t,e){return(t||[]).filter(function(t){return e&&t.id===e}.bind(this))[0]};t.prototype._findUnmatchingProjects=function(t,e){return(t||[]).filter(function(t){return!e||t.id!==e}.bind(this))};t.prototype._processAjax=function(t){if(!t||!t.projects||!t.projects.length)return[];this.currentProject=this._findProject(t.projects,this.currentProjectId);t=this._findUnmatchingProjects(t.projects,this.currentProjectId).map(this._getProjectDescriptor.bind(this));return this.currentProject?[this._getProjectDescriptor(this.currentProject)].concat(t):t};t.prototype._getProjectDescriptor=function(t){if(!t)throw new Error("ProjectPicker.prototype._getProjectDescriptor requires a project");return new AJS.ItemDescriptor({value:t.id+"",label:t.displayName,html:AJS.escapeHTML(String(t.displayName))})};return t});AJS.namespace("GH.ProjectPicker",null,require("jira-agile/projects/project-picker"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-create-board', location = 'includes/js/rapid/ui/startwizard/WizardView.soy' */
// This file was automatically generated from WizardView.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace GH.tpl.startwizard.
 */

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.startwizard == 'undefined') { GH.tpl.startwizard = {}; }


GH.tpl.startwizard.renderMethodologySelectionStep = function(opt_data, opt_ignored) {
  return '<form class="aui ghx-halved-vertical"><div class="aui-group"><div class="aui-item"><h2>' + soy.$$escapeHtml('Scrum') + '</h2><p>' + soy.$$escapeHtml('Scrum se centra en la planificaci\xf3n, la asignaci\xf3n y la entrega de fragmentos de trabajo enmarcados en el tiempo denominados \x27sprints\x27.') + '</p></div><div class="aui-item"><h2>' + soy.$$escapeHtml('Kanban') + '</h2><p>' + soy.$$escapeHtml('Kanban se centra en visualizar el flujo de trabajo y limitar el trabajo en curso para facilitar las mejoras graduales del proceso existente.') + '</p></div></div><div class="aui-group ghx-button-group"><div class="aui-item"><button id="ghx-wizard-methodology-scrum" class="aui-button">' + soy.$$escapeHtml('Crear una pizarra de Scrum') + '</button></div><div class="aui-item"><button id="ghx-wizard-methodology-kanban" class="aui-button">' + soy.$$escapeHtml('Crear una pizarra de Kanban') + '</button></div></div>' + ((opt_data.isSampleDataAvailable && opt_data.canCreateProject) ? '<div class="aui-group"><div class="aui-item"><button id="ghx-wizard-methodology-scrum-sample" class="aui-button aui-button-link">' + soy.$$escapeHtml('Crear una pizarra de Scrum con datos de muestra') + '</button></div><div class="aui-item"><button id="ghx-wizard-methodology-kanban-sample" class="aui-button aui-button-link">' + soy.$$escapeHtml('Crear una pizarra de Kanban con datos de muestra') + '</button></div></div>' : '') + '</form>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderMethodologySelectionStep.soyTemplateName = 'GH.tpl.startwizard.renderMethodologySelectionStep';
}


GH.tpl.startwizard.renderMethodSelectionStep = function(opt_data, opt_ignored) {
  return '<div class="aui-group ghx-split" id="js-method-choice"><div class="aui-item"><form class="aui"><fieldset class="group ghx-space-saver">' + ((opt_data.canCreateProject) ? '<div class="radio"><input class="radio" type="radio" id="ghx-wizard-method-new-project" name="ghx-wizard-method" value="newProject" ' + ((opt_data.selectedOption == 'newProject') ? 'checked="checked"' : '') + '><label for="ghx-wizard-method-new-project">' + soy.$$escapeHtml('Pizarra creada con nuevo proyecto de software') + '</label><div class="description">' + soy.$$escapeHtml('Una nueva pizarra basada en un nuevo proyecto de software') + '</div></div>' : '') + ((opt_data.hasProjectsAccessible) ? '<div class="radio"><input class="radio" type="radio" id="ghx-wizard-method-existing-project" name="ghx-wizard-method" value="existingProject" ' + ((opt_data.selectedOption == 'existingProject') ? 'checked="checked"' : '') + '><label for="ghx-wizard-method-existing-project">' + soy.$$escapeHtml('Pizarra de un proyecto existente') + '</label><div class="description">' + soy.$$escapeHtml('Las pizarras pueden contener uno o m\xe1s proyectos.') + '</div></div>' : '') + ((opt_data.hasFiltersAccessible) ? '<div class="radio"><input class="radio" type="radio" id="ghx-wizard-method-existing-filter" name="ghx-wizard-method" value="existingFilter" ' + ((opt_data.selectedOption == 'existingFilter') ? 'checked="checked"' : '') + '><label for="ghx-wizard-method-existing-filter">' + soy.$$escapeHtml('Pizarra de un filtro guardado existente') + '</label><div class="description">' + soy.$$escapeHtml('Una opci\xf3n avanzada que usa un filtro JQL.') + '</div></div>' : '') + '</fieldset></form></div><div class="aui-item"></div></div>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderMethodSelectionStep.soyTemplateName = 'GH.tpl.startwizard.renderMethodSelectionStep';
}


GH.tpl.startwizard.renderProjectSelectionStep = function(opt_data, opt_ignored) {
  return '<div class="aui-group ghx-split"><div class="aui-item"><form class="aui ajs-dirty-warning-exempt"><fieldset><div class="field-group"><label for="ghx-wizard-project-board-name">' + soy.$$escapeHtml('Nombre de la pizarra') + '<span class="aui-icon icon-required"></span></label><input class="text" type="text" id="ghx-wizard-project-board-name" maxlength="155"></div><div class="field-group"><label for="ghx-wizard-choose-project">' + soy.$$escapeHtml('Proyecto(s)') + '<span class="aui-icon icon-required"></span></label><select id="ghx-wizard-choose-project" multiple="multiple" class="hidden"></select><div class="description">' + soy.$$escapeHtml('Seleccionar uno o m\xe1s proyectos para incluir en esta pizarra.') + '</div></div></fieldset></form></div><div class="aui-item"></div></div>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderProjectSelectionStep.soyTemplateName = 'GH.tpl.startwizard.renderProjectSelectionStep';
}


GH.tpl.startwizard.renderFilterSelectionStep = function(opt_data, opt_ignored) {
  return '<div class="aui-group ghx-split"><div class="aui-item"><form class="aui"><fieldset><div class="field-group"><label for="ghx-wizard-filter-view-name">' + soy.$$escapeHtml('Nombre de la pizarra') + '<span class="aui-icon icon-required"></span></label><input class="text" type="text" id="ghx-wizard-filter-view-name" name="name" maxlength="155"></div><div class="field-group" id="ghx-filter-picker"><label for="ghx-wizard-filter-select">' + soy.$$escapeHtml('Filtro guardado') + '<span class="aui-icon icon-required"></span></label><select id="ghx-wizard-filter-select" class="hidden"></select><div id="ghx-filter-error"></div></div><div id="ghx-create-permissioninfo-container"></div></fieldset></form></div><div class="aui-item ghx-alignwith-textgroup"><h3>' + soy.$$escapeHtml('Filtros guardados') + '</h3><div class="description">' + soy.$$escapeHtml('Escoger de una lista de filtros existentes como base para su nueva pizarra. Para crear un nuevo filtro guardado, guarde una b\xfasqueda en el navegador de incidencias.') + '</div></div></div>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderFilterSelectionStep.soyTemplateName = 'GH.tpl.startwizard.renderFilterSelectionStep';
}


GH.tpl.startwizard.renderProjectCreationStep = function(opt_data, opt_ignored) {
  return '<div class="aui-group ghx-split"><div class="aui-item"><form class="aui"><fieldset><div class="field-group"><label for="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectname">' + soy.$$escapeHtml('Nombre de proyecto') + '<span class="aui-icon icon-required"></span></label><input class="text" type="text" id="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectname" value="' + soy.$$escapeHtml(opt_data.sampleInfo.projectName) + '"></div><div class="field-group"><label for="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectkey">' + soy.$$escapeHtml('Clave de proyecto') + '<span class="aui-icon icon-required"></span></label><input class="text short-field" type="text" id="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectkey" value="' + soy.$$escapeHtml(opt_data.sampleInfo.projectKey) + '"></div><div class="field-group"><label for="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectlead">' + soy.$$escapeHtml('Jefe de proyecto') + '<span class="aui-icon icon-required"></span></label><select id="ghx-wizard-' + soy.$$escapeHtml(opt_data.prefix) + '-projectlead" class="js-default-user-picker hidden"><option' + ((opt_data.user.avatarUrl) ? ' style="background-image:url(\'' + soy.$$escapeHtml(opt_data.user.avatarUrl) + '\')"' : '') + 'selected="selected" value="' + soy.$$escapeHtml(opt_data.user.name) + '">' + soy.$$escapeHtml(opt_data.user.displayName) + '</option></select><div class="description">' + soy.$$escapeHtml('Comience a escribir para obtener una lista de posibles coincidencias.') + '</div></div></fieldset></form></div><div class="aui-item ghx-alignwith-textgroup"><h3>' + soy.$$escapeHtml('Crear un proyecto') + '</h3><div class="description">' + soy.$$escapeHtml('Con su proyecto se crear\xe1 una pizarra que tendr\xe1 el mismo nombre. Puede cambiar el nombre de la pizarra en la pantalla de configuraci\xf3n de pizarras.') + '</div></div></div>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderProjectCreationStep.soyTemplateName = 'GH.tpl.startwizard.renderProjectCreationStep';
}


GH.tpl.startwizard.renderPermissionInfo = function(opt_data, opt_ignored) {
  return '<div class="field-group"><label for="ghx-create-permissioninfo">' + soy.$$escapeHtml('Recursos compartidos') + '</label>' + GH.tpl.rapid.view.renderPermissionEntries({permissionEntries: opt_data.savedFilter.permissionEntries}) + '</div><div class="field-group"><label>' + soy.$$escapeHtml('Propietario') + '</label><span class="field-value">' + soy.$$escapeHtml(opt_data.savedFilter.owner.displayName) + '</span></div>';
};
if (goog.DEBUG) {
  GH.tpl.startwizard.renderPermissionInfo.soyTemplateName = 'GH.tpl.startwizard.renderPermissionInfo';
}


GH.tpl.startwizard.createProjectTimeout = function(opt_data, opt_ignored) {
  return '' + soy.$$filterNoAutoescape(AJS.format('La operaci\xf3n ha agotado el tiempo de espera, es posible que el proyecto y la pizarra ya se hubieran creado. Puede confirmarlo fij\xe1ndose en la p\xe1gina \x3ca href\x3d\x22{0}\x22\x3eAdministrar pizarras\x3c/a\x3e.',opt_data.manageBoardURL));
};
if (goog.DEBUG) {
  GH.tpl.startwizard.createProjectTimeout.soyTemplateName = 'GH.tpl.startwizard.createProjectTimeout';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-create-board', location = 'includes/js/rapid/configuration/RapidView.soy' */
// This file was automatically generated from RapidView.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace GH.tpl.rapid.view.
 */

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.view == 'undefined') { GH.tpl.rapid.view = {}; }


GH.tpl.rapid.view.renderConfigurationHeader = function(opt_data, opt_ignored) {
  return '<div id="ghx-modes-tools">' + aui.buttons.button({text: 'Regresar a la pizarra', type: 'subtle', href: GH.Ajax.CONTEXT_PATH + '/secure/RapidBoard.jspa?rapidView=' + opt_data.rapidViewId + '&useStoredSettings=true', id: 'back-to-board', iconType: 'aui', iconText: 'Regresar a la pizarra', iconClass: 'aui-icon-small aui-iconfont-back-page'}) + '</div><h2>' + soy.$$escapeHtml('Configurar') + ' <span id="js-nav-view-name">' + soy.$$escapeHtml(opt_data.name) + '</span></h2>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderConfigurationHeader.soyTemplateName = 'GH.tpl.rapid.view.renderConfigurationHeader';
}


GH.tpl.rapid.view.renderConfigurationTabs = function(opt_data, opt_ignored) {
  var output = '<div id="ghx-config-header"></div>';
  var param20 = '<nav class="aui-navgroup aui-navgroup-vertical" aria-label="' + soy.$$escapeHtml('Configuraci\xf3n de pizarra') + '"><div class="aui-nav-heading"><strong>' + soy.$$escapeHtml('Configuraci\xf3n') + '</strong></div><ul id="ghx-config-nav" class="aui-nav">';
  var configurationTabList26 = opt_data.configurationTabs;
  var configurationTabListLen26 = configurationTabList26.length;
  for (var configurationTabIndex26 = 0; configurationTabIndex26 < configurationTabListLen26; configurationTabIndex26++) {
    var configurationTabData26 = configurationTabList26[configurationTabIndex26];
    param20 += '<li data-tabitem="' + soy.$$escapeHtml(configurationTabData26.key) + '"><a href="' + soy.$$escapeHtml(GH.Ajax.CONTEXT_PATH) + '/secure/RapidView.jspa?rapidView=' + soy.$$escapeHtml(opt_data.rapidViewId) + '&amp;tab=' + soy.$$escapeHtml(configurationTabData26.key) + '">' + soy.$$escapeHtml(configurationTabData26.label) + '</a></li>';
  }
  param20 += '</ul></nav>';
  var param19 = '' + aui.page.pagePanelNav({content: param20});
  var param43 = '';
  var configurationTabList44 = opt_data.configurationTabs;
  var configurationTabListLen44 = configurationTabList44.length;
  for (var configurationTabIndex44 = 0; configurationTabIndex44 < configurationTabListLen44; configurationTabIndex44++) {
    var configurationTabData44 = configurationTabList44[configurationTabIndex44];
    param43 += '<div class="ghx-page-panel-content-item" id="' + soy.$$escapeHtml(configurationTabData44.key) + '">' + soy.$$filterNoAutoescape(configurationTabData44.html) + '</div>';
  }
  param19 += aui.page.pagePanelContent({extraClasses: 'ghx-config-panel-content', content: param43});
  output += aui.page.pagePanel({content: param19});
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderConfigurationTabs.soyTemplateName = 'GH.tpl.rapid.view.renderConfigurationTabs';
}


GH.tpl.rapid.view.renderViewNameEditForm = function(opt_data, opt_ignored) {
  var output = '';
  var label__soy55 = 'Nombre de la pizarra';
  output += '<label for="ghx-field-viewname">' + soy.$$escapeHtml(label__soy55) + '</label>' + GH.tpl.rapid.view.renderViewNameField({rapidViewName: opt_data.rapidViewName, canEdit: opt_data.canEdit, label: label__soy55});
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderViewNameEditForm.soyTemplateName = 'GH.tpl.rapid.view.renderViewNameEditForm';
}


GH.tpl.rapid.view.renderViewNameField = function(opt_data, opt_ignored) {
  return '<span class="field-value ' + ((opt_data.canEdit) ? 'js-edit-rapidViewName' : '') + '" data-fieldname="viewname" data-fieldvalue="' + soy.$$escapeHtml(opt_data.rapidViewName) + '" data-ariaLabel="' + soy.$$escapeHtml(opt_data.label) + '"><span id="ghx-field-viewname" ' + ((opt_data.canEdit) ? 'class="ghx-editable"' : '') + '>' + soy.$$escapeHtml(opt_data.rapidViewName) + '</span></span>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderViewNameField.soyTemplateName = 'GH.tpl.rapid.view.renderViewNameField';
}


GH.tpl.rapid.view.renderViewBoardAdminsEditForm = function(opt_data, opt_ignored) {
  var output = '<label for="ghx-field-view-board-admins">' + soy.$$escapeHtml('Administradores') + '</label><span  class="field-value' + ((opt_data.canEdit) ? ' js-edit-rapidViewBoardAdmin' : '') + '" ><span id="ghx-field-view-board-admins-span" ' + ((opt_data.canEdit) ? 'class="ghx-editable"' : '') + '>';
  var itemList91 = opt_data.model;
  var itemListLen91 = itemList91.length;
  if (itemListLen91 > 0) {
    for (var itemIndex91 = 0; itemIndex91 < itemListLen91; itemIndex91++) {
      var itemData91 = itemList91[itemIndex91];
      output += soy.$$escapeHtml(itemData91.displayName) + ((! (itemIndex91 == itemListLen91 - 1)) ? '<span>, </span>' : '');
    }
  } else {
    output += '<span class="ghx-fa">' + soy.$$escapeHtml('Ninguna') + '</span>';
  }
  output += '</span></span><span id="ghx-field-view-board-admins">' + ((opt_data.canUsePicker) ? '<select id="ghx-board-admins" multiple="multiple" class="hidden" aria-hidden="true"></select>' : '') + '</span>';
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderViewBoardAdminsEditForm.soyTemplateName = 'GH.tpl.rapid.view.renderViewBoardAdminsEditForm';
}


GH.tpl.rapid.view.renderBoardAdminsEditNoPicker = function(opt_data, opt_ignored) {
  var output = '<span class="ghx-margin-right"><strong>' + soy.$$escapeHtml('Grupos') + '</strong>: <input class="text medium-field" id="ghx-board-admin-edit-groups" value="';
  var itemList110 = opt_data.model.groupKeys;
  var itemListLen110 = itemList110.length;
  for (var itemIndex110 = 0; itemIndex110 < itemListLen110; itemIndex110++) {
    var itemData110 = itemList110[itemIndex110];
    output += soy.$$escapeHtml(itemData110.key) + ((! (itemIndex110 == itemListLen110 - 1)) ? ',' : '');
  }
  output += '" /></span><strong>' + soy.$$escapeHtml('Usuarios') + '</strong>: <input class="text medium-field " id="ghx-board-admin-edit-users" value="';
  var itemList119 = opt_data.model.userKeys;
  var itemListLen119 = itemList119.length;
  for (var itemIndex119 = 0; itemIndex119 < itemListLen119; itemIndex119++) {
    var itemData119 = itemList119[itemIndex119];
    output += soy.$$escapeHtml(itemData119.key) + ((! (itemIndex119 == itemListLen119 - 1)) ? ',' : '');
  }
  output += '" /><div class="description">' + soy.$$escapeHtml('Separe las claves de los usuarios y los nombres de los grupos con comas.') + '</div>';
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderBoardAdminsEditNoPicker.soyTemplateName = 'GH.tpl.rapid.view.renderBoardAdminsEditNoPicker';
}


GH.tpl.rapid.view.renderConfigPermissionsWarning = function(opt_data, opt_ignored) {
  return '' + ((opt_data.model.canEdit != true) ? '<div class="aui-message aui-message-warning"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Ponte en contacto con un administrador de Jira o de tablero para configurar este tablero.') + '</strong></p></div>' : '');
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderConfigPermissionsWarning.soyTemplateName = 'GH.tpl.rapid.view.renderConfigPermissionsWarning';
}


GH.tpl.rapid.view.renderFilterDetails = function(opt_data, opt_ignored) {
  var output = '<form class="aui" id="ghx-savedfilter-form"><div class="aui-message aui-message-warning hidden" id="unmapped-issues-warning"><p>' + soy.$$escapeHtml('Algunas incidencias en el filtro guardado no se mostrar\xe1n en la pizarra.') + ' <a href="' + soy.$$escapeHtml(GH.Ajax.CONTEXT_PATH) + '/secure/RapidView.jspa?rapidView=' + soy.$$escapeHtml(opt_data.rapidViewId) + '&amp;tab=columns" id="js-view-columns">' + soy.$$escapeHtml('Ver estados sin asociar que contienen estas incidencias.') + '</a></p></div><div class="field-group"><label>' + soy.$$escapeHtml('Filtro Guardado') + '</label><span id="ghx-filter-change" class="field-value' + ((opt_data.canEdit) ? ' ghx-editable ghx-ss' : '') + '">' + soy.$$escapeHtml(opt_data.savedFilter.name) + '</span><select id="ghx-filter-change-select" class="hidden" aria-hidden="true"></select><p class="ghx-additional"><a href="' + soy.$$escapeHtml(GH.Ajax.CONTEXT_PATH) + '/secure/IssueNavigator.jspa?mode=show&requestId=' + soy.$$escapeHtml(opt_data.savedFilter.id) + '">' + ((opt_data.savedFilter.canEdit) ? soy.$$escapeHtml('Editar consulta de filtro') : soy.$$escapeHtml('Ver consulta de filtro')) + '</a></p></div>' + GH.tpl.rapid.view.renderPermissionInfo(opt_data) + '<div class="field-group ghx-jql-preview"><label>' + soy.$$escapeHtml('Consulta de filtros') + '</label><span class="field-value">' + ((opt_data.savedFilter.query) ? soy.$$escapeHtml(opt_data.savedFilter.query) : '') + '</span></div><div class="field-group"><label>' + soy.$$escapeHtml('Clasificaci\xf3n') + '</label><span class="field-value">';
  if (opt_data.savedFilter.isOrderedByRank) {
    output += soy.$$escapeHtml('Se usa clasificaci\xf3n');
  } else {
    if (! opt_data.savedFilter.orderByWarnings) {
      output += soy.$$escapeHtml('La clasificaci\xf3n est\xe1 deshabilitada porque la consulta de filtros no est\xe1 ordenada por clasificaci\xf3n');
    } else {
      var warningList181 = opt_data.savedFilter.orderByWarnings.errorMessages;
      var warningListLen181 = warningList181.length;
      for (var warningIndex181 = 0; warningIndex181 < warningListLen181; warningIndex181++) {
        var warningData181 = warningList181[warningIndex181];
        output += soy.$$escapeHtml(warningData181) + '<br>';
      }
    }
    output += (opt_data.savedFilter.canEdit && opt_data.savedFilter.canBeFixed) ? '<p><button class="aui-button js-update-filter-order-by">' + soy.$$escapeHtml('A\xf1adir clasificaci\xf3n') + '</button></p>' : '';
  }
  output += '</span></div>';
  if (opt_data.savedFilter.queryProjects) {
    output += '<div class="field-group"><label>' + soy.$$escapeHtml('Proyectos en pizarra') + '</label><ul id="ghx-show-projects-in-board">';
    if (opt_data.savedFilter.queryProjects.displayMessage) {
      output += '<span class="field-value">' + soy.$$escapeHtml(opt_data.savedFilter.queryProjects.displayMessage) + '</span>';
    } else {
      var avatarSize__soy202 = 'small';
      var projectList203 = opt_data.savedFilter.queryProjects.projects;
      var projectListLen203 = projectList203.length;
      for (var projectIndex203 = 0; projectIndex203 < projectListLen203; projectIndex203++) {
        var projectData203 = projectList203[projectIndex203];
        output += '<li>' + aui.avatar.avatar({isProject: 'true', size: '' + soy.$$escapeHtml(avatarSize__soy202), avatarImageUrl: soy.$$escapeHtml("") + '/secure/projectavatar?size=' + soy.$$escapeHtml(avatarSize__soy202) + '&pid=' + soy.$$escapeHtml(projectData203.id), extraClasses: 'jira-system-avatar', accessibilityText: '' + soy.$$escapeHtml(AJS.format('Avatar del proyecto de {0}',projectData203.name))}) + '<strong>' + soy.$$escapeHtml(projectData203.name) + '</strong><p>';
        var viewProjectPermissionText__soy223 = 'Permiso para ver';
        output += ((projectData203.isValidEditProjectConfigAction) ? '<a href="' + soy.$$escapeHtml("") + '/plugins/servlet/project-config/' + soy.$$escapeHtml(projectData203.key) + '/permissions">' + soy.$$escapeHtml(viewProjectPermissionText__soy223) + '</a>' : '<a class="disabled">' + soy.$$escapeHtml(viewProjectPermissionText__soy223) + '</a><span class="aui-icon aui-icon-small aui-iconfont-info" title="' + soy.$$escapeHtml('No est\xe1 autorizado para ver este permiso de proyecto') + '"></span>') + '</p></li>';
      }
    }
    output += '</ul></div>';
  }
  output += (opt_data.isSubqueriesConfigurable) ? '<div class="field-group ghx-jql"><label for="ghx-sub-jql">' + soy.$$escapeHtml('Subfiltro de pizarra de Kanban') + '</label><div id="js-sub-container-work">' + GH.tpl.rapid.view.renderSubQueryView({section: 'board.kanban.work', queryValue: opt_data.subqueries[0], canEdit: opt_data.canEdit}) + '</div><div class="description">' + soy.$$escapeHtml('Mayor filtro de incidencias para el trabajo sin entregar.') + '</div></div>' : '';
  if (opt_data.isOldDoneIssuesCutoffConfigurable) {
    output += '<div class="field-group ghx-show-old-limit"><label for="ghx-limit-days">' + soy.$$escapeHtml('Ocultar los tiques terminados con una antig\xfcedad superior a') + '</label><select id="ghx-limit-days" class="select">';
    var optionList259 = opt_data.oldDoneIssuesCutoffOptions;
    var optionListLen259 = optionList259.length;
    for (var optionIndex259 = 0; optionIndex259 < optionListLen259; optionIndex259++) {
      var optionData259 = optionList259[optionIndex259];
      output += '<option value="' + soy.$$escapeHtml(optionData259.value) + '" ' + ((opt_data.oldDoneIssuesCutoff == optionData259.value) ? 'selected="selected"' : '') + '>' + soy.$$escapeHtml(optionData259.label) + '</option>';
    }
    output += '</select><div class="description">' + soy.$$escapeHtml('Oculta los tiques en los que ya no est\xe9s trabajando para acelerar el tablero.') + '</div></div>';
  }
  output += '</form>';
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderFilterDetails.soyTemplateName = 'GH.tpl.rapid.view.renderFilterDetails';
}


GH.tpl.rapid.view.renderSubQueryView = function(opt_data, opt_ignored) {
  return '<span id="ghx-sub-work" class="field-value' + ((opt_data.canEdit) ? ' js-editable ghx-editable ghx-jql' : '') + '">' + ((opt_data.queryValue) ? soy.$$escapeHtml(opt_data.queryValue) : (opt_data.canEdit) ? '<em>' + soy.$$escapeHtml('A\xf1adir subfiltro') + '</em>' : soy.$$escapeHtml('Sin subfiltros')) + '</span>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderSubQueryView.soyTemplateName = 'GH.tpl.rapid.view.renderSubQueryView';
}


GH.tpl.rapid.view.renderSubQueryControls = function(opt_data, opt_ignored) {
  return '<textarea class="js-jql-autocomplete-field textarea" id="ghx-sub-jql" data-section="' + soy.$$escapeHtml(opt_data.section) + '" cols="20" rows="2">' + soy.$$escapeHtml(opt_data.queryValue) + '</textarea><span id="ghx-sub-jql-errormsg" class="icon jqlgood js-jql-autocomplete-error"><span></span></span><button class="aui-button js-subquery-submit">' + soy.$$escapeHtml('Actualizar') + '</button><button class="aui-button js-subquery-cancel">' + soy.$$escapeHtml('Cancelar') + '</button>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderSubQueryControls.soyTemplateName = 'GH.tpl.rapid.view.renderSubQueryControls';
}


GH.tpl.rapid.view.renderPermissionInfo = function(opt_data, opt_ignored) {
  return '<div class="field-group"><label for="ghx-create-permissioninfo">' + soy.$$escapeHtml('Recursos compartidos') + '</label>' + GH.tpl.rapid.view.renderPermissionEntries({permissionEntries: opt_data.savedFilter.permissionEntries}) + ((opt_data.savedFilter.canEdit) ? '<p class="ghx-additional"><a href="' + soy.$$escapeHtml(GH.Ajax.CONTEXT_PATH) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeHtml(opt_data.savedFilter.id) + '">' + soy.$$escapeHtml('Editar permisos para compartir filtro') + '</a></p>' : '</div><div class="field-group"><label>' + soy.$$escapeHtml('Propietario') + '</label><span class="field-value">' + soy.$$filterNoAutoescape(opt_data.savedFilter.owner.renderedLink) + '</span>') + '</div>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderPermissionInfo.soyTemplateName = 'GH.tpl.rapid.view.renderPermissionInfo';
}


GH.tpl.rapid.view.renderPermissionEntries = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.permissionEntries.length > 0) {
    output += '<span class="field-value"><ul id="ghx-create-permissioninfo">';
    var permissionEntryList329 = opt_data.permissionEntries;
    var permissionEntryListLen329 = permissionEntryList329.length;
    for (var permissionEntryIndex329 = 0; permissionEntryIndex329 < permissionEntryListLen329; permissionEntryIndex329++) {
      var permissionEntryData329 = permissionEntryList329[permissionEntryIndex329];
      output += '<li>';
      var permissionValueList331 = permissionEntryData329.values;
      var permissionValueListLen331 = permissionValueList331.length;
      for (var permissionValueIndex331 = 0; permissionValueIndex331 < permissionValueListLen331; permissionValueIndex331++) {
        var permissionValueData331 = permissionValueList331[permissionValueIndex331];
        output += '<span>' + soy.$$filterNoAutoescape(permissionValueData331.name) + '</span>';
      }
      output += '</li>';
    }
    output += '</ul></span>';
  } else {
    output += '<span class="field-value">' + soy.$$escapeHtml('Sin compartir') + '</span>';
  }
  return output;
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.renderPermissionEntries.soyTemplateName = 'GH.tpl.rapid.view.renderPermissionEntries';
}


GH.tpl.rapid.view.deleteForm = function(opt_data, opt_ignored) {
  return '<section role="dialog" class="aui-dialog2 aui-dialog2-small gh-confirm-delete-dialog"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Borrar') + '</h2><button type="button" class="aui-close-button" aria-label="' + soy.$$escapeHtml('Cerrar') + '"></button></header><div class="aui-dialog2-content"><p>' + soy.$$filterNoAutoescape(opt_data.message) + '</p></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form>' + aui.buttons.button({tagName: 'button', type: 'primary', extraAttributes: {type: 'submit'}, text: 'Confirmar'}) + aui.buttons.button({tagName: 'button', type: 'link', extraAttributes: {type: 'button'}, extraClasses: 'cancel', text: 'Cancelar'}) + '</form></div></footer></section>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.deleteForm.soyTemplateName = 'GH.tpl.rapid.view.deleteForm';
}


GH.tpl.rapid.view.confirmForm = function(opt_data, opt_ignored) {
  return '<h2 class="dialog-title">' + soy.$$escapeHtml('Confirmaci\xf3n') + '</h2><form class="aui" action="#" method="post"><div class="form-body"><p>' + soy.$$filterNoAutoescape(opt_data.message) + '</p></div><div class="form-footer buttons-container"><div class="buttons"><input id="submit" class="button" type="submit" value="' + soy.$$escapeHtml('Confirmar') + '" /><a role="button" href="#" class="cancel">' + soy.$$escapeHtml('Cancelar') + '</a></div></div></form></div>';
};
if (goog.DEBUG) {
  GH.tpl.rapid.view.confirmForm.soyTemplateName = 'GH.tpl.rapid.view.confirmForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-create-board', location = 'includes/js/rapid/ui/component/SavedFilterPicker.js' */
"use strict";define("jira-agile/rapid/ui/component/saved-filter-picker",["jira-agile/rapid/ajax","jira/ajs/list/item-descriptor","jira/ajs/select/single-select","jquery","underscore"],function(n,a,t,o,c){function e(e){this.selector=e.selector;this.fieldSelector=e.selector+"-field";this.blurHandler=e.blur;this.selectHandler=e.selected;this.stayActivated=e.stayActivated;this.focus=e.focus;this.ariaLabel=e.ariaLabel}e.prototype.show=function(e){var s=o(this.selector),i=new t({element:s,width:300,removeOnUnSelect:!0,itemAttrDisplayed:"label",errorMessage:"",ajaxOptions:{query:!0,url:n.buildRestUrl("/savedfilter/list.json"),formatResponse:function(e){if(e.errors){var t=n._convertJiraErrors(e.errors),i={searchName:this.selector};n.handleContextualErrors(t,i);return!1}s.siblings(".ghx-error").remove();var r=[];o(e.filters).each(function(){r.push(new a({value:this.id.toString(),label:this.name,html:c.escape(String(this.name)),savedFilter:this}))});return r}},ariaLabel:this.ariaLabel});this.singleSelect=i;var r=this.removeSingleSelect;this.stayActivated||o(this.fieldSelector).on("blur",function(){r(i)});c.isFunction(this.blurHandler)&&o(this.fieldSelector).on("blur",this.blurHandler);this.focus&&o(this.fieldSelector).trigger("focus").trigger("select");e&&this.setSelection(e);var l=this.selectHandler;if(this.stayActivated){s.on("selected",l);s.on("unselect",l)}else{s.on("selected",function(e,t){r(i);l(e,t)});s.on("unselect",function(e,t){r(i);l(e,t)})}};e.prototype.setSelection=function(e){this.singleSelect.setSelection(new a({value:e.id.toString(),label:e.name,html:c.escape(String(e.name)),savedFilter:e,selected:!0}))};e.prototype.removeSingleSelect=function(e){e.hideSuggestions();e.disable()};e.prototype.getElement=function(){return this.singleSelect.$field};return e});AJS.namespace("GH.SavedFilterPicker",null,require("jira-agile/rapid/ui/component/saved-filter-picker"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-create-board', location = 'includes/js/lib/jquery/jquery.keygen.js' */
!function(e,v){e.KeyGenerator=function(){function l(e){return e.join("").length}var f=["THE","A","AN","AS","AND","OF","OR"],d={},m=function(e){return e&&1===e.length&&-1!==e.search("[AEIOUY]")};d[199]="C";d[231]="c";d[252]="u";d[251]="u";d[250]="u";d[249]="u";d[233]="e";d[234]="e";d[235]="e";d[232]="e";d[226]="a";d[228]="a";d[224]="a";d[229]="a";d[225]="a";d[239]="i";d[238]="i";d[236]="i";d[237]="i";d[196]="A";d[197]="A";d[201]="E";d[230]="ae";d[198]="Ae";d[244]="o";d[246]="o";d[242]="o";d[243]="o";d[220]="U";d[255]="Y";d[214]="O";d[241]="n";d[209]="N";return{generateKey:function(e,t){var n="number"==typeof(t=v.extend({},t)).desiredKeyLength?t.desiredKeyLength:4,a="number"==typeof t.maxKeyLength?t.maxKeyLength:1/0;if(!(e=v.trim(e)))return"";for(var r=[],o=0,i=e.length;o<i;o++){var u=d[e.charCodeAt(o)];r.push(u||e[o])}e=r.join("");var c=[];v.each(e.split(/\s+/),function(e,t){t&&(t=(t=t.replace(/[^a-zA-Z]/g,"")).toUpperCase()).length&&c.push(t)});if(0==(c=n&&l(c)>n?(t=c,v.grep(t,function(e,t){return-1===v.inArray(e,f)})):c).length)g="";else if(1==c.length)var h=c[0],s=function(e){for(var t=!1,n=0;n<e.length;n++)if(m(e[n]))t=!0;else if(t)return e.substring(0,n+1);return e}(h),g=a<h.length||Math.abs(h.length-n)>=Math.abs(s.length-n)?s:h;else{s=l(c),h=function(e){var n="";v.each(e,function(e,t){n+=t.charAt(0)});return n}(c);g=a<s||Math.abs(s-n)>=Math.abs(h.length-n)?h:c.join("")}return g=a&&g.length>a?g.substr(0,a):g}}};var c=e.KeyGenerator();v.fn.generateFrom=function(o,i){var u=v(this).first(),o=o.first(),i=v.extend({},{desiredKeyLength:4,maxKeyLength:10,maxNameLength:30,timeoutMS:100,validationCallback:function(){},errorCallback:function(){}},i);!function(){function t(){u.val(),u.val()&&u.data("lastGeneratedValue")!==u.val()&&u.data("autosuggest",!1);a()}function e(e){n(e,t)}var n=function(e,t){var n=v(e.target),a=function(){r(e);t();n.is(":visible")&&n.data("checkHook",setTimeout(a,i.timeoutMS))};n.data("checkHook")||n.data("checkHook",setTimeout(a,0))},r=function(e){e=v(e.target);clearTimeout(e.data("checkHook"));e.removeData("checkHook")},a=function(){!1!==u.data("autosuggest")&&function(e){u.data("lastGeneratedValue",e);u.val(e)}(c.generateKey(o.val(),{desiredKeyLength:i.desiredKeyLength,maxKeyLength:i.maxKeyLength}))};o.attr("maxlength",i.maxNameLength);u.attr("maxlength",i.maxKeyLength);u.css("text-transform","uppercase");document.activeElement&&document.activeElement===o[0]&&e({target:o[0]});o.focus(e);o.blur(r)}();return this}}(window,jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:gh-create-board', location = 'includes/js/rapid/ui/startwizard/WizardView.js' */
"use strict";define("jira-agile/rapid/ui/startwizard/wizard-view",["jira-agile/config","jira-agile/projects/project-picker","jira-agile/rapid/ajax","jira-agile/rapid/analytics-tracker","jira-agile/rapid/navigation","jira-agile/rapid/ui/component/saved-filter-picker","jira-agile/rapid/user-data","jira-agile/rapid/validation","jira/util/events","jira/util/events/types","jira/util/formatter","jquery","underscore"],function(t,e,n,r,a,o,i,l,c,d,s,p,u){var g={dialog:void 0,model:void 0,stepsNameStack:void 0,pages:{},filterPicker:void 0,projectPicker:void 0};g.analytics=new r("gh.create.wizard");g.wizardStepPreRenderCallbacks=[];g.wizardStepPostRenderCallbacks=[];g.wizardStepOnValidateCallbacks=[];g.wizardStepOnCreateCallbacks=[];g.steps={methodologySelection:{render:function(){var e={isSampleDataAvailable:t.isSampleDataAvailable,canCreateProject:i.canCreateProject()};return{header:"Crear una pizarra de Agile",content:GH.tpl.startwizard.renderMethodologySelectionStep(e)}},bind:function(e,t){p("#ghx-wizard-methodology-scrum").click(function(e){e.preventDefault();t.sampleData=!1;g.selectMethodology("scrum",t)});p("#ghx-wizard-methodology-kanban").click(function(e){e.preventDefault();t.sampleData=!1;g.selectMethodology("kanban",t)});p("#ghx-wizard-methodology-scrum-sample").click(function(e){e.preventDefault();t.sampleData=!0;g.selectMethodology("scrum",t)});p("#ghx-wizard-methodology-kanban-sample").click(function(e){e.preventDefault();t.sampleData=!0;g.selectMethodology("kanban",t)})}},methodSelection:{render:function(e){var t=(t=e.method)||(i.userConfig.canCreateProject?"newProject":"existingProject");return{header:"Crear una pizarra de Agile",content:GH.tpl.startwizard.renderMethodSelectionStep(u.extend({},e,{canCreateProject:i.userConfig.canCreateProject,hasProjectsAccessible:i.userConfig.hasProjectsAccessible,hasFiltersAccessible:i.userConfig.hasFiltersAccessible,selectedOption:t}))}},bind:function(e){},next:function(e,t){e=e.find("input[name=ghx-wizard-method]").filter(":checked").val();t.method=e;t=p.Deferred();"newProject"===e?t.resolve("projectCreation"):"existingProject"===e?t.resolve("projectSelection"):"existingFilter"===e?t.resolve("filterSelection"):t.reject(new Error("Unknown board creation method : "+e));return t.promise()}},projectCreation:{render:function(e){e.prefix="project";return g.renderProjectCreation({user:i.userConfig,prefix:"project",sampleInfo:{projectName:"",projectKey:""}})},bind:function(e,t){g.bindProjectCreation(e,t)},completeActionName:"Crear pizarra",complete:function(e){return g.createProject(g.dialog,e)}},sampleProjectCreation:{render:function(e){e.prefix="sample";return g.renderProjectCreation({user:i.userConfig,prefix:"sample",sampleInfo:e.sampleInfo})},bind:function(e,t){g.bindProjectCreation(e,t)},completeActionName:"Crear pizarra",complete:function(e){return g.createSampleProject(g.dialog,e)}},projectSelection:{render:function(){return{header:"Nombrar esta pizarra",content:GH.tpl.startwizard.renderProjectSelectionStep()}},bind:function(e,t){g.bindProjectSelection(e,t)},completeActionName:"Crear pizarra",complete:function(e){return g.validateProjectSelection(e)}},filterSelection:{render:function(){return{header:"Nombrar esta pizarra",content:GH.tpl.startwizard.renderFilterSelectionStep()}},bind:function(e,t){g.bindFilterSelection(e,t)},completeActionName:"Crear pizarra",complete:function(e){return g.validateFilterSelection(e)}}};g.show=function(){if(!g.dialog){g.dialog=GH.Dialog.create({width:840,height:400,id:"ghx-wizard-dialog",onCancelFn:function(){g.disposeWizard();g.analytics.trigger("cancel")}});g.model={};g.stepsNameStack=[];g.dialog.show();g.analytics.trigger("start");g.preventSubmitOnEnter()}};g.preventSubmitOnEnter=function(){p("input").keydown(function(e){if(13===e.keyCode&&"ghx-wizard-filter-select-field"!==e.target.id){e.preventDefault();return!1}})};g.showStep=function(a){if(!u.has(g.steps,a))throw new Error("Unknown wizard step "+a);var n=g.dialog;if(g.pages[a]){n.gotoPage(g.pages[a]);g.dialog.popup.element.find(".dialog-panel-body .aui-message-error").remove()}else{var o=g.steps[a],e=o.render(g.model);u.each(g.wizardStepPreRenderCallbacks,function(e){e(a)});n.addPage();g.pages[a]=n.curpage;n.addHeader(e.header);var i=p(e.content);n.addPanel(null,i,"ghx-wizard-panel");u.each(g.wizardStepPostRenderCallbacks,function(e){e(a,n)});0<g.stepsNameStack.length&&n.addButton("Retroceder",function(){var e=g.stepsNameStack.pop();g.showStep(e)},"aui-button");if(u.has(o,"complete"))n.addButton(o.completeActionName,function(){"true"!==p(this).attr("aria-disabled")&&o.complete(g.model)},"aui-button aui-button-primary js-wizard-button-complete");else if(u.has(o,"next"))n.addButton("Siguiente",function(){if("true"!==p(this).attr("aria-disabled")){var e=o.next(i,g.model),t=function(e){console.log(e);n.updateHeight()},r=!0;u.each(g.wizardStepOnValidateCallbacks,function(e){e(a,n)||(r=!1)});e.done(function(e){r?function(e){g.stepsNameStack.push(a);g.showStep(e)}(e):t("GH project create extension callback returned failure")}).fail(t)}},"aui-button aui-button-primary js-wizard-button-next");n.addCancel("Cancelar",function(){n.cancel()});o.bind(i,g.model)}n.updateHeight();g.preventSubmitOnEnter()};g.startWizard=function(){g.show();g.showStep("methodologySelection")};g.disposeWizard=function(){g.dialog=void 0;g.pages={}};g.genStartFunction=function(e,t){return function(){g.show();g.model.sampleData=t;g.selectMethodology(e,g.model)}};g.bindWelcomePage=function(){GH.Dialog.registerDialog(".js-wizard-scrum",g.genStartFunction("scrum",!1));GH.Dialog.registerDialog(".js-wizard-scrum-sample",g.genStartFunction("scrum",!0));GH.Dialog.registerDialog(".js-wizard-kanban",g.genStartFunction("kanban",!1));GH.Dialog.registerDialog(".js-wizard-kanban-sample",g.genStartFunction("kanban",!0))};g.getCreateProjectRequest=function(e){var t=e.project;return{projectName:t.name,projectKey:t.key,projectLeadUserName:t.lead,boardName:e.boardName,preset:e.methodology,sampleData:e.sampleData}};g.createProject=function(r,a){g.populateProjectCreationProperties(a);var e=g.getCreateProjectRequest(a);r.disableControls();r.showSpinner();var t={url:"/welcome/createProject",data:e,errorContextMap:{projectName:"#ghx-wizard-"+a.prefix+"-projectname",projectKey:"#ghx-wizard-"+a.prefix+"-projectkey",projectLead:"#ghx-wizard-"+a.prefix+"-projectlead"},timeout:12e4,deferErrorHandling:!0};return n.put(t).done(function(e){e.success.sample=a.sampleData;GH.PersistentMessages.WelcomeMessage.show(e.success);var t=function(){g.gotoCreatedView(e.success.rapidView.id,a.methodology)};!function e(){0===g.wizardStepOnCreateCallbacks.length?t():g.wizardStepOnCreateCallbacks.pop()(r,e,a)}()}).fail(function(e){u.each(e.getGlobalErrors(),function(e){if(504===e.status){e.message=GH.tpl.startwizard.createProjectTimeout({manageBoardURL:GH.RapidBoard.getManageViewsPageUrl()});e.noAutoescape=!0}});n.handleContextualErrors(e,t.errorContextMap);n.handleGlobalErrors(e,t.errorContextMap);r.hideSpinner();r.enableControls();r.updateHeight()})};g.validateProjectSelection=function(t){g.dialog.disableControls();g.dialog.showSpinner();var e=p("#ghx-wizard-project-board-name");l.clearContextualErrors(g.projectPicker.getElement());l.clearContextualErrors(e);return n.post({url:"/rapidview/create/presets",data:{name:e.val(),projectIds:g.projectPicker.getValue(),preset:t.methodology},errorContextMap:{name:"#ghx-wizard-project-board-name",projectIds:g.projectPicker.selector}}).done(function(e){console.log("mode: "+t);g.handleCreate(e,"simple",t.methodology)}).fail(function(){g.dialog.enableControls();g.dialog.hideSpinner();g.dialog.updateHeight()})};g.validateFilterSelection=function(t){var e=p("#ghx-wizard-filter-view-name"),r=g.filterPicker.getElement(),a=p(g.filterPicker.selector);l.clearContextualErrors(e);l.clearContextualErrors(r);a=a.val()?a.val()[0]:null;g.dialog.disableControls();g.dialog.showSpinner();return n.post({url:"/rapidview/create/advanced",data:{name:e.val(),filterId:a,methodology:t.methodology},errorContextMap:{name:"#ghx-wizard-filter-view-name",filterId:g.filterPicker.selector}}).done(function(e){g.handleCreate(e,"simple",t.methodology)}).fail(function(){g.dialog.hideSpinner();g.dialog.enableControls();g.dialog.updateHeight()})};g.handleCreate=function(e,t,r){GH.PersistentMessages.CreateViewMessage.setView(e.success.id,e.success.name,t,t!==r&&r);g.analytics.trigger("complete");g.gotoCreatedView(e.success.id,r)};g.gotoCreatedView=function(e,t){a.gotoDefaultRapidBoardPage(e,"scrum"===t?"planning":null)};g.selectMethodology=function(e,t){t.methodology=e;g.stepsNameStack.push("methodologySelection");if(t.sampleData)n.get({url:"/welcome/sampledataproject?preset="+t.methodology},"sampledataproject").done(function(e){t.sampleInfo=e;g.showStep("sampleProjectCreation")}).fail(function(){g.showStep("sampleProjectCreation")});else{var r=i.userConfig.canCreateProject,a=i.userConfig.hasProjectsAccessible,e=i.userConfig.hasFiltersAccessible;r||e?a||e?g.showStep("methodSelection"):g.showStep("projectCreation"):g.showStep("projectSelection")}};g.populateProjectCreationProperties=function(e){var t=p("#ghx-wizard-"+e.prefix+"-projectname"),r=p("#ghx-wizard-"+e.prefix+"-projectkey"),a=p("#ghx-wizard-"+e.prefix+"-projectlead");l.clearContextualErrors(t);l.clearContextualErrors(r);l.clearContextualErrors(a);e.project={name:t.val(),key:r.val().toUpperCase(),lead:p("#ghx-wizard-"+e.prefix+"-projectlead option:selected").val()}};g.createSampleProject=function(e,t){t.sampleData=!0;g.createProject(e,t)};g.validateBoardName=function(e,t){l.clearContextualErrors(e);t.boardName=e.val();if(t.boardName)return!0;l.showContextualErrors(e,"Ingrese un nombre para la pizarra.");return!1};g.renderProjectCreation=function(e){return{header:"Nuevo proyecto con pizarra",content:GH.tpl.startwizard.renderProjectCreationStep(e)}};g.bindProjectSelection=function(){g.projectPicker=new e({selector:"#ghx-wizard-choose-project",change:function(){g.dialog.updateHeight()},currentProjectId:JIRA.API&&JIRA.API.Projects?JIRA.API.Projects.getCurrentProjectId():null});g.projectPicker.multiselect.keys.Return=function(e){e.preventDefault()};g.attachDependantButton({buttonIndex:1,selectors:["#ghx-wizard-project-board-name","#ghx-wizard-choose-project"]})};g.bindProjectCreation=function(e,t){p("#ghx-wizard-"+t.prefix+"-projectkey").generateFrom(p("#ghx-wizard-"+t.prefix+"-projectname"),{maxNameLength:64,maxKeyLength:64});c.trigger(d.NEW_CONTENT_ADDED,[e]);e.trigger("contentRefresh");g.attachDependantButton({buttonIndex:1,selectors:["#ghx-wizard-"+t.prefix+"-projectname","#ghx-wizard-"+t.prefix+"-projectkey","#ghx-wizard-"+t.prefix+"-projectlead"]})};g.bindFilterSelection=function(e,a){g.filterPicker=new o({selector:"#ghx-wizard-filter-select",selected:function(e,t){var r="";delete a.savedFilter;if(t&&t.properties){t=t.properties.savedFilter,r=null!=t?GH.tpl.startwizard.renderPermissionInfo({savedFilter:t}):"";a.savedFilter=t}p("#ghx-create-permissioninfo-container").html(r);g.dialog.updateHeight()},stayActivated:!0});g.filterPicker.show(a.savedFilter);g.filterPicker.singleSelect.keys.Return=function(e){e.preventDefault()};g.attachDependantButton({buttonIndex:1,selectors:["#ghx-wizard-filter-view-name","#ghx-wizard-filter-select"]})};g.attachDependantButton=function(e){var t=g.dialog,r=t.page[t.curpage].button[e.buttonIndex].item;g.dependantValidationListener({selectors:e.selectors,full:function(){r.attr("aria-disabled","false")},empty:function(){r.attr("aria-disabled","true")}})};g.dependantValidationListener=function(t){if(!u.isEmpty(t.selectors)){t.full=t.full||p.noop();t.empty=t.empty||p.noop();t.nowait=t.nowait||!1;u.each(t.selectors,function(e){e=p(e);e.on("input",r);e.on("change",r);e.on("selected",r);e.on("unselect",r)});e()}function e(){var e=u.filter(t.selectors,function(e){e=p(e);return!p.trim(e.val())});return u.isEmpty(e)?t.full():t.empty()}function r(){t.nowait?e():setTimeout(e,50)}};g.registerWizardStepPreRenderCallback=function(e){g.wizardStepPreRenderCallbacks.push(e)};g.registerWizardStepPostRenderCallback=function(e){g.wizardStepPostRenderCallbacks.push(e)};g.registerWizardStepOnValidateCallback=function(e){g.wizardStepOnValidateCallbacks.push(e)};g.registerWizardStepOnCreateCallbacks=function(e){g.wizardStepOnCreateCallbacks.push(e)};return g});AJS.namespace("GH.StartWizardView",null,require("jira-agile/rapid/ui/startwizard/wizard-view"));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.pyxis.greenhopper.jira:sidebar', location = 'includes/js/sidebar/create-board.js' */
"use strict";require(["jira-agile/rapid/ui/startwizard/wizard-view","jira-agile/rapid/user-data","jira/util/init-on-dcl","jquery"],function(e,r,i,a){i(function(){a("body").on("click",".js-create-board",function(i){i.preventDefault();r.userConfig={canCreateProject:!1,hasProjectsAccessible:!0,hasFiltersAccessible:!0};e.startWizard()})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.servicedesk.frontend-webpack-plugin:split_jira.rich.editor', location = 'jira.rich.editor.6ef6a5f042188d295342.js' */
(window.jsdsjsonp=window.jsdsjsonp||[]).push([[326],{1000:function(e,t,n){"use strict";var s=n(165),a=n(299),r=n.n(a),i=n(999),o=n(998);t.a={getInsertTextEditorExtension:function(e){var t=e.attr("data-editor-id"),n=r.a.getEntry(t),a=n.currentMode;if(a===s.a.Modes.VISUAL)return new i.a(n);if(a===s.a.Modes.TEXT){var c=e.data("wikiEditor");return new o.a(c)}throw new Error("Editor mode "+a+" is not supported")}}},1001:function(e,t,n){"use strict";var s=n(4),a=n(1),r=n(5),i=n(49),o=n(303),c=n(997),l=n(245),d=n(254),u=n(371),p=n(20),h=n.n(p),g=n(37),f=n.n(g),m=(n(187),n(995)),v={13:"ENTER",38:"UP",40:"DOWN"},y=r.a.View.extend({events:{"mouseenter .cr-response-item":"_onCRItemMouseEnter","mouseenter .cr-menu-item":"_onMenuItemMouseEnter","click .cr-response-item":"_onCRItemClick","click #cr-open-add-dialog":"_openAddDialog","click #cr-open-manage-dialog":"_openManageDialog"},initialize:function(e){var t=e.context;this.context=t,this.model.crCollectionFrequent.on("sync",this.render,this),this.model.crCollectionPopular.on("sync",this.render,this),this.model.crCollectionSearch.on("reset",this.render,this),this.state={isSearching:!1}},handleNavigation:function(e){var t=this.$(".cr-menu-item"),n=t.filter(".active");if("ENTER"!==e){var s=t.length,a=t.index(n);"DOWN"===e?a=a>=s-1?0:++a:"UP"===e&&(a=a<=0?s-1:--a),t.mouseleave(),t.eq(a).mouseover()}else n.click()},_getCannedResponseModel:function(e){var t=e.attr("data-cannedresponse-id");return(this.model.crCollectionFrequent.get(t)||this.model.crCollectionPopular.get(t)||this.model.crCollectionSearch.get(t)).toJSON()},_getSelectionGroup:function(e){return e.parents("div[data-cannedresponse-group]").attr("data-cannedresponse-group")},_onCRItemMouseEnter:function(e){this.context.preview(this._getCannedResponseModel(Object(a.default)(e.target)))},_onMenuItemMouseEnter:function(e){this.$(".cr-menu-item").removeClass("active"),Object(a.default)(e.target).closest(".cr-menu-item").addClass("active")},_onCRItemClick:function(e){e.preventDefault();var t=Object(a.default)(e.target),n=this._getCannedResponseModel(t);this.context.select({cannedResponse:n,source:i.a.CR_SELECT_SOURCES.DROPDOWN,group:this._getSelectionGroup(t)}),n&&Array.isArray(n.unresolvedVariables)&&n.unresolvedVariables.length>0&&new m.a({context:this.context,model:n}).show()},_openAddDialog:function(e){var t=this;e.preventDefault();var n=new o.a({context:this.context,model:new l.a({},{projectKey:this.context.getProjectKey()})});n.on("showDialog",function(){Object(a.default)("#crEditDialog").find("textarea").val(t.context.getCommentMarkupVal())}),n.show(),this.context.openAddDialog({source:i.a.CR_ADD_SOURCES.DROPDOWN})},_openManageDialog:function(e){e.preventDefault(),new c.a({context:this.context,model:new d.a([],{projectKey:this.context.getProjectKey()})}).show(),this.context.openManageDialog({source:i.a.CR_ADD_SOURCES.DROPDOWN})},render:function(){var e=ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuList({crCollectionFrequent:this.model.crCollectionFrequent.toJSON(),crCollectionPopular:this.model.crCollectionPopular.toJSON(),crCollectionSearch:this.model.crCollectionSearch.toJSON(),isSearching:this.state.isSearching});return this.$el.html(e),this.context.adjustHeight({dropdownHeight:this.$el.height()}),this}});t.a=r.a.View.extend({className:"cannedresponses-menu-dropdown aui-dropdown2 aui-style-default aui-layer",events:{"mouseleave .cr-list":"_onCRMenuDropdownLeave","aui-dropdown2-hide":"_onCRMenuDropdownLeave","keydown input.text":"_onSearchKeydown","input input.text":"_onSearchInput"},attributes:function(){this.id=this.options.dropdownId},initialize:function(e){var t=this,n=e.context;this.context=n,this.dropdownListView=new y({model:this.model,context:n}),this.listenTo(n.eventBus,"cannedresponses:showMenuDropdown",this._onShowMenuDropdown),this.listenTo(n.globalEvents,"cannedresponses:add",this._refreshFrequentAndPopular),this.listenTo(n.globalEvents,"cannedresponses:update",this._refreshFrequentAndPopular),this.listenTo(n.globalEvents,"cannedresponses:delete",this._refreshFrequentAndPopular),this._debouncedRefresh=s.default.debounce(this._refreshFrequentAndPopular.bind(this),500),h.a.bind(f.a.INLINE_EDIT_SAVE_COMPLETE,this._debouncedRefresh),h.a.bind(f.a.ISSUE_REFRESHED,this._debouncedRefresh),this._onSearchInput=s.default.debounce(this._onSearchInput,500),this.descriptorFetcher=Object(u.a)({searchAttributes:function(e){return{query:e,limit:i.a.MAX_RESULTS_SEARCH,offset:0,substitute:!0,issueKey:t.context.getIssueKey()}},url:this.model.crCollectionSearch.url(),parseFunction:this.model.crCollectionSearch.parse}),this._refreshFrequentAndPopular()},_onCRMenuDropdownLeave:function(){this.context.unhover()},_onSearchKeydown:function(e){Object.keys(v).indexOf(e.which.toString())>-1&&(e.preventDefault(),this.dropdownListView.handleNavigation(v[e.which]))},_onSearchInput:function(e){var t=this,n=e.target.value;this.dropdownListView.state.isSearching=!!n,this.descriptorFetcher.execute(n).done(function(e){t.model.crCollectionSearch.reset(e.cannedResponses)}),this.context.search({source:i.a.CR_SEARCH_SOURCES.DROPDOWN})},_refreshFrequentAndPopular:function(){var e=i.a.MAX_RESULTS_TOP_LISTS,t=this.context.getIssueKey();this.model.crCollectionFrequent.fetchFrequentlyUsed({limit:e,issueKey:t}),this.model.crCollectionPopular.fetchPopular({limit:e,issueKey:t})},_onShowMenuDropdown:function(){var e=this;this.context.adjustHeight({dropdownHeight:this.dropdownListView.$el.height()}),setTimeout(function(){return e.$("input").focus()},0)},unbindJiraEvents:function(){h.a.unbind(f.a.INLINE_EDIT_SAVE_COMPLETE,this._debouncedRefresh),h.a.unbind(f.a.ISSUE_REFRESHED,this._debouncedRefresh)},render:function(){return this.$el.html(ServiceDesk.Internal.CannedResponses.Templates.dropdownMenu()),this.dropdownListView.$el=this.$("#crDropdownMenuList"),this.dropdownListView.render(),this.dropdownListView.delegateEvents(),this}})},1002:function(e,t){e.exports=require("jira/util/navigator")},1003:function(e,t){e.exports=require("jira/editor/customizer")},1004:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var s=n(1),a=n(4),r=n(1003),i=n.n(r),o=n(299),c=n.n(o),l=n(1002),d=n.n(l),u=n(210),p=n(254),h=n(1001),g=n(994),f=n(993),m=n(992),v=n(991),y=n(990),b=(n(1396),n(35)),S=n.n(b),_=a.default.once(function(){i.a.customizeSettings(function(e,t){t.PluginManager.add("cannedResponses",function(e){var t=Object(s.default)(e.getElement());if(Object(u.b)({rteElement:t})){var n=u.a.getOrCreateContext(t),a=new m.a({context:n,editor:e});a.setElement(e.editorContainer),d.a.isIE()&&(e.off("focus").off("focusin"),e.on("click",function(){t.trigger("click").trigger("focusin")})),n.rteView=a}}),e.plugins=e.plugins||[],e.plugins.push("cannedResponses")}),c.a.on("unregister",function(e){Object(s.default)(e.toolbar).find("#crLink, .cannedresponses-menu-dropdown, .cr-insert-variable-trigger").remove(),u.a.destroy(e.id)}),c.a.on("register",function(e){var t=Object(s.default)(e.textArea),n=Object(s.default)(e.toolbar);if(S.a.isFeatureEnabled("sd.canned.responses.variable.substitution")&&Object(u.c)({rteElement:t})){var r=Object(s.default)(e.toolbar).find(".wiki-edit-other-picker-trigger"),i=ServiceDesk.Internal.CannedResponses.Templates.insertVariableButton();Object(s.default)(i).insertAfter(r)}if(Object(u.b)({rteElement:t})){var o=u.a.getOrCreateContext(t,e.id);o.entry=e;var c=o.getProjectKey(),l=new p.a([],{projectKey:c}),d=new p.a([],{projectKey:c}),m=new p.a([],{projectKey:c}),b=a.default.uniqueId("wiki-edit-dropdown2-cannnedresponses-wikiEdit");o.crDropdown=new h.a({model:{crCollectionFrequent:l,crCollectionPopular:d,crCollectionSearch:m},context:o,dropdownId:b}),o.crDropdown.render().$el.insertBefore(n);var _=n.find(".wiki-edit-other-picker-trigger").parent();new g.a({context:o,$textArea:t,dropdownId:b}).render().$el.insertAfter(_),Object(s.default)("#crLink").tooltip(),new f.a({context:o}).setElement(e.textArea),Object(v.a)({context:o}),Object(y.a)({context:o})}})})},1191:function(e,t,n){"use strict";"undefined"==typeof ServiceDesk&&(window.ServiceDesk={}),void 0===ServiceDesk.Templates&&(ServiceDesk.Templates={}),void 0===ServiceDesk.Templates.Components&&(ServiceDesk.Templates.Components={}),ServiceDesk.Templates.Components.paginator=function(e,t){var n="";if(e.endPage>1){n+='<ol class="aui-nav aui-nav-pagination"><li class="aui-nav-prev js-prev-page"><a'+(e.startPage==e.currentPage?' aria-disabled="true"':"")+">"+soy.$$escapeHtml("Previo")+"</a></li>";for(var s=e.startPage,a=e.endPage+1,r=s;r<a;r++)n+=r==e.currentPage?'<li class="aui-nav-selected">'+soy.$$escapeHtml(r)+"</li>":'<li class="js-page" page-index="'+soy.$$escapeHtml(r)+'"><a>'+soy.$$escapeHtml(r)+"</a></li>";n+='<li class="aui-nav-next js-next-page"><a'+(e.endPage==e.currentPage?' aria-disabled="true"':"")+">"+soy.$$escapeHtml("Siguiente")+"</a></li></ol>"}return n},goog.DEBUG&&(ServiceDesk.Templates.Components.paginator.soyTemplateName="ServiceDesk.Templates.Components.paginator");ServiceDesk.Templates.Components},1192:function(e,t,n){},124:function(e,t,n){"use strict";var s=n(83);t.a=Object(s.a)("com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data")},1246:function(e,t,n){},1247:function(e,t,n){"use strict";n(34),n(30);"undefined"==typeof ServiceDesk&&(window.ServiceDesk={}),void 0===ServiceDesk.Templates&&(ServiceDesk.Templates={}),void 0===ServiceDesk.Templates.SearchInput&&(ServiceDesk.Templates.SearchInput={}),ServiceDesk.Templates.SearchInput.content=function(e,t){return'<form class="aui"><div class="sd-search-input"><span class="aui-icon aui-icon-small aui-iconfont-search js-copy-clipboard sd-search-icon"></span><input type="text" class="js-search-field sd-search-field ajs-dirty-warning-exempt full-width-field text" placeholder="'+soy.$$escapeHtml(e.searchPlaceholder)+'" data-intro="'+soy.$$escapeHtml(e.searchIntro)+'" data-position="bottom"><aui-spinner class="js-spinner sd-search-spin" size="small"></aui-spinner>'+aui.buttons.button({extraClasses:"aui-button-compact sd-clear-query js-clear-query",extraAttributes:{type:"button"},iconType:"aui",iconClass:"clear-icon aui-icon-small aui-iconfont-cross-circle",iconText:"Eliminar",type:"subtle",text:""})+"</div></form>"},goog.DEBUG&&(ServiceDesk.Templates.SearchInput.content.soyTemplateName="ServiceDesk.Templates.SearchInput.content");ServiceDesk.Templates.SearchInput},1248:function(e,t,n){},138:function(e,t,n){"use strict";var s=n(1),a=n(5),r=n(76),i=n.n(r);t.a=a.a.View.extend({tagName:"section",attributes:{role:"dialog","data-aui-modal":"true"},events:{"click .dialog-close-button":"_closeDialog"},initialize:function(e){var t=e.context;this.context=t},_hasPreviousDialog:function(){return this.$previousDialog&&this.$previousDialog.length>0},_handleKeypress:function(e){e.stopPropagation(),27===e.keyCode&&this._closeDialog()},show:function(){this.$previousDialog=Object(s.default)(".jira-dialog:visible,.aui-dialog2:visible"),this._hasPreviousDialog()&&(this.$el.attr("data-aui-blanketed","false"),this.$previousDialog.hide()),this.render().$el.appendTo("body"),this.dialog=i()(this.$el),this.keypressHandlerFn=this._handleKeypress.bind(this),window.addEventListener("keydown",this.keypressHandlerFn,!0),this.dialog.show(),this.trigger("showDialog")},_closeDialog:function(){var e=this;window.removeEventListener("keydown",this.keypressHandlerFn,!0),this.dialog&&(this.dialog.on("hide",function(){e.remove()}),this.dialog.hide()),this._hasPreviousDialog()&&this.$previousDialog.show()}})},1396:function(e,t,n){},1397:function(e,t,n){"use strict";n.r(t);n(119),n(121),n(129),n(120),n(109),n(34),n(130),n(115),n(30);var s=n(1004),a=n(35);n.n(a).a.isFeatureEnabled("sd.canned.responses")&&Object(s.a)(),function(e){function t(e){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.querySelectorAll("br"))).forEach(function(e){var t=document.createTextNode("\n");e.parentNode.replaceChild(t,e)}),e.textContent}"Internal.VariableSubstitution.Feature.WikiRenderer.SdInlineNoFormat".split(".").forEach(function(t){e[t]=e[t]||{},e=e[t]}),e.convert=function(e){return"{sd-inline-noformat}"+t(e.node).replace(/[\\${]/g,"\\$&")+"{sd-inline-noformat}"}}(ServiceDesk)},165:function(e,t,n){"use strict";t.a={Modes:{TEXT:"source",VISUAL:"wysiwyg"}}},187:function(e,t,n){"use strict";n(34),n(30),n(235);"undefined"==typeof ServiceDesk&&(window.ServiceDesk={}),void 0===ServiceDesk.Internal&&(ServiceDesk.Internal={}),void 0===ServiceDesk.Internal.CannedResponses&&(ServiceDesk.Internal.CannedResponses={}),void 0===ServiceDesk.Internal.CannedResponses.Templates&&(ServiceDesk.Internal.CannedResponses.Templates={}),ServiceDesk.Internal.CannedResponses.Templates.crToolbarMenuItem=function(e,t){return""+aui.buttons.button({text:"",type:"subtle",href:"#wiki-edit-dropdown2-cannnedresponses-wikiEdit0",iconType:"aui",iconClass:"aui-icon-small aui-iconfont-cannedresponses cannedresponses-icon",extraClasses:"aui-dropdown2-trigger wiki-edit-operation-dropdown wiki-edit-other-picker-trigger wiki-edit-tooltip",extraAttributes:{id:"crLink","aria-owns":e.dropdownId,"aria-haspopup":"true",title:"Respuestas preestablecidas","data-aui-alignment-container":"#addcomment"}})},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.crToolbarMenuItem.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.crToolbarMenuItem"),ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem=function(e,t){return'<li><a class="cr-response-item cr-menu-item" data-cannedresponse-id="'+soy.$$escapeHtml(e.cr.id)+'" href="#">'+soy.$$escapeHtml(e.cr.title)+"</a></li>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem"),ServiceDesk.Internal.CannedResponses.Templates.dropdownMenu=function(e,t){return'<ul class="aui-list-truncate"><li><form class="aui"><div class="field-group"><input type="text" class="text" maxlength="255" /></div></form></li><div id="crDropdownMenuList"></div></ul>'},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.dropdownMenu.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.dropdownMenu"),ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuList=function(e,t){var n="";if(e.isSearching){n+='<div class="cr-list cr-list-search-results" data-cannedresponse-group="search">';var s=e.crCollectionSearch,a=s.length;if(a>0)for(var r=0;r<a;r++){var i=s[r];n+=ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem({cr:i})}else n+='<li class="cr-menu-no-match"><span>'+soy.$$escapeHtml("No hay respuestas coincidentes")+"</span></li>";n+="</div>"}else{if(e.crCollectionFrequent&&e.crCollectionFrequent.length>0){n+='<div class="aui-dropdown2-section cr-list cr-list-frequently-used" data-cannedresponse-group="frequent"><li><span class="cr-menu-text">'+soy.$$escapeHtml("De uso frecuente")+"</span></li>";for(var o=e.crCollectionFrequent,c=o.length,l=0;l<c;l++){var d=o[l];n+=ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem({cr:d})}n+="</div>"}if(e.crCollectionPopular&&e.crCollectionPopular.length>0){n+='<div class="aui-dropdown2-section cr-list cr-list-popular" data-cannedresponse-group="popular"><li><span class="cr-menu-text">'+soy.$$escapeHtml("Popular")+"</span></li>";for(var u=e.crCollectionPopular,p=u.length,h=0;h<p;h++){var g=u[h];n+=ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuCRItem({cr:g})}n+="</div>"}n+='<div class="aui-dropdown2-section cr-actions"><li><a href="#" id="cr-open-add-dialog" class="cr-menu-item"><span class="aui-icon aui-icon-small aui-iconfont-add"></span>'+soy.$$escapeHtml("Guardar como respuesta")+'</a></li><li><a href="#" id="cr-open-manage-dialog" class="cr-menu-item"><span class="aui-icon aui-icon-small aui-iconfont-edit"></span>'+soy.$$escapeHtml("Editar respuestas")+"</a></li></div>"}return n},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuList.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.dropdownMenuList"),ServiceDesk.Internal.CannedResponses.Templates.crAutocomplete=function(e,t){return'<span class="cr-autocomplete" style="background-color: #eee; border: solid 1px #ddd; color: #1e90ff"><span class="cr-autocomplete-trigger" style="background-color: #ddd; padding: 0 2px">'+soy.$$escapeHtml(e.autocompleteTrigger)+'</span><span class="cr-autocomplete-search-text" style="padding: 0 4px 0 2px;"><span>&#65279;'+soy.$$escapeHtml(null==e.searchText?" ":e.searchText)+"</span></span></span>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.crAutocomplete.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.crAutocomplete"),ServiceDesk.Internal.CannedResponses.Templates.crAutocompleteDropdown=function(e,t){for(var n='<a href="#" id="crAutocompleteDropdownTrigger" aria-owns="crAutocompleteDropdown" aria-haspopup="true" class="aui-button aui-style-default aui-dropdown2-trigger" style="position: absolute; top: '+soy.$$escapeHtml(e.top)+"px; left: "+soy.$$escapeHtml(e.left)+'px; height: 1px; width: 1px; z-index:-1000"></a><div id="crAutocompleteDropdown" class="aui-style-default aui-dropdown2"><ul class="aui-list-truncate"><li class="cr-menu-text">'+soy.$$escapeHtml("De uso frecuente")+"</li>",s=e.crItems,a=s.length,r=0;r<a;r++){var i=s[r];n+='<li><a class="cr-response-item" data-cannedresponse-id="'+soy.$$escapeHtml(i.id)+'" href="#">'+soy.$$escapeHtml(i.title)+"</a></li>"}return n+="</ul></div>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.crAutocompleteDropdown.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.crAutocompleteDropdown"),ServiceDesk.Internal.CannedResponses.Templates.manageDialog=function(e,t){return""+aui.dialog.dialog2Content({titleText:"Gestionar respuestas preestablecidas",content:'<div id="action-header"><div class="sd-search-container js-canned-responses-search"></div><button class="cr-add-response-button aui-button">'+soy.$$escapeHtml("A\u00f1adir una respuesta")+'</button></div><div id="list-container"></div>',footerActionContent:'<button class="dialog-close-button aui-button aui-button-link">'+soy.$$escapeHtml("Cerrar")+"</button>"})},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.manageDialog.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.manageDialog"),ServiceDesk.Internal.CannedResponses.Templates.paginator=function(e,t){return"<sd-paginator num-pages="+soy.$$escapeHtml(e.pages)+" current-page="+soy.$$escapeHtml(e.currentPage)+"></sd-paginator>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.paginator.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.paginator"),ServiceDesk.Internal.CannedResponses.Templates.cannedResponsesList=function(e,t){for(var n='<table class="aui"><thead><tr><th id="cr-title">'+soy.$$escapeHtml("Nombre")+'</th><th id="cr-content">'+soy.$$escapeHtml("Respuesta")+'</th><th id="cr-usage">'+soy.$$escapeHtml("Uso")+'</th><th id="cr-last-edited">'+soy.$$escapeHtml("Editado por \u00faltima vez")+'</th><th id="cr-last-edited-by">'+soy.$$escapeHtml("Editado por")+'</th><th id="cr-actions"></th></tr></thead><tbody>',s=e.responsesList,a=s.length,r=0;r<a;r++){var i=s[r];n+=ServiceDesk.Internal.CannedResponses.Templates.cannedResponseRow({cannedResponse:i})}return n+="</tbody><table>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.cannedResponsesList.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.cannedResponsesList"),ServiceDesk.Internal.CannedResponses.Templates.cannedResponseRow=function(e,t){return"<tr data-response-id="+soy.$$escapeHtml(e.cannedResponse.id)+'><td headers="cr-title">'+soy.$$escapeHtml(e.cannedResponse.title)+'</td><td headers="cr-content">'+soy.$$escapeHtml(e.cannedResponse.text)+'</td><td headers="cr-usage">'+soy.$$escapeHtml(e.cannedResponse.totalUsageCount)+'</td><td headers="cr-last-edited">'+soy.$$escapeHtml(e.cannedResponse.lastUpdatedDateFormatted)+'</td><td headers="cr-last-edited-by">'+soy.$$escapeHtml(e.cannedResponse.lastUpdatedUser)+'</td><td headers="cr-actions"><ul class="menu"><li><a class="update-response" href="#">'+soy.$$escapeHtml("Editar")+'</a></li><li><a class="delete-response" href="#">'+soy.$$escapeHtml("Eliminar")+"</a></li></ul></td></tr>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.cannedResponseRow.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.cannedResponseRow"),ServiceDesk.Internal.CannedResponses.Templates.emptyCannedResponsesList=function(e,t){return'<div class="cr-no-responses-result">'+(e.isEmptyProject?'<div class="cr-no-responses-result__image"></div><h2 class="cr-no-responses-result__title">'+soy.$$escapeHtml("Crear, editar y gestionar respuestas")+'</h2><p class="cr-no-responses-result__text">'+soy.$$filterNoAutoescape(AJS.format("No dispones de respuestas preestablecidas en este proyecto. {0}A\u00f1ade una respuesta{1} para usarla en cualquier momento desde la pantalla de visualizaci\u00f3n de incidencias.",'<a href="#" class="cr-add-response-link">',"</a>"))+"</p>":'<h2 class="cr-no-responses-result__title">'+soy.$$escapeHtml("No hay respuestas preestablecidas que coincidan con tus criterios")+"</h2>")+"</div>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.emptyCannedResponsesList.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.emptyCannedResponsesList"),ServiceDesk.Internal.CannedResponses.Templates.cannedResponseInfo=function(e,t){return'<div class="field-group"><label for="cr-created-by">'+soy.$$escapeHtml("Autor")+'</label><span id="cr-created-by" class="field-value">'+soy.$$escapeHtml(e.cannedResponse.createdUser)+'</span></div><div class="field-group"><label for="cr-usage">'+soy.$$escapeHtml("Uso")+'</label><span id="cr-usage" class="field-value">'+soy.$$escapeHtml(e.cannedResponse.totalUsageCount)+'</span></div><div class="field-group"><label for="cr-edited">'+soy.$$escapeHtml("Editado por \u00faltima vez")+'</label><span id="cr-edited" class="field-value">'+soy.$$escapeHtml(e.cannedResponse.lastUpdatedDateFormatted)+'</span></div><div class="field-group"><label for="cr-edited-by">'+soy.$$escapeHtml("Editado por")+'</label><span id="cr-edited-by" class="field-value">'+soy.$$escapeHtml(e.cannedResponse.lastUpdatedUser)+"</span></div>"},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.cannedResponseInfo.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.cannedResponseInfo"),ServiceDesk.Internal.CannedResponses.Templates.deleteDialog=function(e,t){return""+aui.dialog.dialog2Content({titleText:"Eliminar respuesta",content:'<form class="aui ajs-dirty-warning-exempt"><p>'+soy.$$escapeHtml("\u00bfSeguro que quieres eliminar\u2026?")+"</p><p><b>"+soy.$$escapeHtml(e.cannedResponse.title)+'</b></p></form><div id="cr-global-error" class="aui-message aui-message-error" style="display: none"><p class="title"><strong>'+soy.$$escapeHtml("No hemos podido eliminar tu respuesta preestablecida")+"</strong></p><p>"+soy.$$escapeHtml("Esto puede deberse a varias razones; intenta eliminar tu respuesta de nuevo.")+"</p></div>",footerActionContent:'<button class="aui-button aui-button-primary dialog-submit-button">'+soy.$$escapeHtml("Eliminar")+'</button><button class="aui-button aui-button-link dialog-close-button">'+soy.$$escapeHtml("Cancelar")+"</button>"})},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.deleteDialog.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.deleteDialog"),ServiceDesk.Internal.CannedResponses.Templates.warningDialog=function(e,t){for(var n="<div><p>"+soy.$$escapeHtml("Estas variables no se reemplazaron en la respuesta preestablecida:")+"</p><ul>",s=e.cannedResponse.unresolvedVariables,a=s.length,r=0;r<a;r++){var i=s[r];n+="<li>"+soy.$$escapeHtml(i)+"</li>"}return n+="</ul><p>"+soy.$$escapeHtml("Edita la respuesta para mostrar la informaci\u00f3n correcta.")+"</p></div>",""+aui.dialog.dialog2Content({titleText:"Variables no sustituidas",content:n,footerActionContent:'<button class="aui-button aui-button-primary dialog-submit-button">'+soy.$$escapeHtml("Vale, entendido")+"</button>"})},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.warningDialog.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.warningDialog"),ServiceDesk.Internal.CannedResponses.Templates.editDialog=function(e,t){var s='<form class="aui top-label ajs-dirty-warning-exempt"><fieldset class="top-label"><div class="field-group top-label"><label for="cr-title">'+soy.$$escapeHtml("Nombre")+'</label><input class="text" type="text" id="cr-title" name="title" maxlength="255" autofocus value="'+("update"==e.action?soy.$$escapeHtml(e.cannedResponse.title):"")+'"></div></fieldset><fieldset class="top-label"><div class="field-group top-label"><div class="cr-editor-toolbar"><div class="column left"><label for="cr-text">'+soy.$$escapeHtml("Respuesta")+'</label></div></div><div class="wiki-edit-content"><textarea id="cr-text" name="text" class="textarea comment-textarea wiki-textfield mentionable" data-issuekey="'+soy.$$escapeHtml(e.issueKey)+'">'+("update"==e.action?soy.$$escapeHtml(e.cannedResponse.text):"")+"</textarea>"+(e.isRteEnabled?"<rich-editor></rich-editor>":"")+"</div>"+(e.isRteEnabled?'<div class="sd-rte-bar"></div>':"")+"</div></fieldset></form>";if(n(35).isFeatureEnabled("sd.canned.responses.variable.substitution")){s+='<div id="insert-variable" class="cr-insert-variable-dropdown aui-style-default aui-dropdown2"><ul class="aui-list-truncate">';for(var a=e.variables,r=a.length,i=0;i<r;i++){var o=a[i];s+='<li><a href="#" class="variable" data-variable-key="'+soy.$$escapeHtml(o.key)+'">'+soy.$$escapeHtml(o.label)+"</a></li>"}s+="</ul></div>"}return s+="update"==e.action?'<form class="aui"><fieldset>'+ServiceDesk.Internal.CannedResponses.Templates.cannedResponseInfo(e)+"</fieldset></form>":"",""+aui.dialog.dialog2Content({titleText:"add"==e.action?"Guardar respuesta":"update"==e.action?"Editar respuesta":"",content:s,footerActionContent:'<button class="aui-button aui-button-primary dialog-submit-button" type="submit">'+soy.$$escapeHtml("Guardar")+'</button><button class="aui-button aui-button-link dialog-close-button">'+soy.$$escapeHtml("Cancelar")+"</button>"})},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.editDialog.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.editDialog"),ServiceDesk.Internal.CannedResponses.Templates.insertVariableButton=function(e,t){return n(35).isFeatureEnabled("sd.canned.responses.variable.substitution")?'<a href="#insert-variable" aria-owns="insert-variable" aria-haspopup="true" class="cr-insert-variable-trigger aui-button aui-style-default aui-dropdown2-trigger">'+soy.$$escapeHtml("Introducir variable")+"</a>":""},goog.DEBUG&&(ServiceDesk.Internal.CannedResponses.Templates.insertVariableButton.soyTemplateName="ServiceDesk.Internal.CannedResponses.Templates.insertVariableButton");ServiceDesk.Internal.CannedResponses.Templates},210:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return v});var s=n(17),a=n.n(s),r=n(1),i=n(4),o=n(32),c=n(49),l=n(165),d=n(51),u=n.n(d),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var h=i.default.extend({},o.default.Events),g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventBus=i.default.extend({},o.default.Events),this.$contextElement=t}return p(e,[{key:"showMenuDropdown",value:function(e){this.eventBus.trigger("cannedresponses:showMenuDropdown",e),this.eventBus.trigger("cannedresponses:showMenuDropdown:"+this._getMode(),e)}},{key:"unhover",value:function(){this.eventBus.trigger("cannedresponses:unhover"),this.eventBus.trigger("cannedresponses:unhover:"+this._getMode())}},{key:"preview",value:function(e){this.eventBus.trigger("cannedresponses:preview",e),this.eventBus.trigger("cannedresponses:preview:"+this._getMode(),e)}},{key:"search",value:function(e){this.eventBus.trigger("cannedresponses:search",e)}},{key:"select",value:function(e){this.eventBus.trigger("cannedresponses:select",e),this.eventBus.trigger("cannedresponses:select:"+this._getMode(),e.cannedResponse)}},{key:"openAddDialog",value:function(e){this.eventBus.trigger("cannedresponses:openAddDialog",e)}},{key:"openUpdateDialog",value:function(e){this.eventBus.trigger("cannedresponses:openUpdateDialog",e)}},{key:"openDeleteDialog",value:function(e){this.eventBus.trigger("cannedresponses:openDeleteDialog",e)}},{key:"openManageDialog",value:function(e){this.eventBus.trigger("cannedresponses:openManageDialog",e)}},{key:"save",value:function(e){this.eventBus.trigger("cannedresponses:"+e),this.globalEvents.trigger("cannedresponses:"+e)}},{key:"delete",value:function(){this.eventBus.trigger("cannedresponses:delete"),this.globalEvents.trigger("cannedresponses:delete")}},{key:"adjustHeight",value:function(e){this.eventBus.trigger("cannedresponses:adjustHeight",e)}},{key:"addVariable",value:function(e){this.eventBus.trigger("cannedresponses:addVariable",e)}},{key:"getIssueKey",value:function(){return this.$contextElement.attr("data-issue-key")}},{key:"isRteEnabled",value:function(){return this.$contextElement.attr("data-is-rte-enabled")}},{key:"getCommentMarkupVal",value:function(){return Object(r.default)(this.entry.textArea).val()}},{key:"destroy",value:function(){this.rteView&&this.rteView.remove(),this.crDropdown.unbindJiraEvents(),this.eventBus.off()}},{key:"_getMode",value:function(){if(this.entry.isTextMode())return l.a.Modes.TEXT;if(this.entry.isVisualMode())return l.a.Modes.VISUAL;throw new Error("Unable to identified active mode for RTE")}},{key:"getProjectKey",value:function(){if(a.a&&i.default.isFunction(a.a.get)&&a.a.get("projectKey"))return a.a.get("projectKey");if(u.a&&i.default.isFunction(u.a.getIssueKey)&&u.a.getIssueKey()){var e=u.a.getIssueKey();return e.substring(0,e.indexOf("-"))}if(this.getIssueKey()){var t=this.getIssueKey();return t.substring(0,t.indexOf("-"))}throw new Error("Couldn't find project key on this context")}},{key:"globalEvents",get:function(){return h}}]),e}(),f={contextSelector:c.a.CR_CONTEXT_SELECTOR,contextDataIdentifier:"cannedResponsesContext",registeredContexts:{},getOrCreateContext:function(e,t){var n=e.parents(this.contextSelector);if(1!==n.length)throw new Error("Not exactly one context element, identified by "+this.contextSelector+", found as parent of element "+e.attr("id"));var s=n.data(this.contextDataIdentifier);return s||(s=new g(n),n.data(this.contextDataIdentifier,s),e.data(this.contextDataIdentifier,s)),t&&!this.registeredContexts[t]&&(this.registeredContexts[t]=s),s},destroy:function(e){this.registeredContexts[e]&&this.registeredContexts[e].destroy()}},m=function(e){return e.rteElement.parents(c.a.CR_CONTEXT_SELECTOR).length>0},v=function(e){return e.rteElement.parents(c.a.SCR_CONTEXT_SELECTOR).length>0}},245:function(e,t,n){"use strict";var s=n(8),a=n.n(s),r=n(2),i=n(32),o=n(5),c=n(49);t.a=o.a.Model.extend({namedAttributes:{id:Number,title:String,text:String,html:String,createdUser:String,lastUpdatedDate:Number,lastUpdatedDateFormatted:String,lastUpdatedUser:String,totalUsageCount:Number,enabled:Boolean,unresolvedVariables:[String]},urlRoot:function(){return a()()+"/"+c.a.CR_REST_API_ROOT+"/templates/"+this.options.projectKey},initialize:function(e,t){this.options=t},save:function(e,t){return this.isNew()||this.unset("html").unset("createdUser").unset("lastUpdatedDate").unset("lastUpdatedDateFormatted").unset("lastUpdatedUser").unset("totalUsageCount").unset("unresolvedVariables").setEnabled(!0),i.default.Model.prototype.save.call(this,e,t)},validate:function(){var e=[],t=this.escape("title"),n=this.escape("text");return t&&0!==t.trim().length||e.push({field:"title",errorMessage:"Debes asignar un nombre a tu respuesta para que puedas encontrarla m\u00e1s tarde"}),n&&0!==n.trim().length||e.push({field:"text",errorMessage:"Tienes que a\u00f1adir contenido a tu respuesta"}),e.length?e:null}})},254:function(e,t,n){"use strict";var s=n(8),a=n.n(s),r=n(5),i=n(32),o=n(245),c=n(49);t.a=r.a.Collection.extend({url:function(){return a()()+"/"+c.a.CR_REST_API_ROOT+"/search/"+this.options.projectKey},model:o.a,initialize:function(e,t){this.options=t},parse:function(e){return e?e.cannedResponses.map(function(e){var t=e.id,n=e.title,s=e.content,a=s.text,r=s.html,i=s.unresolvedVariables,o=e.lastUpdatedDate;return{id:t,title:n,text:a,html:r,createdUser:e.createdUser,lastUpdatedDate:o,lastUpdatedUser:e.lastUpdatedUser,totalUsageCount:e.totalUsageCount,unresolvedVariables:i}}):[]},fetchFrequentlyUsed:function(e){var t=e.limit,n=e.issueKey;this.fetch({data:{limit:t,daysSince:c.a.DAYS_SINCE,limitUsagesToUser:!0,substitute:!0,issueKey:n},options:{reset:!0}})},fetchPopular:function(e){var t=e.limit,n=e.issueKey;this.fetch({data:{limit:t,substitute:!0,issueKey:n},options:{reset:!0}})},_prepareModel:function(e,t){return t.projectKey=this.options.projectKey,i.default.Collection.prototype._prepareModel.call(this,e,t)}})},299:function(e,t){e.exports=require("jira/editor/registry")},302:function(e,t,n){"use strict";var s=n(5);t.a=s.a.View.extend({initialize:function(e){var t=e.context,n=e.editor;this.editor=n,this.state={selectedContent:null},this.context=t,this.listenTo(this.context.eventBus,"cannedresponses:showMenuDropdown:"+this._getMode(),this._storeState),this.listenTo(this.context.eventBus,"cannedresponses:unhover:"+this._getMode(),this._restoreState),this.listenTo(this.context.eventBus,"cannedresponses:preview:"+this._getMode(),this._preview),this.listenTo(this.context.eventBus,"cannedresponses:select:"+this._getMode(),this._storePreview)},_storeState:function(){},_restoreState:function(){},_preview:function(){},_storePreview:function(){},_getMode:function(){}})},303:function(e,t,n){"use strict";var s=n(2),a=n(108),r=n.n(a),i=n(14),o=n.n(i),c=n(1),l=n(138),d=n(52),u=n(13),p=n(124),h=n(1e3),g=(n(187),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e});t.a=l.a.extend({className:"cannedresponses-edit-dialog aui-dialog2 aui-dialog2-large",id:"crEditDialog",template:ServiceDesk.Internal.CannedResponses.Templates.editDialog,mixins:[d.a],events:function(){return g(l.a.prototype.events,{"click .dialog-submit-button":"_submit","submit form":"_submit"})},initialize:function(e){var t=e.context,n=e.model;this.context=t,this.model=n,this.action=n.isNew()?"add":"update",this.substitutionVariables=this._getSubstitutionVariables(),this.on("showDialog",this._onShow.bind(this))},_getSubstitutionVariables:function(){var e=p.a.substitutionVariables||{};return Object.keys(e).reduce(function(t,n){return t.concat([{key:n,label:e[n]}])},[])},_submit:function(e){var t=this;e.preventDefault(),this.model.setTitle(this.$("#cr-title").val()),this.model.setText(this.$("#cr-text").val()),this.$("div.error").empty();var n=this.model.validate();if(n)this.applyFieldErrors(n);else{var s=o()();this.model.save().done(function(){return s.resolve()}).fail(function(e){s.reject(Object(u.d)(e))}),this.handleSubmit(s).done(function(){return t._successfulSave()})}},_insertVariable:function(e){e.preventDefault();var t=e.target.getAttribute("data-variable-key"),n="${"+t+"}",s=this.$el.find("#cr-text");h.a.getInsertTextEditorExtension(s).insertText(n),this.context.addVariable({variableKey:t})},_successfulSave:function(){this._createSuccessFlag(),this._closeDialog(),this.context.save(this.action)},_createSuccessFlag:function(){var e="add"===this.action?s.format("{0} se ha guardado","<b>"+this.model.escape("title")+"</b>"):s.format("Se ha editado {0}","<b>"+this.model.escape("title")+"</b>");return r()({type:"success",close:"auto",body:e})},_onShow:function(){Object(c.default)("#insert-variable").find(".variable").on("click",this._insertVariable.bind(this))},render:function(){return this.$el.html(this.template({cannedResponse:this.model.toJSON(),issueKey:this.context.getIssueKey(),isRteEnabled:this.context.isRteEnabled(),action:this.action,variables:this.substitutionVariables})),this}})},348:function(e,t){e.exports=require("jira/ajs/select/fetchers/ajax-descriptor-fetcher")},371:function(e,t,n){"use strict";var s=n(348),a=n.n(s);t.a=function(e){var t=e.searchAttributes,n=e.url,s=e.parseFunction;return new a.a({query:!0,minQueryLength:0,url:n,data:t,timeout:3e5,formatResponse:function(e){return{cannedResponses:s(e),totalCount:e?e.totalHits:null}}})}},372:function(e,t,n){"use strict";var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t}return s(e,[{key:"insertText",value:function(){}}]),e}();t.a=a},49:function(e,t,n){"use strict";t.a={CR_REST_API_ROOT:"rest/servicedesk/canned-responses/1",CR_TRIGGER:"[",CR_CONTEXT_SELECTOR:".js-cannedresponses-context",SCR_CONTEXT_SELECTOR:"#crEditDialog",MAX_RESULTS_TOP_LISTS:5,MAX_RESULTS_SEARCH:10,MAX_RESULTS_MANAGEMENT:10,DAYS_SINCE:30,CR_SELECT_SOURCES:{DROPDOWN:"menu.dropdown",AUTOCOMPLETE:"autocomplete"},CR_SEARCH_SOURCES:{DROPDOWN:"menu.dropdown",MANAGEMENT:"management"},CR_ADD_SOURCES:{DROPDOWN:"menu.dropdown",MANAGEMENT:"management"},CR_DELETE_SOURCES:{MANAGEMENT:"management"},CR_UPDATE_SOURCES:{MANAGEMENT:"management"}}},504:function(e,t){e.exports=require("jira/jquery/plugins/livestamp/time")},619:function(e,t,n){"use strict";var s=n(1),a=n(24),r=n(132),i=(n(1192),n(1191),1),o=1,c=1,l=5,d=10,u=ServiceDesk.Templates.Components.paginator;function p(e){var t=Object(s.default)(e),n=parseInt(t.attr("max-pages-shown"),d)||l;n<i&&(n=l);var a=parseInt(t.attr("num-pages"),d)||o,r=parseInt(t.attr("current-page"),d)||c;t.html(u(function(e,t,n){var s=void 0,a=void 0;if(e>=i&&e<=t){var r=void 0;r=n%2==1?n:n-1;var o=Math.floor(r/2),c=n-1;s=Math.max(i,Math.min(e-o,t-c)),a=Math.min(t,s+c)}else s=i,a=Math.min(n,e);return{startPage:s,endPage:a,currentPage:e}}(r,a,n)))}function h(e,t){var n=Object(s.default)(e);n.attr("current-page",t),n.trigger("page-change",t)}t.a=Object(r.a)("sd-paginator",{type:a.a.types.TAG,attributes:{"current-page":p,"num-pages":p,"max-pages-shown":p},events:{"click .js-page":function(e,t){h(e,Object(s.default)(t.target).closest(".js-page").attr("page-index"))},"click .js-next-page":function(e){var t=parseInt(Object(s.default)(e).attr("current-page"),d)+1;t<=Object(s.default)(e).attr("num-pages")&&h(e,t)},"click .js-prev-page":function(e){var t=parseInt(Object(s.default)(e).attr("current-page"),d)-1;t>0&&h(e,t)}}})},776:function(e,t,n){"use strict";n(30),n(34),n(1248),n(1247);t.a=ServiceDesk.Templates.SearchInput.content},777:function(e,t,n){"use strict";var s=n(5),a=n(776);t.a=s.a.View.extend({events:{"input .js-search-field":"_handleInput","click .js-clear-query":"_handleClearQuery","submit form.aui":"_handleFormSubmit"},template:a.a,render:function(){return this.$el.html(this.template({searchPlaceholder:this.options.searchPlaceholder||"",searchIntro:this.options.searchIntro||""})),this._$clearQueryIcon=this.$(".js-clear-query"),this._$searchField=this.$(".js-search-field"),this._$spinner=this.$(".js-spinner"),this},_getSearchInputElement:function(){return this.$(".sd-search-input")},_handleInput:function(){this._updateClearQueryIcon();var e=this._$searchField.val();this.trigger("change",{value:e})},_handleClearQuery:function(){this._$searchField.val(""),this._$searchField.focus(),this._updateClearQueryIcon(),this.trigger("change",{value:""})},_handleFormSubmit:function(e){e.preventDefault()},_toggleClearQueryIcon:function(e){this._getSearchInputElement().toggleClass("sd-search-input-has-query",e)},_hideClearQueryIcon:function(){this._toggleClearQueryIcon(!1)},_hasQuery:function(){return Boolean(this.value())},_updateClearQueryIcon:function(){this._toggleClearQueryIcon(this._hasQuery())},value:function(){return this._$searchField.val()},setData:function(e){var t=this;Object.keys(e).forEach(function(n){t.$el.attr("data-"+n,e[n])})},getData:function(){return this.$el.data()},showSpin:function(){this._hideClearQueryIcon(),this._$spinner.show(),this._getSearchInputElement().addClass("sd-search-input-has-spin")},stopSpin:function(){this._updateClearQueryIcon(),this._$spinner.hide(),this._getSearchInputElement().removeClass("sd-search-input-has-spin")},isSpinVisible:function(){return this._getSearchInputElement().hasClass("sd-search-input-has-spin")}})},778:function(e,t,n){"use strict";var s=n(4),a=n(5),r=n(6),i=n(16),o=n.n(i),c=n(348),l=n.n(c),d=n(777);n(1246);t.a=a.a.View.extend({namedEvents:["dataRequested","dataReceived"],template:ServiceDesk.Templates.SearchInput.content,initialize:function(){this.options.descriptorFetcher?this.descriptorFetcher=this.options.descriptorFetcher:this.descriptorFetcher=new l.a({query:!0,minQueryLength:0,url:this.options.url+"/search",data:this._extendDataBeforeFetch.bind(this),timeout:3e5,formatResponse:function(e){return e}}),this.options.fastQuery||(this._handleInput=s.default.debounce(this._handleInput,200)),this._simpleSearchInputView=new d.a({searchIntro:this.options.searchIntro,searchPlaceholder:this.options.searchPlaceholder}),this.listenTo(this._simpleSearchInputView,"change",this._handleInput)},_extendDataBeforeFetch:function(e){var t={query:e};return this.pageNumber&&(t.page=this.pageNumber),t},_handleRequestAbort:function(e,t,n){var s=e.outstandingRequest;!s||s.aborted||s.successful||(s.abort(),t&&this._stopSpin(),this.trigger(n))},_handleInput:function(){var e=this;this.handleSearch().always(function(){e.options.trackLink&&r.a.trackEvent(e.options.trackLink)})},handleSearch:function(e){var t=this;e=e||{};var n=this._simpleSearchInputView.value(),s=e.pageNumber;return e.stayOnCurrentPage&&!s&&(s=this.pageNumber),!this.options.alwaysIncludePageNumberOnEmptyQuery||n||s||(s=1),this._handleRequestAbort(this.descriptorFetcher,Boolean(s),"dataAborted"),this.pageNumber=s,this.query=n,this.trigger("dataRequested",{pageNumber:s,query:n}),Boolean(s)||e.noSpinner||this._showSpin(),this.descriptorFetcher.execute(n).done(function(e){t.trigger("dataReceived",e),e&&t._simpleSearchInputView.setData({query:e.query,page:e.pageNumber}),o.a.trace("sd.component.search.input.search.completed")}).always(function(){s||t._stopSpin()})},render:function(){return this._simpleSearchInputView.setElement(this.$el).render(),this},isQueryEmpty:function(){return!this.query},_showSpin:function(){this._simpleSearchInputView.showSpin()},_stopSpin:function(){this._simpleSearchInputView.stopSpin()}})},990:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var s=n(8),a=n.n(s),r=n(4),i=n(13),o=n(49),c=function(e){var t=e.context;e.context.eventBus.on("cannedresponses:select",function(e){var n=e.cannedResponse;Object(i.e)(a()()+"/"+o.a.CR_REST_API_ROOT+"/usage/"+t.getProjectKey(),r.default.pick(n,"id"))})}},991:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var s=n(6),a=n(17),r=n.n(a),i=n(124),o=function(){return r.a.getBoolean("isAdmin")},c=function(e){var t=e.context.eventBus;t.on("cannedresponses:showMenuDropdown",function(){s.a.trackEvent("servicedesk.cannedresponses.menu.dropdown.show",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:select",function(e){var t=e.source,n=e.group;s.a.trackEvent("servicedesk.cannedresponses."+t+".select."+n,{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:search",function(e){var t=e.source;s.a.trackEvent("servicedesk.cannedresponses."+t+".search",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:openAddDialog",function(e){var t=e.source;s.a.trackEvent("servicedesk.cannedresponses."+t+".open.add.dialog",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:openUpdateDialog",function(e){var t=e.source;s.a.trackEvent("servicedesk.cannedresponses."+t+".open.update.dialog",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:openDeleteDialog",function(e){var t=e.source;s.a.trackEvent("servicedesk.cannedresponses."+t+".open.delete.dialog",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:add",function(){s.a.trackEvent("servicedesk.cannedresponses.add",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:update",function(){s.a.trackEvent("servicedesk.cannedresponses.update",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:delete",function(){s.a.trackEvent("servicedesk.cannedresponses.delete",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:openManageDialog",function(e){var t=e.source;s.a.trackEvent("servicedesk.cannedresponses."+t+".open.manage.dialog",{isAdmin:o(),userId:i.a.userId})}),t.on("cannedresponses:addVariable",function(e){var t=e.variableKey;s.a.trackEvent("servicedesk.cannedresponses.insert.variable",{isAdmin:o(),userId:i.a.userId,variableKey:t})})}},992:function(e,t,n){"use strict";var s=n(1),a=n(49),r=n(165),i=n(302);n(187);t.a=i.a.extend({events:{keypress:"_onTextareaKeypress"},_onTextareaKeypress:function(e){var t=e.which;String.fromCharCode(t),a.a.CR_TRIGGER},_getMode:function(){return r.a.Modes.VISUAL},_storeState:function(){return this.state.selectedContent=this.editor.selection.getContent(),this.editor.selection.setContent('<span id="sel_remembered">'+this.state.selectedContent+"</span>"),Object(s.default)(this.editor.getBody()).find("#sel_remembered")},_restoreState:function(){Object(s.default)(this.editor.getBody()).find("#sel_remembered").replaceWith(this.state.selectedContent)},_preview:function(e){var t=e.html,n=Object(s.default)(this.editor.getBody()).find("#sel_remembered");n.length||(n=this._storeState()),n.html(this._prepareCannedResponseHtml(t))},_prepareCannedResponseHtml:function(e){var t=Object(s.default)(e);return t.length>1?t.toArray().reduce(function(e,t){return t.outerHTML?e+t.outerHTML:e},""):1===t.length?t[0].innerHTML:""},_storePreview:function(){var e=Object(s.default)(this.editor.getBody()).find("#sel_remembered");this.editor.undoManager.add(),e.length>0&&(this.editor.selection.select(e[0]),this.editor.selection.setContent(e.html())),this.editor.focus()}})},993:function(e,t,n){"use strict";var s=n(1),a=n(49),r=n(165),i=n(302);n(187);t.a=i.a.extend({initialize:function(e){for(var t,n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];(t=i.a.prototype.initialize).call.apply(t,[this,e].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s))),this.listenTo(e.context.eventBus,"cannedresponses:adjustHeight",this._adjustViewHeight)},events:{keypress:"_onTextareaKeypress"},_getMode:function(){return r.a.Modes.TEXT},_onTextareaKeypress:function(e){var t=e.which;String.fromCharCode(t),a.a.CR_TRIGGER},getValue:function(){return this.$el.val()},_storeState:function(e){var t=e.textAreaState;this.state=t},_restoreState:function(){if(!this.state.itemSelected){this.$el.val(this.state.originalText).removeAttr("disabled");var e=this.state,t=e.caretSelectionStart,n=e.caretSelectionEnd;this._getEditor().manipulationEngine.setSelection(t,n)}},_preview:function(e){var t=e.text;this.$el.val(this._embedText(t)).attr("disabled","disabled"),this.state.itemSelected=!1},_storePreview:function(e){var t=e.text;this.$el.val(this._embedText(t)).removeAttr("disabled").keyup(),this._insertText(t)},_getEditor:function(){return this.$el.data("wikiEditor")},_insertText:function(e){this.$el.val(this._embedText(e));var t=this._getEditor(),n=t.undoRedoEl,s=t.manipulationEngine;n.recordHistoryItem(),this.state.itemSelected=!0,this.$el.focus();var a=this.state,r=a.caretSelectionStart,i=a.caretSelectionEnd;r!==i?i+e.length===0?s.setSelection(r,i+e.length):s.setSelection(r,i+e.length-1):s.setSelection(r+e.length,i+e.length)},_embedText:function(e){var t=this.state.originalText,n=this.state,s=n.caretSelectionStart,a=n.caretSelectionEnd,r=null!=a;return s=null!=s?s:t.length,a=r?a:t.length,t.substring(0,s)+e+t.substring(a,t.length)},_adjustViewHeight:function(e){var t=e.dropdownHeight,n=this.$el.parents(".wiki-edit-content").height();Object(s.default)("#cr-dropdown-height-adjustment").remove(),t>n&&this.$el.parents("#addcomment,sd-comment-field").after('<div id="cr-dropdown-height-adjustment" style="height:'+(t-n)+'px;"></div>')}})},994:function(e,t,n){"use strict";var s=n(5);n(187);t.a=s.a.View.extend({className:"aui-buttons",id:"crToolbarMenuItem",events:{"click #crLink":"_onClickMenuItem"},initialize:function(e){var t=e.context,n=e.$textArea,s=e.dropdownId;this.context=t,this.$textArea=n,this.dropdownId=s},_onClickMenuItem:function(){this.context.showMenuDropdown({textAreaState:{originalText:this.$textArea.val(),caretSelectionStart:this.$textArea.prop("selectionStart"),caretSelectionEnd:this.$textArea.prop("selectionEnd")}})},render:function(){return this.$el.html(ServiceDesk.Internal.CannedResponses.Templates.crToolbarMenuItem({dropdownId:this.dropdownId})),this}})},995:function(e,t,n){"use strict";var s=n(138),a=(n(187),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e});t.a=s.a.extend({className:"cannedresponses-warning-dialog aui-dialog2 aui-dialog2-small",id:"crWarningDialog",events:function(){return a(s.a.prototype.events,{"click .dialog-submit-button":"_submit"})},initialize:function(e){var t=e.context,n=e.model;this.context=t,this.model=n},_submit:function(e){e.preventDefault(),this._closeDialog()},render:function(){return this.$el.html(ServiceDesk.Internal.CannedResponses.Templates.warningDialog({cannedResponse:this.model})),this}})},996:function(e,t,n){"use strict";var s=n(2),a=n(108),r=n.n(a),i=n(138),o=(n(187),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e});t.a=i.a.extend({className:"cannedresponses-delete-dialog aui-dialog2 aui-dialog2-small",id:"crDeleteDialog",events:function(){return o(i.a.prototype.events,{"click .dialog-submit-button":"_submit"})},initialize:function(e){var t=e.context,n=e.model;this.context=t,this.model=n},_submit:function(e){var t=this;e.preventDefault(),this.$("#cr-global-error").hide(),this.model.destroy().then(function(){t._successfulDelete()}).fail(function(){t._renderGlobalError()})},_renderGlobalError:function(){this.$("#cr-global-error").show()},_successfulDelete:function(){this._createSuccessFlag(),this._closeDialog(),this.context.delete()},_createSuccessFlag:function(){return r()({type:"success",close:"auto",body:s.format("Se ha eliminado {0}","<b>"+this.model.escape("title")+"</b>")})},render:function(){return this.$el.html(ServiceDesk.Internal.CannedResponses.Templates.deleteDialog({cannedResponse:this.model.toJSON()})),this}})},997:function(e,t,n){"use strict";var s=n(1),a=n(5),r=n(49),i=n(138),o=n(303),c=n(996),l=n(245),d=n(619),u=n(371),p=n(778),h=n(128),g=n(504),f=n.n(g),m=n(2),v=(n(187),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}),y=a.a.View.extend({template:ServiceDesk.Internal.CannedResponses.Templates.cannedResponsesList,id:"canned-responses-list",render:function(e){var t=e.collection.map(function(e){return e.setLastUpdatedDateFormatted(f.a.formatDateWithRelativeAge(Object(h.a)(e.getLastUpdatedDate()),f.a.FormatType.types.shortAge)).toJSON()});return this.$el.html(this.template({responsesList:t})),this}}),b=a.a.View.extend({template:ServiceDesk.Internal.CannedResponses.Templates.paginator,id:"paginator",initialize:function(){d.a.install()},render:function(e){var t=e.pages,n=e.currentPage;return this.$el.html(this.template({pages:t,currentPage:n})),this}}),S=a.a.View.extend({template:ServiceDesk.Internal.CannedResponses.Templates.emptyCannedResponsesList,id:"empty-list-message",render:function(e){var t=e.isEmptyProject;return this.$el.html(this.template({isEmptyProject:t})),this}}),_=a.a.View.extend({pageSize:r.a.MAX_RESULTS_MANAGEMENT,initialize:function(){this.cannedResponsesList=new y,this.paginator=new b,this.emptyListMessage=new S},render:function(e){var t=e.collection,n=e.totalCount,s=e.currentPage,a=e.isQueryEmpty,r=Math.ceil(n/this.pageSize),i=!n,o=i&&a;return i?this.$el.html(this.emptyListMessage.render({isEmptyProject:o}).el):this.$el.html(this.cannedResponsesList.render({collection:t}).el).append(this.paginator.render({pages:r,currentPage:s}).el),this}});t.a=i.a.extend({template:ServiceDesk.Internal.CannedResponses.Templates.manageDialog,pageSize:r.a.MAX_RESULTS_MANAGEMENT,className:"cannedresponses-manage-dialog aui-dialog2 aui-dialog2-xlarge",id:"crManageDialog",events:v(i.a.prototype.events,{"click .cr-add-response-button,.cr-add-response-link":"_openAddDialog","input .js-search-field":"_handleSearchInput","page-change":"_onPageChange","click .delete-response":"_openDeleteDialog","click .update-response":"_openUpdateDialog"}),initialize:function(e){var t=this,n=e.model,s=e.context;this.model=n,this.context=s,this.page=1,this.listContainer=new _;var a=Object(u.a)({searchAttributes:function(e){return{query:e,limit:t.pageSize,offset:(t.page-1)*t.pageSize,withRender:!1}},url:this.model.url(),parseFunction:this.model.parse});this.searchInputView=new p.a({descriptorFetcher:a,searchPlaceholder:"Buscar respuestas preestablecidas",searchIntro:"Buscar respuestas preestablecidas"}),this.listenTo(s.eventBus,"cannedresponses:delete",this._refreshSearch),this.listenTo(s.eventBus,"cannedresponses:update",this._refreshSearch),this.listenTo(s.eventBus,"cannedresponses:add",this._refreshSearch),this.listenTo(this.searchInputView,"dataReceived",function(e){var n=e.cannedResponses,s=e.totalCount;t.model.reset(n),t.$("#list-container").html(t.listContainer.render({collection:t.model,totalCount:s,currentPage:t.page,isQueryEmpty:t.searchInputView.isQueryEmpty()}).el)}),this.on("showDialog",this._onShow)},_getResponseForRow:function(e){var t=Object(s.default)(e.target).parents("*[data-response-id]").attr("data-response-id");return this.model.get(t)},_openAddDialog:function(e){e.preventDefault(),new o.a({context:this.context,model:new l.a({},{projectKey:this.context.getProjectKey()})}).show(),this.context.openAddDialog({source:r.a.CR_ADD_SOURCES.MANAGEMENT})},_openUpdateDialog:function(e){e.preventDefault(),new o.a({context:this.context,model:this._getResponseForRow(e)}).show(),this.context.openUpdateDialog({source:r.a.CR_UPDATE_SOURCES.MANAGEMENT})},_openDeleteDialog:function(e){e.preventDefault(),new c.a({context:this.context,model:this._getResponseForRow(e)}).show(),this.context.openDeleteDialog({source:r.a.CR_DELETE_SOURCES.MANAGEMENT})},_handleSearchInput:function(){this.page=1},_search:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).paginating,t=void 0!==e&&e;this.searchInputView.handleSearch({pageNumber:t?this.page:null}),this.context.search({source:r.a.CR_SEARCH_SOURCES.MANAGEMENT})},_refreshSearch:function(){0===this.model.length&&this.page>1&&(this.page=this.page-1),this._search()},_onPageChange:function(e,t){this.page=t,this._search({paginating:!0})},_onShow:function(){this._search({query:""})},render:function(){return this.$el.html(this.template()),this.searchInputView.setElement(this.$(".js-canned-responses-search")).render(),this}})},998:function(e,t,n){"use strict";var s=n(372),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["a"]),a(t,[{key:"insertText",value:function(e){this.editor.undoRedoEl.recordHistoryItem(),this.editor.manipulationEngine.replaceSelectionWith(e),this.editor.$el.focus(),this.editor.undoRedoEl.recordHistoryItem()}}]),t}();t.a=r},999:function(e,t,n){"use strict";var s=n(372),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["a"]),a(t,[{key:"insertText",value:function(e){this.editor.rteInstance.then(function(t){t.focus(),t.editor.selection.setContent(e),t.editor.undoManager.add()})}}]),t}();t.a=r}},[[1397,58,59,60,61,62,63,64,65,66,68,67,69,71,70,76,75,74,73,72,78,81,80,79,82,87,90,102,99,98,107,120,156]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:plugins', location = 'js/plugins/markup-plugin.js' */
require(["jira/editor/customizer"],function(b){b.customizeSettings(function(a){-1===a.plugins.indexOf("textpattern")&&a.plugins.push("textpattern");a.textpattern_patterns=a.textpattern_patterns||[];Array.prototype.push.apply(a.textpattern_patterns,[{start:"1. ",cmd:"InsertOrderedList"},{start:"# ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}])})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jira.plugins.jira-editor-plugin:plugins', location = 'js/plugins/toolbar-sync-plugin.js' */
define("jira/editor/plugins/toolbar-sync",["jira/editor/tinymce"],function(d){var e=["bold","italic","underline"];d.create("tinymce.plugins.jira.ToolbarSyncPlugin",{init:function(b){var c=b.settings;b.on("NodeChange",function(){b.isHidden()||e.forEach(function(a){var d=b.queryCommandState(a);a=c.toolbarContainer.find("[data-operation\x3d"+a+"]");!!a.attr("aria-pressed")!==d&&a.attr("aria-pressed",d?"true":null)})});b.on("hide",function(){e.forEach(function(a){c.toolbarContainer.find("[data-operation\x3d"+
a+"]").attr("aria-pressed",null)})});b.contextManager.on("change:all",function(a){c.toolbarContainer.find("[aria-disabled], [data-operation], [aria-controls]").attr("aria-disabled",a.disableState)});b.contextManager.on("change:a",function(a){c.toolbarContainer.find("[data-operation^\x3dlink]").attr("aria-disabled",a.disableState)});b.contextManager.on("change:table",function(a){c.toolbarContainer.find("[data-operation\x3dtable]").attr("aria-disabled",a.disableState)})}});d.PluginManager.add("jira.toolbarsync",
d.plugins.jira.ToolbarSyncPlugin);d.PluginManager.urls["jira.toolbarsync"]=!0;return{configure:function(b,c){c.plugins.push("jira.toolbarsync");c.toolbarContainer=b.element.getToolbarContainer()}}});
}catch(e){WRMCB(e)};